<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 12.2.0"/>
    <title>web_tools API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>




        <h2>API Documentation</h2>
            <ul class="memberlist">
            <li>
                    <a class="class" href="#Twitter_Session">Twitter_Session</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Twitter_Session.__init__">Twitter_Session</a>
                        </li>
                        <li>
                                <a class="variable" href="#Twitter_Session.session">session</a>
                        </li>
                        <li>
                                <a class="variable" href="#Twitter_Session.response">response</a>
                        </li>
                        <li>
                                <a class="variable" href="#Twitter_Session.limit_log">limit_log</a>
                        </li>
                        <li>
                                <a class="variable" href="#Twitter_Session.query_log">query_log</a>
                        </li>
                        <li>
                                <a class="function" href="#Twitter_Session.get_token_local">get_token_local</a>
                        </li>
                        <li>
                                <a class="function" href="#Twitter_Session.get_url">get_url</a>
                        </li>
                        <li>
                                <a class="function" href="#Twitter_Session.get_user_profile">get_user_profile</a>
                        </li>
                        <li>
                                <a class="function" href="#Twitter_Session.get_user_tweets">get_user_tweets</a>
                        </li>
                        <li>
                                <a class="function" href="#Twitter_Session.get_user_following">get_user_following</a>
                        </li>
                        <li>
                                <a class="function" href="#Twitter_Session.get_user_followers">get_user_followers</a>
                        </li>
                        <li>
                                <a class="function" href="#Twitter_Session.get_user_snapshot">get_user_snapshot</a>
                        </li>
                        <li>
                                <a class="function" href="#Twitter_Session.get_string_query">get_string_query</a>
                        </li>
                        <li>
                                <a class="function" href="#Twitter_Session.return_server_limits">return_server_limits</a>
                        </li>
                        <li>
                                <a class="function" href="#Twitter_Session.df_to_db">df_to_db</a>
                        </li>
                        <li>
                                <a class="function" href="#Twitter_Session.db_to_df">db_to_df</a>
                        </li>
                        <li>
                                <a class="function" href="#Twitter_Session.get_dbs">get_dbs</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Database_Functions">Database_Functions</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Database_Functions.__init__">Database_Functions</a>
                        </li>
                        <li>
                                <a class="function" href="#Database_Functions.list_db_keys">list_db_keys</a>
                        </li>
                        <li>
                                <a class="function" href="#Database_Functions.list_db_tables">list_db_tables</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Streamlit_Functions">Streamlit_Functions</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Streamlit_Functions.__init__">Streamlit_Functions</a>
                        </li>
                        <li>
                                <a class="function" href="#Streamlit_Functions.set_boilerplate">set_boilerplate</a>
                        </li>
                        <li>
                                <a class="function" href="#Streamlit_Functions.update_metrics">update_metrics</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#random_line">random_line</a>
            </li>
            <li>
                    <a class="function" href="#tutorial">tutorial</a>
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
web_tools    </h1>

                
                        <input id="mod-web_tools-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-web_tools-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="kn">import</span> <span class="nn">datetime</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="kn">import</span> <span class="nn">glob</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="kn">import</span> <span class="nn">json</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="kn">import</span> <span class="nn">pickle</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="kn">import</span> <span class="nn">random</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="kn">import</span> <span class="nn">re</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="kn">import</span> <span class="nn">sys</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="kn">import</span> <span class="nn">time</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="kn">import</span> <span class="nn">urllib.parse</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="kn">import</span> <span class="nn">pandas</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="kn">import</span> <span class="nn">requests</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="kn">import</span> <span class="nn">sqlalchemy</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="sd">I&#39;m using pdoc to write the API documentation.</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="sd">$: pdoc ./web-tools.py -o ./</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="nd">@dataclass</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="k">class</span> <span class="nc">Twitter_Session</span><span class="p">:</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="sd">    A Twitter session object.</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a><span class="sd">    #### Parameters</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="sd">        token : str - The bearer token for public metrics. Acquired via a Twitter developer account. Use the get_token_local() method to set.</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="sd">    #### Attributes</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="sd">        token : str - The bearer token for this instance.</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a><span class="sd">        session : object - The requests.Session object for this instance.</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="sd">        history : list - History of URL calls made by this instance.</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a><span class="sd">        limit_log : dict - Metrics parsed from Twitter response headers. Used to set metrics trackers by the application.</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a><span class="sd">        query_log : dict - Log of queries made. Primarily used to find session query terms.</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>    <span class="n">twitter_enrollment_period</span> <span class="o">=</span> <span class="s2">&quot;29 October&quot;</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a><span class="sd">        Instantiate the session object. Requires no parameters.</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a>        <span class="sd">&quot;&quot;&quot;Creates a request.session object unique to the instance.&quot;&quot;&quot;</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">response</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>        <span class="sd">&quot;&quot;&quot;The last requests.response object received.&quot;&quot;&quot;</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>        <span class="sd">&quot;&quot;&quot;The log of Twitter server rates and limits. Appended as the endpoint is accessed. Refer: https://developer.twitter.com/en/docs/twitter-api/rate-limits&quot;&quot;&quot;</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">query_log</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a>        <span class="sd">&quot;&quot;&quot;The log of Twitter queries and responses. Use to reference the transaction id, search term, etc.&quot;&quot;&quot;</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a>    <span class="k">def</span> <span class="nf">get_token_local</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a><span class="sd">        Retreive a Twitter bearer token from a JSON with the following schema:</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a><span class="sd">            {&#39;keys&#39;:</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a><span class="sd">                &#39;Bearer Token&#39;: &#39;token&#39;</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a><span class="sd">                }</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a><span class="sd">        #### Parameters</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a><span class="sd">            path : str - File path to the JSON. Must be accessible with open(), and readable by read().</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a><span class="sd">        #### Attributes</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a><span class="sd">            self.token : str - The bearer token string.</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>            <span class="n">temp</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">token</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="s2">&quot;keys&quot;</span><span class="p">][</span><span class="s2">&quot;Bearer Token&quot;</span><span class="p">]</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>            <span class="sd">&quot;&quot;&quot;This session&#39;s bearer token. Acquired from a Twitter developer account. Refer: https://developer.twitter.com/en/docs/twitter-api/getting-started/getting-access-to-the-twitter-api&quot;&quot;&quot;</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>    <span class="k">def</span> <span class="nf">get_url</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a><span class="sd">        Simple HTTP GET request.</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a><span class="sd">        #### Parameters</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a><span class="sd">            url : str - The complete URL, with or without a scheme. If no scheme is specified, defaults to &#39;https://&#39;.</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a><span class="sd">        #### Attributes</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a><span class="sd">            self.response : Response - The complete requests.response object, set to the class variable response.</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>        <span class="k">try</span><span class="p">:</span>  <span class="c1"># try the call</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>                <span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Authorization&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Bearer </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">},</span> <span class="n">stream</span><span class="o">=</span><span class="kc">False</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>            <span class="p">)</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">MissingSchema</span><span class="p">:</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>            <span class="c1"># print(sys.exc_info())</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>                <span class="n">url</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;https://</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>                <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Authorization&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Bearer </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">},</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>                <span class="n">stream</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>            <span class="p">)</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>    <span class="k">def</span> <span class="nf">get_user_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a><span class="sd">        Request Twitter&#39;s users by username endpoint. Resets index.</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a><span class="sd">        #### Parameters</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a><span class="sd">            username : str - The @username. Can be passed with or without &#39;@&#39;.</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a><span class="sd">            timer : bool</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a><span class="sd">        #### Returns</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a><span class="sd">            pandas.DataFrame - A parsed DataFrame generated from the response JSON.</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>        <span class="k">if</span> <span class="s2">&quot;timer&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>            <span class="n">timer</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;timer&quot;</span><span class="p">]</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>            <span class="n">timer</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>        <span class="k">if</span> <span class="n">timer</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sleeping...-_-...&quot;</span><span class="p">)</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">59</span><span class="p">)</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>        <span class="k">if</span> <span class="n">username</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;@&quot;</span><span class="p">:</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>            <span class="n">username</span> <span class="o">=</span> <span class="n">username</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">get_url</span><span class="p">(</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>            <span class="n">url</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;https://api.twitter.com/2/users/by/username/</span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2">?user.fields=description,public_metrics,profile_image_url&quot;</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>        <span class="p">)</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;user_profile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_server_limits</span><span class="p">()</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;user_profile&quot;</span><span class="p">][</span><span class="s2">&quot;checked_at&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="s2">&quot;metric&quot;</span><span class="p">})</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>            <span class="k">return</span> <span class="n">df</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;user_profile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_server_limits</span><span class="p">()</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;user_profile&quot;</span><span class="p">][</span><span class="s2">&quot;checked_at&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>            <span class="k">return</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;errors&quot;</span><span class="p">])</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>    <span class="k">def</span> <span class="nf">get_user_tweets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a><span class="sd">        Get all a user&#39;s tweets. This is a costly operation in that Twitter paginates tweets</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a><span class="sd">        100 at a time. Due to rate limits, and depending on how many tweets a user has, this</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a><span class="sd">        may take a while. Twitter rate epochs reset 15 minutes after the first call has been</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a><span class="sd">        made. The rate limits vary. Refer to the rate limits returned in the headers of this</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a><span class="sd">        class.</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a><span class="sd">        #### Parameters</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a><span class="sd">            user_id : str - The Twitter user&#39;s id. This is typically a 64-bit unsigned integer. Passed back to the server as a string to avoid accuracy loss. Read more: https://developer.twitter.com/en/docs/twitter-ids</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a><span class="sd">            pages : int - Number of pages to request. Pages are 100 tweets. To get a user&#39;s entire profile, check their tweet count, divide by 100, and round up. If pages is not specified, the function will run recursively until all available pages have been retrieved or the rate limit has been reached.</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a><span class="sd">            timer : bool</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a><span class="sd">        #### Returns</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a><span class="sd">            pandas.DataFrame - The DataFrame with a user&#39;s tweets.</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a><span class="sd">        #### Example</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a><span class="sd">            Getting all available user tweets</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a><span class="sd">            `df = t1.get_user_profile(&#39;elonmusk&#39;)`</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a><span class="sd">            `df = t1.get_user_tweets(df[&#39;id&#39;][0], round(df[&#39;tweet_count&#39;][0] / 100))`</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>        <span class="k">if</span> <span class="s2">&quot;pages&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>            <span class="n">pages</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;pages&quot;</span><span class="p">]</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>            <span class="n">pages</span> <span class="o">=</span> <span class="mi">1500</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pages</span><span class="p">):</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">get_url</span><span class="p">(</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>                    <span class="sa">f</span><span class="s2">&quot;https://api.twitter.com/2/users/</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">/tweets?tweet.fields=created_at,text,public_metrics&amp;max_results=100&quot;</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>                <span class="p">)</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">):</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;UsageCapExceeded&quot;</span><span class="p">:</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>                        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Usage cap exceeded for Tweets.&quot;</span><span class="p">)</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>                        <span class="k">break</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">):</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a>                    <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a>                    <span class="n">next_token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;meta&quot;</span><span class="p">][</span><span class="s2">&quot;next_token&quot;</span><span class="p">]</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">get_url</span><span class="p">(</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>                        <span class="sa">f</span><span class="s2">&quot;https://api.twitter.com/2/users/</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">/tweets?tweet.fields=created_at,text,public_metrics&amp;max_results=100&amp;pagination_token=</span><span class="si">{</span><span class="n">next_token</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>                    <span class="p">)</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>                    <span class="n">df2</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>                    <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>                    <span class="k">break</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;timer&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a>                <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;timer&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sleeping...-_-...&quot;</span><span class="p">)</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">59</span><span class="p">)</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>            <span class="n">df2</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;public_metrics&quot;</span><span class="p">])</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;user_tweets&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_server_limits</span><span class="p">()</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;user_tweets&quot;</span><span class="p">][</span><span class="s2">&quot;checked_at&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>            <span class="k">return</span> <span class="n">pandas</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>                <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;public_metrics&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>            <span class="p">)</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;user_tweets&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_server_limits</span><span class="p">()</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;user_tweets&quot;</span><span class="p">][</span><span class="s2">&quot;checked_at&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;errors&quot;</span><span class="p">):</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a>                <span class="k">return</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;errors&quot;</span><span class="p">])</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a>                <span class="k">return</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()])</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>    <span class="k">def</span> <span class="nf">get_user_following</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a><span class="sd">        Get all the users the requested account follows. If `pages` is not specified the function will run recursively.</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a><span class="sd">        Endpoint: Users &gt; Follows lookup &gt; Limit: 15</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a><span class="sd">        #### Parameters</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a><span class="sd">            user_id : str - The Twitter user&#39;s id. This is typically a 64-bit unsigned integer. Passed back to the server as a string to avoid accuracy loss. Read more: https://developer.twitter.com/en/docs/twitter-ids</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a><span class="sd">            pages : int - Number of pages to request. Pages are 100 tweets. To get a user&#39;s entire profile, check their tweet count, divide by 100, and round up. If pages is not specified, the function will run recursively until all available pages have been retrieved or the rate limit has been reached.</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a><span class="sd">            timer : bool - Default `False`. If `True`, the script will use a sleep timer to prevent running over the rate limit. This means one page is collected per minute, until the end of pagination.</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a><span class="sd">        #### Returns</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a><span class="sd">            pandas.DataFrame - The DataFrame with a user&#39;s tweets.</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a>        <span class="k">if</span> <span class="s2">&quot;pages&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a>            <span class="n">pages</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;pages&quot;</span><span class="p">]</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a>            <span class="n">pages</span> <span class="o">=</span> <span class="mi">15</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pages</span><span class="p">):</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">get_url</span><span class="p">(</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a>                    <span class="sa">f</span><span class="s2">&quot;https://api.twitter.com/2/users/</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">/following?user.fields=id,name,username,public_metrics&amp;max_results=1000&quot;</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>                <span class="p">)</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a>                <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>                    <span class="n">next_token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;meta&quot;</span><span class="p">][</span><span class="s2">&quot;next_token&quot;</span><span class="p">]</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">get_url</span><span class="p">(</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>                        <span class="sa">f</span><span class="s2">&quot;https://api.twitter.com/2/users/</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">/following?user.fields=id,name,username,public_metrics&amp;max_results=1000&amp;pagination_token=</span><span class="si">{</span><span class="n">next_token</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>                    <span class="p">)</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>                    <span class="n">df2</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a>                    <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a>                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>                    <span class="k">break</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>            <span class="k">if</span> <span class="s2">&quot;timer&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>                <span class="n">timer</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;timer&quot;</span><span class="p">]</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>                <span class="n">timer</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a>            <span class="k">if</span> <span class="n">timer</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sleeping...-_-...&quot;</span><span class="p">)</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a>                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">59</span><span class="p">)</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;user_following&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_server_limits</span><span class="p">()</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;user_following&quot;</span><span class="p">][</span><span class="s2">&quot;checked_at&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a>        <span class="k">return</span> <span class="n">df</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a>    <span class="k">def</span> <span class="nf">get_user_followers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a><span class="sd">        Get a user&#39;s followers.</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a><span class="sd">        Attributes</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a><span class="sd">            pages : int</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a><span class="sd">            timer : bool</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a>        <span class="k">if</span> <span class="s2">&quot;pages&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a>            <span class="n">pages</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;pages&quot;</span><span class="p">]</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a>            <span class="n">pages</span> <span class="o">=</span> <span class="mi">15</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pages</span><span class="p">):</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">get_url</span><span class="p">(</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a>                    <span class="sa">f</span><span class="s2">&quot;https://api.twitter.com/2/users/</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">/followers?user.fields=id,name,username,public_metrics&amp;max_results=1000&quot;</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a>                <span class="p">)</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a>                <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a>                    <span class="n">next_token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;meta&quot;</span><span class="p">][</span><span class="s2">&quot;next_token&quot;</span><span class="p">]</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">get_url</span><span class="p">(</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a>                        <span class="sa">f</span><span class="s2">&quot;https://api.twitter.com/2/users/</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">/followers?user.fields=id,name,username,public_metrics&amp;max_results=1000&amp;pagination_token=</span><span class="si">{</span><span class="n">next_token</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a>                    <span class="p">)</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a>                    <span class="n">df2</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a>                    <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a>                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a>                    <span class="k">break</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a>            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;timer&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a>                <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;timer&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sleeping...-_-...&quot;</span><span class="p">)</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a>                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">59</span><span class="p">)</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;user_followers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_server_limits</span><span class="p">()</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;user_followers&quot;</span><span class="p">][</span><span class="s2">&quot;checked_at&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a>        <span class="k">return</span> <span class="n">df</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a>    <span class="k">def</span> <span class="nf">get_user_snapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a><span class="sd">        Get profile, tweets, following, and followers of user</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a><span class="sd">        with no page limits, and write to db.</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a><span class="sd">        Must already have instantiated a Twitter_Session class</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a><span class="sd">        object, and passed it a bearer token using get_token_local().</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a><span class="sd">        Parameters</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a><span class="sd">            username : str - The @username. Can be passed with or without &#39;@&#39;.</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a><span class="sd">            followers : bool - Gather followers. Default == `False`.</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a>
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a><span class="sd">            following : bool - Gather following. Default == `False`.</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_user_profile</span><span class="p">(</span><span class="n">username</span><span class="p">)</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">df_to_db</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">df</span><span class="p">,</span> <span class="s2">&quot;profile&quot;</span><span class="p">)</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a>        <span class="n">df2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_user_tweets</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">df_to_db</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">df2</span><span class="p">,</span> <span class="s2">&quot;tweets&quot;</span><span class="p">)</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a>        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;followers&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a>            <span class="n">df3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_user_following</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">df_to_db</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">df3</span><span class="p">,</span> <span class="s2">&quot;following&quot;</span><span class="p">)</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a>        <span class="k">elif</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;following&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a>            <span class="n">df4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_user_followers</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">df_to_db</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">df4</span><span class="p">,</span> <span class="s2">&quot;followers&quot;</span><span class="p">)</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a>    <span class="k">def</span> <span class="nf">get_string_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a><span class="sd">        Query Twitter. Returns the last n pages of tweets containing the query string.</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a>
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a><span class="sd">        #### Parameters</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a><span class="sd">            query : str - The string to be searched for. Can include hashtags.</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a>
</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a><span class="sd">            pages : int - The number of pages to return. A page is 100 tweets. Default = 0.</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a>
</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a>        <span class="k">if</span> <span class="s2">&quot;pages&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a>
</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a>            <span class="n">pages</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;pages&quot;</span><span class="p">]</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a>
</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a>
</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a>            <span class="n">pages</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a>
</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a>
</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pages</span><span class="p">):</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a>
</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a>
</span><span id="L-501"><a href="#L-501"><span class="linenos">501</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">get_url</span><span class="p">(</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos">502</span></a>                    <span class="sa">f</span><span class="s2">&quot;https://api.twitter.com/2/tweets/search/recent?query=</span><span class="si">{</span><span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">query</span><span class="p">)</span><span class="si">}</span><span class="s2">&amp;max_results=100&quot;</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos">503</span></a>                <span class="p">)</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos">504</span></a>
</span><span id="L-505"><a href="#L-505"><span class="linenos">505</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;query&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_server_limits</span><span class="p">()</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos">506</span></a>
</span><span id="L-507"><a href="#L-507"><span class="linenos">507</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;query&quot;</span><span class="p">][</span><span class="s2">&quot;checked_at&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos">508</span></a>
</span><span id="L-509"><a href="#L-509"><span class="linenos">509</span></a>                <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos">510</span></a>
</span><span id="L-511"><a href="#L-511"><span class="linenos">511</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos">512</span></a>
</span><span id="L-513"><a href="#L-513"><span class="linenos">513</span></a>                <span class="n">next_token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;meta&quot;</span><span class="p">][</span><span class="s2">&quot;next_token&quot;</span><span class="p">]</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos">514</span></a>
</span><span id="L-515"><a href="#L-515"><span class="linenos">515</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">get_url</span><span class="p">(</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos">516</span></a>                    <span class="sa">f</span><span class="s2">&quot;https://api.twitter.com/2/tweets/search/recent?query=</span><span class="si">{</span><span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">query</span><span class="p">)</span><span class="si">}</span><span class="s2">&amp;max_results=100&amp;pagination_token=</span><span class="si">{</span><span class="n">next_token</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos">517</span></a>                <span class="p">)</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos">518</span></a>
</span><span id="L-519"><a href="#L-519"><span class="linenos">519</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;query&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_server_limits</span><span class="p">()</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos">520</span></a>
</span><span id="L-521"><a href="#L-521"><span class="linenos">521</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;query&quot;</span><span class="p">][</span><span class="s2">&quot;checked_at&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos">522</span></a>
</span><span id="L-523"><a href="#L-523"><span class="linenos">523</span></a>                <span class="n">df2</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos">524</span></a>
</span><span id="L-525"><a href="#L-525"><span class="linenos">525</span></a>                <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos">526</span></a>
</span><span id="L-527"><a href="#L-527"><span class="linenos">527</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">query_log</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">query_log</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos">528</span></a>            <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos">529</span></a>            <span class="s2">&quot;x-transaction-id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;x-transaction-id&quot;</span><span class="p">],</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos">530</span></a>            <span class="s2">&quot;query_term&quot;</span><span class="p">:</span> <span class="n">query</span><span class="p">,</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos">531</span></a>            <span class="s2">&quot;parsed_query_term&quot;</span><span class="p">:</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">query</span><span class="p">),</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos">532</span></a>        <span class="p">}</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos">533</span></a>
</span><span id="L-534"><a href="#L-534"><span class="linenos">534</span></a>        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos">535</span></a>
</span><span id="L-536"><a href="#L-536"><span class="linenos">536</span></a>    <span class="k">def</span> <span class="nf">return_server_limits</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos">537</span></a>
</span><span id="L-538"><a href="#L-538"><span class="linenos">538</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos">539</span></a><span class="sd">        Return Twitter server rate limits and timers from the response in memory. Used to update the limit log internally.</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos">540</span></a>
</span><span id="L-541"><a href="#L-541"><span class="linenos">541</span></a><span class="sd">        #### Returns</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos">542</span></a>
</span><span id="L-543"><a href="#L-543"><span class="linenos">543</span></a><span class="sd">            A dictionary with the following schema:</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos">544</span></a>
</span><span id="L-545"><a href="#L-545"><span class="linenos">545</span></a><span class="sd">                {</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos">546</span></a><span class="sd">                    &#39;remaining&#39;: float,</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos">547</span></a><span class="sd">                    &#39;limit&#39;: float,</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos">548</span></a><span class="sd">                    &#39;limit_reset&#39;: str,</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos">549</span></a><span class="sd">                    &#39;percent_remaining&#39;: int,</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos">550</span></a><span class="sd">                    &#39;limit_delta&#39;: str</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos">551</span></a><span class="sd">                    }</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos">552</span></a>
</span><span id="L-553"><a href="#L-553"><span class="linenos">553</span></a><span class="sd">            ##### Attributes</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos">554</span></a>
</span><span id="L-555"><a href="#L-555"><span class="linenos">555</span></a><span class="sd">                remaining : float - Transmission-rate limit remaining in epoch for this endpoint.</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos">556</span></a>
</span><span id="L-557"><a href="#L-557"><span class="linenos">557</span></a><span class="sd">                limit : float - Total call limit for the endpoint, per epoch.</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos">558</span></a>
</span><span id="L-559"><a href="#L-559"><span class="linenos">559</span></a><span class="sd">                limit_reset : str - The time when the limit epoch resets. Converted from unix time stamp to a string with `%H:%M:%S` format.</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos">560</span></a>
</span><span id="L-561"><a href="#L-561"><span class="linenos">561</span></a><span class="sd">                percent_remaining : int - Percentage remaining in the call limit, for this epoch.</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos">562</span></a>
</span><span id="L-563"><a href="#L-563"><span class="linenos">563</span></a><span class="sd">                limit_delta : str - Difference between when the limit resets and now, in `%H:%M:%S` format.</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos">564</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos">565</span></a>
</span><span id="L-566"><a href="#L-566"><span class="linenos">566</span></a>        <span class="n">return_headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">headers</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos">567</span></a>
</span><span id="L-568"><a href="#L-568"><span class="linenos">568</span></a>        <span class="n">remaining</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">return_headers</span><span class="p">[</span><span class="s2">&quot;x-rate-limit-remaining&quot;</span><span class="p">])</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos">569</span></a>
</span><span id="L-570"><a href="#L-570"><span class="linenos">570</span></a>        <span class="n">limit</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">return_headers</span><span class="p">[</span><span class="s2">&quot;x-rate-limit-limit&quot;</span><span class="p">])</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos">571</span></a>
</span><span id="L-572"><a href="#L-572"><span class="linenos">572</span></a>        <span class="n">percent_remaining</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">remaining</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">limit</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos">573</span></a>
</span><span id="L-574"><a href="#L-574"><span class="linenos">574</span></a>        <span class="c1"># TODO rename this variable</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos">575</span></a>        <span class="c1"># NOTE this is used as the delta in a streamlit.metric object</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos">576</span></a>        <span class="n">remaining_math</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span> <span class="o">-</span> <span class="n">percent_remaining</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos">577</span></a>
</span><span id="L-578"><a href="#L-578"><span class="linenos">578</span></a>        <span class="c1"># TODO there has to be a better way than the following:</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos">579</span></a>        <span class="n">limit_reset</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos">580</span></a>            <span class="s2">&quot;%H:%M:%S&quot;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">localtime</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">return_headers</span><span class="p">[</span><span class="s2">&quot;x-rate-limit-reset&quot;</span><span class="p">]))</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos">581</span></a>        <span class="p">)</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos">582</span></a>
</span><span id="L-583"><a href="#L-583"><span class="linenos">583</span></a>        <span class="n">limit_reset</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">limit_reset</span><span class="p">,</span> <span class="s2">&quot;%H:%M:%S&quot;</span><span class="p">)</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos">584</span></a>
</span><span id="L-585"><a href="#L-585"><span class="linenos">585</span></a>        <span class="n">limit_reset</span> <span class="o">=</span> <span class="n">limit_reset</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos">586</span></a>
</span><span id="L-587"><a href="#L-587"><span class="linenos">587</span></a>        <span class="n">time_now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos">588</span></a>
</span><span id="L-589"><a href="#L-589"><span class="linenos">589</span></a>        <span class="n">time_now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos">590</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">time_now</span><span class="o">.</span><span class="n">hour</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">time_now</span><span class="o">.</span><span class="n">minute</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">time_now</span><span class="o">.</span><span class="n">second</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;%H:%M:%S&quot;</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos">591</span></a>        <span class="p">)</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos">592</span></a>
</span><span id="L-593"><a href="#L-593"><span class="linenos">593</span></a>        <span class="n">time_now</span> <span class="o">=</span> <span class="n">time_now</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos">594</span></a>
</span><span id="L-595"><a href="#L-595"><span class="linenos">595</span></a>        <span class="n">limit_reset</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">(),</span> <span class="n">limit_reset</span><span class="p">)</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos">596</span></a>
</span><span id="L-597"><a href="#L-597"><span class="linenos">597</span></a>        <span class="n">time_now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">(),</span> <span class="n">time_now</span><span class="p">)</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos">598</span></a>
</span><span id="L-599"><a href="#L-599"><span class="linenos">599</span></a>        <span class="n">limit_delta</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">limit_reset</span> <span class="o">-</span> <span class="n">time_now</span><span class="p">)</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos">600</span></a>
</span><span id="L-601"><a href="#L-601"><span class="linenos">601</span></a>        <span class="n">limit_reset</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">limit_reset</span><span class="p">,</span> <span class="s2">&quot;%H:%M:%S&quot;</span><span class="p">)</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos">602</span></a>
</span><span id="L-603"><a href="#L-603"><span class="linenos">603</span></a>        <span class="nb">dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos">604</span></a>            <span class="s2">&quot;remaining&quot;</span><span class="p">:</span> <span class="n">remaining</span><span class="p">,</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos">605</span></a>            <span class="s2">&quot;limit&quot;</span><span class="p">:</span> <span class="n">limit</span><span class="p">,</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos">606</span></a>            <span class="s2">&quot;limit_reset&quot;</span><span class="p">:</span> <span class="n">limit_reset</span><span class="p">,</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos">607</span></a>            <span class="s2">&quot;percent_remaining&quot;</span><span class="p">:</span> <span class="n">percent_remaining</span><span class="p">,</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos">608</span></a>            <span class="s2">&quot;limit_delta&quot;</span><span class="p">:</span> <span class="n">limit_delta</span><span class="p">,</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos">609</span></a>        <span class="p">}</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos">610</span></a>
</span><span id="L-611"><a href="#L-611"><span class="linenos">611</span></a>        <span class="k">return</span> <span class="nb">dict</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos">612</span></a>
</span><span id="L-613"><a href="#L-613"><span class="linenos">613</span></a>    <span class="k">def</span> <span class="nf">df_to_db</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos">614</span></a>
</span><span id="L-615"><a href="#L-615"><span class="linenos">615</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos">616</span></a><span class="sd">        Write user&#39;s twitter data to a SQLite3 database using an SQLAlchemy engine.</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos">617</span></a>
</span><span id="L-618"><a href="#L-618"><span class="linenos">618</span></a><span class="sd">        #### Parameters</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos">619</span></a>
</span><span id="L-620"><a href="#L-620"><span class="linenos">620</span></a><span class="sd">            data : pandas.DataFrame - The DataFrame with user profile data, as formatted by get_user_profile().</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos">621</span></a>
</span><span id="L-622"><a href="#L-622"><span class="linenos">622</span></a><span class="sd">            type : str - profile, tweets, following, query</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos">623</span></a>
</span><span id="L-624"><a href="#L-624"><span class="linenos">624</span></a><span class="sd">            query_term : str - The term used in a get_string_query().</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos">625</span></a>
</span><span id="L-626"><a href="#L-626"><span class="linenos">626</span></a><span class="sd">        #### Attributes</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos">627</span></a>
</span><span id="L-628"><a href="#L-628"><span class="linenos">628</span></a><span class="sd">            id : str - The table id to be stored under. If type is profile, tweets, or following the id will be the user id of the profile. If a query, use &#39;x-transaction-id&#39; from the query response header.</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos">629</span></a>
</span><span id="L-630"><a href="#L-630"><span class="linenos">630</span></a><span class="sd">        #### Example</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos">631</span></a>
</span><span id="L-632"><a href="#L-632"><span class="linenos">632</span></a><span class="sd">            `t1 = Twitter_Session()`</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos">633</span></a><span class="sd">            `t1.get_token_local(&#39;/home/user/keys.json&#39;)`</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos">634</span></a><span class="sd">            `df = t1.get_user_profile(&#39;elonmusk&#39;)`</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos">635</span></a><span class="sd">            `t1.df_to_db(user_id = df[&#39;id&#39;][0], data = df, type=&#39;profile&#39;)`</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos">636</span></a><span class="sd">            `df2 = t1.get_user_tweets(user_id = df[&#39;id&#39;][0])`</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos">637</span></a><span class="sd">            `t1.df_to_db(user_id = df[&#39;id&#39;][0], data = df2, type=&#39;tweets&#39;)`</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos">638</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos">639</span></a>
</span><span id="L-640"><a href="#L-640"><span class="linenos">640</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos">641</span></a>
</span><span id="L-642"><a href="#L-642"><span class="linenos">642</span></a>            <span class="n">query_term</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;query_term&quot;</span><span class="p">]</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos">643</span></a>
</span><span id="L-644"><a href="#L-644"><span class="linenos">644</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos">645</span></a>
</span><span id="L-646"><a href="#L-646"><span class="linenos">646</span></a>            <span class="n">query_term</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos">647</span></a>
</span><span id="L-648"><a href="#L-648"><span class="linenos">648</span></a>        <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;profile&quot;</span><span class="p">:</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos">649</span></a>
</span><span id="L-650"><a href="#L-650"><span class="linenos">650</span></a>            <span class="n">engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sqlite:///data/</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">.db&quot;</span><span class="p">)</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos">651</span></a>
</span><span id="L-652"><a href="#L-652"><span class="linenos">652</span></a>            <span class="n">table_name</span> <span class="o">=</span> <span class="s2">&quot;profile&quot;</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos">653</span></a>
</span><span id="L-654"><a href="#L-654"><span class="linenos">654</span></a>        <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;tweets&quot;</span><span class="p">:</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos">655</span></a>
</span><span id="L-656"><a href="#L-656"><span class="linenos">656</span></a>            <span class="n">engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sqlite:///data/</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">.db&quot;</span><span class="p">)</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos">657</span></a>
</span><span id="L-658"><a href="#L-658"><span class="linenos">658</span></a>            <span class="n">table_name</span> <span class="o">=</span> <span class="s2">&quot;tweets&quot;</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos">659</span></a>
</span><span id="L-660"><a href="#L-660"><span class="linenos">660</span></a>        <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;following&quot;</span><span class="p">:</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos">661</span></a>
</span><span id="L-662"><a href="#L-662"><span class="linenos">662</span></a>            <span class="n">engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sqlite:///data/</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">.db&quot;</span><span class="p">)</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos">663</span></a>
</span><span id="L-664"><a href="#L-664"><span class="linenos">664</span></a>            <span class="n">table_name</span> <span class="o">=</span> <span class="s2">&quot;following&quot;</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos">665</span></a>
</span><span id="L-666"><a href="#L-666"><span class="linenos">666</span></a>        <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;followers&quot;</span><span class="p">:</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos">667</span></a>
</span><span id="L-668"><a href="#L-668"><span class="linenos">668</span></a>            <span class="n">engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sqlite:///data/</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">.db&quot;</span><span class="p">)</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos">669</span></a>
</span><span id="L-670"><a href="#L-670"><span class="linenos">670</span></a>            <span class="n">table_name</span> <span class="o">=</span> <span class="s2">&quot;followers&quot;</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos">671</span></a>
</span><span id="L-672"><a href="#L-672"><span class="linenos">672</span></a>        <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;query&quot;</span><span class="p">:</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos">673</span></a>
</span><span id="L-674"><a href="#L-674"><span class="linenos">674</span></a>            <span class="n">engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;sqlite:///data/twitter_queries.db&quot;</span><span class="p">)</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos">675</span></a>
</span><span id="L-676"><a href="#L-676"><span class="linenos">676</span></a>            <span class="n">table_name</span> <span class="o">=</span> <span class="nb">id</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos">677</span></a>            <span class="sd">&quot;&quot;&quot;For queries, use self.response.headers[&#39;x-transaction-id&#39;]&quot;&quot;&quot;</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos">678</span></a>
</span><span id="L-679"><a href="#L-679"><span class="linenos">679</span></a>            <span class="n">data</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;query_term&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">query_term</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))])</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos">680</span></a>
</span><span id="L-681"><a href="#L-681"><span class="linenos">681</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos">682</span></a>
</span><span id="L-683"><a href="#L-683"><span class="linenos">683</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;type must be one of: profile, tweets, following, query&quot;</span><span class="p">)</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos">684</span></a>
</span><span id="L-685"><a href="#L-685"><span class="linenos">685</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos">686</span></a>
</span><span id="L-687"><a href="#L-687"><span class="linenos">687</span></a>            <span class="n">data</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos">688</span></a>                <span class="mi">0</span><span class="p">,</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos">689</span></a>                <span class="s2">&quot;capture_timestamp&quot;</span><span class="p">,</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos">690</span></a>                <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))],</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos">691</span></a>            <span class="p">)</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos">692</span></a>
</span><span id="L-693"><a href="#L-693"><span class="linenos">693</span></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>  <span class="c1"># work-around to avoid producing a Nonetype DataFrame</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos">694</span></a>
</span><span id="L-695"><a href="#L-695"><span class="linenos">695</span></a>            <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="s2">&quot;capture_timestamp&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos">696</span></a>
</span><span id="L-697"><a href="#L-697"><span class="linenos">697</span></a>            <span class="n">data</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos">698</span></a>                <span class="mi">0</span><span class="p">,</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos">699</span></a>                <span class="s2">&quot;capture_timestamp&quot;</span><span class="p">,</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos">700</span></a>                <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))],</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos">701</span></a>            <span class="p">)</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos">702</span></a>
</span><span id="L-703"><a href="#L-703"><span class="linenos">703</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;str&quot;</span><span class="p">)</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos">704</span></a>
</span><span id="L-705"><a href="#L-705"><span class="linenos">705</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos">706</span></a>
</span><span id="L-707"><a href="#L-707"><span class="linenos">707</span></a>        <span class="n">data</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">table_name</span><span class="p">),</span> <span class="n">con</span><span class="o">=</span><span class="n">engine</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s2">&quot;append&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos">708</span></a>
</span><span id="L-709"><a href="#L-709"><span class="linenos">709</span></a>        <span class="n">engine</span><span class="o">.</span><span class="n">dispose</span><span class="p">()</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos">710</span></a>
</span><span id="L-711"><a href="#L-711"><span class="linenos">711</span></a>    <span class="k">def</span> <span class="nf">db_to_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos">712</span></a>
</span><span id="L-713"><a href="#L-713"><span class="linenos">713</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos">714</span></a><span class="sd">        Read a user&#39;s data from a specified database into a pandas DataFrame.</span>
</span><span id="L-715"><a href="#L-715"><span class="linenos">715</span></a>
</span><span id="L-716"><a href="#L-716"><span class="linenos">716</span></a><span class="sd">        #### Paramters</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos">717</span></a>
</span><span id="L-718"><a href="#L-718"><span class="linenos">718</span></a><span class="sd">            id : str - The user id of the profile. Can be referenced from the dataframe, or passed as string.</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos">719</span></a>
</span><span id="L-720"><a href="#L-720"><span class="linenos">720</span></a><span class="sd">            type : str - profile, tweets, following</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos">721</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos">722</span></a>
</span><span id="L-723"><a href="#L-723"><span class="linenos">723</span></a>        <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;profile&quot;</span><span class="p">:</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos">724</span></a>
</span><span id="L-725"><a href="#L-725"><span class="linenos">725</span></a>            <span class="n">engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sqlite:///data/</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">.db&quot;</span><span class="p">)</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos">726</span></a>
</span><span id="L-727"><a href="#L-727"><span class="linenos">727</span></a>            <span class="n">table_name</span> <span class="o">=</span> <span class="s2">&quot;profile&quot;</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos">728</span></a>
</span><span id="L-729"><a href="#L-729"><span class="linenos">729</span></a>        <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;tweets&quot;</span><span class="p">:</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos">730</span></a>
</span><span id="L-731"><a href="#L-731"><span class="linenos">731</span></a>            <span class="n">engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sqlite:///data/</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">.db&quot;</span><span class="p">)</span>
</span><span id="L-732"><a href="#L-732"><span class="linenos">732</span></a>
</span><span id="L-733"><a href="#L-733"><span class="linenos">733</span></a>            <span class="n">table_name</span> <span class="o">=</span> <span class="s2">&quot;tweets&quot;</span>
</span><span id="L-734"><a href="#L-734"><span class="linenos">734</span></a>
</span><span id="L-735"><a href="#L-735"><span class="linenos">735</span></a>        <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;following&quot;</span><span class="p">:</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos">736</span></a>
</span><span id="L-737"><a href="#L-737"><span class="linenos">737</span></a>            <span class="n">engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sqlite:///data/</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">.db&quot;</span><span class="p">)</span>
</span><span id="L-738"><a href="#L-738"><span class="linenos">738</span></a>
</span><span id="L-739"><a href="#L-739"><span class="linenos">739</span></a>            <span class="n">table_name</span> <span class="o">=</span> <span class="s2">&quot;following&quot;</span>
</span><span id="L-740"><a href="#L-740"><span class="linenos">740</span></a>
</span><span id="L-741"><a href="#L-741"><span class="linenos">741</span></a>        <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;followers&quot;</span><span class="p">:</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos">742</span></a>
</span><span id="L-743"><a href="#L-743"><span class="linenos">743</span></a>            <span class="n">engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sqlite:///data/</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">.db&quot;</span><span class="p">)</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos">744</span></a>
</span><span id="L-745"><a href="#L-745"><span class="linenos">745</span></a>            <span class="n">table_name</span> <span class="o">=</span> <span class="s2">&quot;followers&quot;</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos">746</span></a>
</span><span id="L-747"><a href="#L-747"><span class="linenos">747</span></a>        <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;query&quot;</span><span class="p">:</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos">748</span></a>
</span><span id="L-749"><a href="#L-749"><span class="linenos">749</span></a>            <span class="n">engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;sqlite:///data/twitter_queries.db&quot;</span><span class="p">)</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos">750</span></a>
</span><span id="L-751"><a href="#L-751"><span class="linenos">751</span></a>            <span class="n">table_name</span> <span class="o">=</span> <span class="nb">id</span>
</span><span id="L-752"><a href="#L-752"><span class="linenos">752</span></a>            <span class="sd">&quot;&quot;&quot;For queries, use self.response.headers[&#39;x-transaction-id&#39;]&quot;&quot;&quot;</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos">753</span></a>
</span><span id="L-754"><a href="#L-754"><span class="linenos">754</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-755"><a href="#L-755"><span class="linenos">755</span></a>
</span><span id="L-756"><a href="#L-756"><span class="linenos">756</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;type must be one of: profile, tweets, following, query&quot;</span><span class="p">)</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos">757</span></a>
</span><span id="L-758"><a href="#L-758"><span class="linenos">758</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_sql_table</span><span class="p">(</span><span class="n">table_name</span><span class="o">=</span><span class="n">table_name</span><span class="p">,</span> <span class="n">con</span><span class="o">=</span><span class="n">engine</span><span class="p">)</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos">759</span></a>
</span><span id="L-760"><a href="#L-760"><span class="linenos">760</span></a>        <span class="n">engine</span><span class="o">.</span><span class="n">dispose</span><span class="p">()</span>
</span><span id="L-761"><a href="#L-761"><span class="linenos">761</span></a>
</span><span id="L-762"><a href="#L-762"><span class="linenos">762</span></a>        <span class="k">return</span> <span class="n">df</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos">763</span></a>
</span><span id="L-764"><a href="#L-764"><span class="linenos">764</span></a>    <span class="k">def</span> <span class="nf">get_dbs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-765"><a href="#L-765"><span class="linenos">765</span></a>
</span><span id="L-766"><a href="#L-766"><span class="linenos">766</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos">767</span></a><span class="sd">        Retrieve Twitter databases. Uses regex to check file names for an expected convention.</span>
</span><span id="L-768"><a href="#L-768"><span class="linenos">768</span></a>
</span><span id="L-769"><a href="#L-769"><span class="linenos">769</span></a><span class="sd">        This will be deprecated by class Database_Functions.</span>
</span><span id="L-770"><a href="#L-770"><span class="linenos">770</span></a>
</span><span id="L-771"><a href="#L-771"><span class="linenos">771</span></a><span class="sd">        Returns</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos">772</span></a>
</span><span id="L-773"><a href="#L-773"><span class="linenos">773</span></a><span class="sd">            A list of database files by user id.</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos">774</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-775"><a href="#L-775"><span class="linenos">775</span></a>
</span><span id="L-776"><a href="#L-776"><span class="linenos">776</span></a>        <span class="n">files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;data/*.db&quot;</span><span class="p">)</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos">777</span></a>
</span><span id="L-778"><a href="#L-778"><span class="linenos">778</span></a>        <span class="n">l</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos">779</span></a>            <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(\d+.db)&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">files</span>
</span><span id="L-780"><a href="#L-780"><span class="linenos">780</span></a>        <span class="p">]</span>  <span class="c1"># regex for any files consisting of [0-9].db</span>
</span><span id="L-781"><a href="#L-781"><span class="linenos">781</span></a>
</span><span id="L-782"><a href="#L-782"><span class="linenos">782</span></a>        <span class="n">processed_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">l</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
</span><span id="L-783"><a href="#L-783"><span class="linenos">783</span></a>
</span><span id="L-784"><a href="#L-784"><span class="linenos">784</span></a>        <span class="k">return</span> <span class="n">processed_list</span>
</span><span id="L-785"><a href="#L-785"><span class="linenos">785</span></a>
</span><span id="L-786"><a href="#L-786"><span class="linenos">786</span></a>
</span><span id="L-787"><a href="#L-787"><span class="linenos">787</span></a><span class="nd">@dataclass</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos">788</span></a><span class="k">class</span> <span class="nc">Database_Functions</span><span class="p">:</span>
</span><span id="L-789"><a href="#L-789"><span class="linenos">789</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos">790</span></a>
</span><span id="L-791"><a href="#L-791"><span class="linenos">791</span></a>        <span class="sd">&quot;&quot;&quot;Database functions.&quot;&quot;&quot;</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos">792</span></a>
</span><span id="L-793"><a href="#L-793"><span class="linenos">793</span></a>    <span class="k">def</span> <span class="nf">list_db_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-794"><a href="#L-794"><span class="linenos">794</span></a>
</span><span id="L-795"><a href="#L-795"><span class="linenos">795</span></a>        <span class="n">files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;data/*.db&quot;</span><span class="p">)</span>
</span><span id="L-796"><a href="#L-796"><span class="linenos">796</span></a>
</span><span id="L-797"><a href="#L-797"><span class="linenos">797</span></a>        <span class="n">list_keys</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-798"><a href="#L-798"><span class="linenos">798</span></a>
</span><span id="L-799"><a href="#L-799"><span class="linenos">799</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
</span><span id="L-800"><a href="#L-800"><span class="linenos">800</span></a>
</span><span id="L-801"><a href="#L-801"><span class="linenos">801</span></a>            <span class="n">engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos">802</span></a>                <span class="sa">f</span><span class="s2">&quot;sqlite+pysqlite:///</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">future</span><span class="o">=</span><span class="kc">True</span>
</span><span id="L-803"><a href="#L-803"><span class="linenos">803</span></a>            <span class="p">)</span>
</span><span id="L-804"><a href="#L-804"><span class="linenos">804</span></a>
</span><span id="L-805"><a href="#L-805"><span class="linenos">805</span></a>            <span class="n">s</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">MetaData</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="n">engine</span><span class="p">)</span>
</span><span id="L-806"><a href="#L-806"><span class="linenos">806</span></a>
</span><span id="L-807"><a href="#L-807"><span class="linenos">807</span></a>            <span class="n">s</span><span class="o">.</span><span class="n">reflect</span><span class="p">()</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos">808</span></a>
</span><span id="L-809"><a href="#L-809"><span class="linenos">809</span></a>            <span class="n">list_keys</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">s</span><span class="o">.</span><span class="n">tables</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">i</span><span class="p">))</span>
</span><span id="L-810"><a href="#L-810"><span class="linenos">810</span></a>
</span><span id="L-811"><a href="#L-811"><span class="linenos">811</span></a>        <span class="k">return</span> <span class="n">list_keys</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos">812</span></a>
</span><span id="L-813"><a href="#L-813"><span class="linenos">813</span></a>    <span class="k">def</span> <span class="nf">list_db_tables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db</span><span class="p">):</span>
</span><span id="L-814"><a href="#L-814"><span class="linenos">814</span></a>
</span><span id="L-815"><a href="#L-815"><span class="linenos">815</span></a>        <span class="n">engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span>
</span><span id="L-816"><a href="#L-816"><span class="linenos">816</span></a>            <span class="sa">f</span><span class="s2">&quot;sqlite+pysqlite:///</span><span class="si">{</span><span class="n">db</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">future</span><span class="o">=</span><span class="kc">True</span>
</span><span id="L-817"><a href="#L-817"><span class="linenos">817</span></a>        <span class="p">)</span>
</span><span id="L-818"><a href="#L-818"><span class="linenos">818</span></a>
</span><span id="L-819"><a href="#L-819"><span class="linenos">819</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">MetaData</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="n">engine</span><span class="p">)</span>
</span><span id="L-820"><a href="#L-820"><span class="linenos">820</span></a>
</span><span id="L-821"><a href="#L-821"><span class="linenos">821</span></a>        <span class="n">s</span><span class="o">.</span><span class="n">reflect</span><span class="p">()</span>
</span><span id="L-822"><a href="#L-822"><span class="linenos">822</span></a>
</span><span id="L-823"><a href="#L-823"><span class="linenos">823</span></a>        <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">tables</span>
</span><span id="L-824"><a href="#L-824"><span class="linenos">824</span></a>
</span><span id="L-825"><a href="#L-825"><span class="linenos">825</span></a>
</span><span id="L-826"><a href="#L-826"><span class="linenos">826</span></a><span class="k">class</span> <span class="nc">Streamlit_Functions</span><span class="p">:</span>
</span><span id="L-827"><a href="#L-827"><span class="linenos">827</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-828"><a href="#L-828"><span class="linenos">828</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-829"><a href="#L-829"><span class="linenos">829</span></a><span class="sd">        A class for Streamlit utilities.</span>
</span><span id="L-830"><a href="#L-830"><span class="linenos">830</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-831"><a href="#L-831"><span class="linenos">831</span></a>
</span><span id="L-832"><a href="#L-832"><span class="linenos">832</span></a>    <span class="k">def</span> <span class="nf">set_boilerplate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-833"><a href="#L-833"><span class="linenos">833</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-834"><a href="#L-834"><span class="linenos">834</span></a><span class="sd">        Boilerplate setup for a Streamlit page.</span>
</span><span id="L-835"><a href="#L-835"><span class="linenos">835</span></a>
</span><span id="L-836"><a href="#L-836"><span class="linenos">836</span></a><span class="sd">        Parameters</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos">837</span></a>
</span><span id="L-838"><a href="#L-838"><span class="linenos">838</span></a><span class="sd">            page_title : str - The title bar page name.</span>
</span><span id="L-839"><a href="#L-839"><span class="linenos">839</span></a>
</span><span id="L-840"><a href="#L-840"><span class="linenos">840</span></a><span class="sd">            scroll_text : str - The text to scroll when the page loads.</span>
</span><span id="L-841"><a href="#L-841"><span class="linenos">841</span></a>
</span><span id="L-842"><a href="#L-842"><span class="linenos">842</span></a><span class="sd">            metrics : bool - Show the metrics during operations, in expanders.</span>
</span><span id="L-843"><a href="#L-843"><span class="linenos">843</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-844"><a href="#L-844"><span class="linenos">844</span></a>
</span><span id="L-845"><a href="#L-845"><span class="linenos">845</span></a>        <span class="k">if</span> <span class="s2">&quot;page_title&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos">846</span></a>
</span><span id="L-847"><a href="#L-847"><span class="linenos">847</span></a>            <span class="n">page_title</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;page_title&quot;</span><span class="p">])</span>
</span><span id="L-848"><a href="#L-848"><span class="linenos">848</span></a>
</span><span id="L-849"><a href="#L-849"><span class="linenos">849</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-850"><a href="#L-850"><span class="linenos">850</span></a>
</span><span id="L-851"><a href="#L-851"><span class="linenos">851</span></a>            <span class="n">page_title</span> <span class="o">=</span> <span class="s2">&quot;solarcho3/Web Tools&quot;</span>
</span><span id="L-852"><a href="#L-852"><span class="linenos">852</span></a>
</span><span id="L-853"><a href="#L-853"><span class="linenos">853</span></a>        <span class="n">scroll_text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-854"><a href="#L-854"><span class="linenos">854</span></a>
</span><span id="L-855"><a href="#L-855"><span class="linenos">855</span></a>        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;scroll_text&quot;</span><span class="p">):</span>
</span><span id="L-856"><a href="#L-856"><span class="linenos">856</span></a>
</span><span id="L-857"><a href="#L-857"><span class="linenos">857</span></a>            <span class="n">scroll_text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;scroll_text&quot;</span><span class="p">])</span>
</span><span id="L-858"><a href="#L-858"><span class="linenos">858</span></a>
</span><span id="L-859"><a href="#L-859"><span class="linenos">859</span></a>        <span class="kn">import</span> <span class="nn">streamlit</span> <span class="k">as</span> <span class="nn">st</span>
</span><span id="L-860"><a href="#L-860"><span class="linenos">860</span></a>
</span><span id="L-861"><a href="#L-861"><span class="linenos">861</span></a>        <span class="n">st</span><span class="o">.</span><span class="n">set_page_config</span><span class="p">(</span><span class="n">page_title</span><span class="o">=</span><span class="n">page_title</span><span class="p">,</span> <span class="n">page_icon</span><span class="o">=</span><span class="s2">&quot;:wrench:&quot;</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;wide&quot;</span><span class="p">)</span>
</span><span id="L-862"><a href="#L-862"><span class="linenos">862</span></a>
</span><span id="L-863"><a href="#L-863"><span class="linenos">863</span></a>        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;metrics&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="L-864"><a href="#L-864"><span class="linenos">864</span></a>
</span><span id="L-865"><a href="#L-865"><span class="linenos">865</span></a>            <span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">expander</span><span class="p">(</span><span class="s2">&quot;🌡️ Twitter API-server rate limit metrics&quot;</span><span class="p">):</span>
</span><span id="L-866"><a href="#L-866"><span class="linenos">866</span></a>
</span><span id="L-867"><a href="#L-867"><span class="linenos">867</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">metrics_col1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">metrics_col2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">metrics_col3</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">columns</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="L-868"><a href="#L-868"><span class="linenos">868</span></a>
</span><span id="L-869"><a href="#L-869"><span class="linenos">869</span></a>            <span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">expander</span><span class="p">(</span><span class="s2">&quot;📻 Traffic log&quot;</span><span class="p">):</span>
</span><span id="L-870"><a href="#L-870"><span class="linenos">870</span></a>
</span><span id="L-871"><a href="#L-871"><span class="linenos">871</span></a>                <span class="n">traffic</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">columns</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos">872</span></a>
</span><span id="L-873"><a href="#L-873"><span class="linenos">873</span></a>        <span class="n">scroll_container</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">empty</span><span class="p">()</span>
</span><span id="L-874"><a href="#L-874"><span class="linenos">874</span></a>
</span><span id="L-875"><a href="#L-875"><span class="linenos">875</span></a>        <span class="n">store</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-876"><a href="#L-876"><span class="linenos">876</span></a>
</span><span id="L-877"><a href="#L-877"><span class="linenos">877</span></a>        <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">scroll_text</span><span class="p">:</span>
</span><span id="L-878"><a href="#L-878"><span class="linenos">878</span></a>
</span><span id="L-879"><a href="#L-879"><span class="linenos">879</span></a>            <span class="n">store</span> <span class="o">=</span> <span class="n">store</span> <span class="o">+</span> <span class="n">char</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos">880</span></a>
</span><span id="L-881"><a href="#L-881"><span class="linenos">881</span></a>            <span class="n">scroll_container</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">store</span><span class="p">)</span>
</span><span id="L-882"><a href="#L-882"><span class="linenos">882</span></a>
</span><span id="L-883"><a href="#L-883"><span class="linenos">883</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.005</span><span class="p">)</span>
</span><span id="L-884"><a href="#L-884"><span class="linenos">884</span></a>
</span><span id="L-885"><a href="#L-885"><span class="linenos">885</span></a>    <span class="k">def</span> <span class="nf">update_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span id="L-886"><a href="#L-886"><span class="linenos">886</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-887"><a href="#L-887"><span class="linenos">887</span></a><span class="sd">        Update the boilerplate metrics.</span>
</span><span id="L-888"><a href="#L-888"><span class="linenos">888</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-889"><a href="#L-889"><span class="linenos">889</span></a>
</span><span id="L-890"><a href="#L-890"><span class="linenos">890</span></a>        <span class="n">keys_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="L-891"><a href="#L-891"><span class="linenos">891</span></a>
</span><span id="L-892"><a href="#L-892"><span class="linenos">892</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metrics_col1</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span>
</span><span id="L-893"><a href="#L-893"><span class="linenos">893</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">keys_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> % remaining&quot;</span><span class="p">,</span>
</span><span id="L-894"><a href="#L-894"><span class="linenos">894</span></a>            <span class="n">data</span><span class="p">[</span><span class="n">keys_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s2">&quot;percent_remaining&quot;</span><span class="p">],</span>
</span><span id="L-895"><a href="#L-895"><span class="linenos">895</span></a>            <span class="nb">round</span><span class="p">((</span><span class="mi">1000</span> <span class="o">/</span> <span class="n">data</span><span class="p">[</span><span class="n">keys_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s2">&quot;remaining&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
</span><span id="L-896"><a href="#L-896"><span class="linenos">896</span></a>        <span class="p">)</span>
</span><span id="L-897"><a href="#L-897"><span class="linenos">897</span></a>
</span><span id="L-898"><a href="#L-898"><span class="linenos">898</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metrics_col2</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span>
</span><span id="L-899"><a href="#L-899"><span class="linenos">899</span></a>            <span class="n">keys_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">keys_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s2">&quot;limit&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">keys_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s2">&quot;remaining&quot;</span><span class="p">]</span>
</span><span id="L-900"><a href="#L-900"><span class="linenos">900</span></a>        <span class="p">)</span>
</span><span id="L-901"><a href="#L-901"><span class="linenos">901</span></a>
</span><span id="L-902"><a href="#L-902"><span class="linenos">902</span></a>
</span><span id="L-903"><a href="#L-903"><span class="linenos">903</span></a><span class="k">def</span> <span class="nf">random_line</span><span class="p">():</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos">904</span></a>
</span><span id="L-905"><a href="#L-905"><span class="linenos">905</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-906"><a href="#L-906"><span class="linenos">906</span></a><span class="sd">    Get a random line of Shakespeare</span>
</span><span id="L-907"><a href="#L-907"><span class="linenos">907</span></a>
</span><span id="L-908"><a href="#L-908"><span class="linenos">908</span></a><span class="sd">    Returns</span>
</span><span id="L-909"><a href="#L-909"><span class="linenos">909</span></a>
</span><span id="L-910"><a href="#L-910"><span class="linenos">910</span></a><span class="sd">        line : str - A single line of Shakespeare.</span>
</span><span id="L-911"><a href="#L-911"><span class="linenos">911</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-912"><a href="#L-912"><span class="linenos">912</span></a>
</span><span id="L-913"><a href="#L-913"><span class="linenos">913</span></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;data/alllines.txt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-914"><a href="#L-914"><span class="linenos">914</span></a>
</span><span id="L-915"><a href="#L-915"><span class="linenos">915</span></a>        <span class="n">f1</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
</span><span id="L-916"><a href="#L-916"><span class="linenos">916</span></a>
</span><span id="L-917"><a href="#L-917"><span class="linenos">917</span></a>    <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">f1</span><span class="p">)</span>
</span><span id="L-918"><a href="#L-918"><span class="linenos">918</span></a>
</span><span id="L-919"><a href="#L-919"><span class="linenos">919</span></a>
</span><span id="L-920"><a href="#L-920"><span class="linenos">920</span></a><span class="k">def</span> <span class="nf">tutorial</span><span class="p">():</span>
</span><span id="L-921"><a href="#L-921"><span class="linenos">921</span></a>
</span><span id="L-922"><a href="#L-922"><span class="linenos">922</span></a>    <span class="kn">import</span> <span class="nn">streamlit</span> <span class="k">as</span> <span class="nn">st</span>
</span><span id="L-923"><a href="#L-923"><span class="linenos">923</span></a>
</span><span id="L-924"><a href="#L-924"><span class="linenos">924</span></a>    <span class="n">l1</span> <span class="o">=</span> <span class="n">random_line</span><span class="p">()</span>
</span><span id="L-925"><a href="#L-925"><span class="linenos">925</span></a>
</span><span id="L-926"><a href="#L-926"><span class="linenos">926</span></a>    <span class="n">st</span><span class="o">.</span><span class="n">code</span><span class="p">(</span>
</span><span id="L-927"><a href="#L-927"><span class="linenos">927</span></a>        <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="L-928"><a href="#L-928"><span class="linenos">928</span></a><span class="s2">    🇺🇲 Web Tools &lt;[Research Utilities]&gt;</span>
</span><span id="L-929"><a href="#L-929"><span class="linenos">929</span></a>
</span><span id="L-930"><a href="#L-930"><span class="linenos">930</span></a><span class="s2">    = Tools to request data via APIs, perform database functions, and produce analytics.</span>
</span><span id="L-931"><a href="#L-931"><span class="linenos">931</span></a>
</span><span id="L-932"><a href="#L-932"><span class="linenos">932</span></a><span class="s2">    - 🍳 This is the boilerplate text. Call set_boilerplate(scroll_text=&#39;YOUR TEXT to change this...&#39;)</span>
</span><span id="L-933"><a href="#L-933"><span class="linenos">933</span></a>
</span><span id="L-934"><a href="#L-934"><span class="linenos">934</span></a><span class="s2">    + 🍼 Show example script (the code below) - web_tools.tutorial()</span>
</span><span id="L-935"><a href="#L-935"><span class="linenos">935</span></a>
</span><span id="L-936"><a href="#L-936"><span class="linenos">936</span></a><span class="s2">    + 🍗 Documentation: https://github.com/solarecho3/web-tools  &gt;  documentation  &gt;  web_tools.htm</span>
</span><span id="L-937"><a href="#L-937"><span class="linenos">937</span></a>
</span><span id="L-938"><a href="#L-938"><span class="linenos">938</span></a><span class="s2">    - ⚔️ A line from the bard?  </span><span class="si">{</span><span class="n">l1</span><span class="si">}</span><span class="s2">  🤺</span>
</span><span id="L-939"><a href="#L-939"><span class="linenos">939</span></a>
</span><span id="L-940"><a href="#L-940"><span class="linenos">940</span></a><span class="s2">    # Example</span>
</span><span id="L-941"><a href="#L-941"><span class="linenos">941</span></a>
</span><span id="L-942"><a href="#L-942"><span class="linenos">942</span></a><span class="s2">        import web_tools</span>
</span><span id="L-943"><a href="#L-943"><span class="linenos">943</span></a>
</span><span id="L-944"><a href="#L-944"><span class="linenos">944</span></a><span class="s2">        t1 = web_tools.Twitter_Session()</span>
</span><span id="L-945"><a href="#L-945"><span class="linenos">945</span></a><span class="s2">        t1.get_token_local(&#39;/home/docs/keys.json&#39;)</span>
</span><span id="L-946"><a href="#L-946"><span class="linenos">946</span></a>
</span><span id="L-947"><a href="#L-947"><span class="linenos">947</span></a><span class="s2">        df = t1.get_user_profile(&#39;elonmusk&#39;)</span>
</span><span id="L-948"><a href="#L-948"><span class="linenos">948</span></a><span class="s2">        df2 = t1.get_user_tweets(df[&#39;id&#39;][0])</span>
</span><span id="L-949"><a href="#L-949"><span class="linenos">949</span></a><span class="s2">        df3 = t1.get_user_following(df[&#39;id&#39;][0])</span>
</span><span id="L-950"><a href="#L-950"><span class="linenos">950</span></a>
</span><span id="L-951"><a href="#L-951"><span class="linenos">951</span></a><span class="s2">        t1.df_to_db(df[&#39;id&#39;][0], df, &#39;profile&#39;)</span>
</span><span id="L-952"><a href="#L-952"><span class="linenos">952</span></a><span class="s2">        t1.df_to_db(df[&#39;id&#39;][0], df2, &#39;tweets&#39;)</span>
</span><span id="L-953"><a href="#L-953"><span class="linenos">953</span></a><span class="s2">        t1.df_to_db(df[&#39;id&#39;][0], df3, &#39;following&#39;)</span>
</span><span id="L-954"><a href="#L-954"><span class="linenos">954</span></a>
</span><span id="L-955"><a href="#L-955"><span class="linenos">955</span></a><span class="s2">        df4 = t1.get_string_query(&#39;taiwan&#39;, pages=2)</span>
</span><span id="L-956"><a href="#L-956"><span class="linenos">956</span></a><span class="s2">        t1.df_to_db(</span>
</span><span id="L-957"><a href="#L-957"><span class="linenos">957</span></a><span class="s2">            id = t1.response.headers[&#39;x-transaction-id&#39;],</span>
</span><span id="L-958"><a href="#L-958"><span class="linenos">958</span></a><span class="s2">            data = df4,</span>
</span><span id="L-959"><a href="#L-959"><span class="linenos">959</span></a><span class="s2">            type = &#39;query&#39;,</span>
</span><span id="L-960"><a href="#L-960"><span class="linenos">960</span></a><span class="s2">            query_term = t1.query_log[len(t1.query_log)-1][&#39;parsed_query_term&#39;]</span>
</span><span id="L-961"><a href="#L-961"><span class="linenos">961</span></a><span class="s2">            )</span>
</span><span id="L-962"><a href="#L-962"><span class="linenos">962</span></a>
</span><span id="L-963"><a href="#L-963"><span class="linenos">963</span></a><span class="s2">        df4 = t1.get_string_query(&#39;musk&#39;, pages=2)</span>
</span><span id="L-964"><a href="#L-964"><span class="linenos">964</span></a><span class="s2">        t1.df_to_db(</span>
</span><span id="L-965"><a href="#L-965"><span class="linenos">965</span></a><span class="s2">            id = t1.response.headers[&#39;x-transaction-id&#39;],</span>
</span><span id="L-966"><a href="#L-966"><span class="linenos">966</span></a><span class="s2">            data = df4,</span>
</span><span id="L-967"><a href="#L-967"><span class="linenos">967</span></a><span class="s2">            type = &#39;query&#39;,</span>
</span><span id="L-968"><a href="#L-968"><span class="linenos">968</span></a><span class="s2">            query_term = t1.query_log[len(t1.query_log)-1][&#39;parsed_query_term&#39;]</span>
</span><span id="L-969"><a href="#L-969"><span class="linenos">969</span></a><span class="s2">            )</span>
</span><span id="L-970"><a href="#L-970"><span class="linenos">970</span></a>
</span><span id="L-971"><a href="#L-971"><span class="linenos">971</span></a><span class="s2">        df4 = t1.get_string_query(&#39;russia&#39;, pages=2)</span>
</span><span id="L-972"><a href="#L-972"><span class="linenos">972</span></a><span class="s2">        t1.df_to_db(</span>
</span><span id="L-973"><a href="#L-973"><span class="linenos">973</span></a><span class="s2">            id = t1.response.headers[&#39;x-transaction-id&#39;],</span>
</span><span id="L-974"><a href="#L-974"><span class="linenos">974</span></a><span class="s2">            data = df4,</span>
</span><span id="L-975"><a href="#L-975"><span class="linenos">975</span></a><span class="s2">            type = &#39;query&#39;,</span>
</span><span id="L-976"><a href="#L-976"><span class="linenos">976</span></a><span class="s2">            query_term = t1.query_log[len(t1.query_log)-1][&#39;parsed_query_term&#39;]</span>
</span><span id="L-977"><a href="#L-977"><span class="linenos">977</span></a><span class="s2">            )</span>
</span><span id="L-978"><a href="#L-978"><span class="linenos">978</span></a><span class="s2">    &quot;&quot;&quot;</span>
</span><span id="L-979"><a href="#L-979"><span class="linenos">979</span></a>    <span class="p">)</span>
</span></pre></div>


            </section>
                <section id="Twitter_Session">
                            <input id="Twitter_Session-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@dataclass</div>

    <span class="def">class</span>
    <span class="name">Twitter_Session</span>:

                <label class="view-source-button" for="Twitter_Session-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Twitter_Session"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Twitter_Session-23"><a href="#Twitter_Session-23"><span class="linenos"> 23</span></a><span class="nd">@dataclass</span>
</span><span id="Twitter_Session-24"><a href="#Twitter_Session-24"><span class="linenos"> 24</span></a><span class="k">class</span> <span class="nc">Twitter_Session</span><span class="p">:</span>
</span><span id="Twitter_Session-25"><a href="#Twitter_Session-25"><span class="linenos"> 25</span></a>
</span><span id="Twitter_Session-26"><a href="#Twitter_Session-26"><span class="linenos"> 26</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Twitter_Session-27"><a href="#Twitter_Session-27"><span class="linenos"> 27</span></a><span class="sd">    A Twitter session object.</span>
</span><span id="Twitter_Session-28"><a href="#Twitter_Session-28"><span class="linenos"> 28</span></a>
</span><span id="Twitter_Session-29"><a href="#Twitter_Session-29"><span class="linenos"> 29</span></a><span class="sd">    #### Parameters</span>
</span><span id="Twitter_Session-30"><a href="#Twitter_Session-30"><span class="linenos"> 30</span></a>
</span><span id="Twitter_Session-31"><a href="#Twitter_Session-31"><span class="linenos"> 31</span></a><span class="sd">        token : str - The bearer token for public metrics. Acquired via a Twitter developer account. Use the get_token_local() method to set.</span>
</span><span id="Twitter_Session-32"><a href="#Twitter_Session-32"><span class="linenos"> 32</span></a>
</span><span id="Twitter_Session-33"><a href="#Twitter_Session-33"><span class="linenos"> 33</span></a><span class="sd">    #### Attributes</span>
</span><span id="Twitter_Session-34"><a href="#Twitter_Session-34"><span class="linenos"> 34</span></a>
</span><span id="Twitter_Session-35"><a href="#Twitter_Session-35"><span class="linenos"> 35</span></a><span class="sd">        token : str - The bearer token for this instance.</span>
</span><span id="Twitter_Session-36"><a href="#Twitter_Session-36"><span class="linenos"> 36</span></a>
</span><span id="Twitter_Session-37"><a href="#Twitter_Session-37"><span class="linenos"> 37</span></a><span class="sd">        session : object - The requests.Session object for this instance.</span>
</span><span id="Twitter_Session-38"><a href="#Twitter_Session-38"><span class="linenos"> 38</span></a>
</span><span id="Twitter_Session-39"><a href="#Twitter_Session-39"><span class="linenos"> 39</span></a><span class="sd">        history : list - History of URL calls made by this instance.</span>
</span><span id="Twitter_Session-40"><a href="#Twitter_Session-40"><span class="linenos"> 40</span></a>
</span><span id="Twitter_Session-41"><a href="#Twitter_Session-41"><span class="linenos"> 41</span></a><span class="sd">        limit_log : dict - Metrics parsed from Twitter response headers. Used to set metrics trackers by the application.</span>
</span><span id="Twitter_Session-42"><a href="#Twitter_Session-42"><span class="linenos"> 42</span></a>
</span><span id="Twitter_Session-43"><a href="#Twitter_Session-43"><span class="linenos"> 43</span></a><span class="sd">        query_log : dict - Log of queries made. Primarily used to find session query terms.</span>
</span><span id="Twitter_Session-44"><a href="#Twitter_Session-44"><span class="linenos"> 44</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Twitter_Session-45"><a href="#Twitter_Session-45"><span class="linenos"> 45</span></a>
</span><span id="Twitter_Session-46"><a href="#Twitter_Session-46"><span class="linenos"> 46</span></a>    <span class="n">twitter_enrollment_period</span> <span class="o">=</span> <span class="s2">&quot;29 October&quot;</span>
</span><span id="Twitter_Session-47"><a href="#Twitter_Session-47"><span class="linenos"> 47</span></a>
</span><span id="Twitter_Session-48"><a href="#Twitter_Session-48"><span class="linenos"> 48</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Twitter_Session-49"><a href="#Twitter_Session-49"><span class="linenos"> 49</span></a>
</span><span id="Twitter_Session-50"><a href="#Twitter_Session-50"><span class="linenos"> 50</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Twitter_Session-51"><a href="#Twitter_Session-51"><span class="linenos"> 51</span></a><span class="sd">        Instantiate the session object. Requires no parameters.</span>
</span><span id="Twitter_Session-52"><a href="#Twitter_Session-52"><span class="linenos"> 52</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Twitter_Session-53"><a href="#Twitter_Session-53"><span class="linenos"> 53</span></a>
</span><span id="Twitter_Session-54"><a href="#Twitter_Session-54"><span class="linenos"> 54</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
</span><span id="Twitter_Session-55"><a href="#Twitter_Session-55"><span class="linenos"> 55</span></a>        <span class="sd">&quot;&quot;&quot;Creates a request.session object unique to the instance.&quot;&quot;&quot;</span>
</span><span id="Twitter_Session-56"><a href="#Twitter_Session-56"><span class="linenos"> 56</span></a>
</span><span id="Twitter_Session-57"><a href="#Twitter_Session-57"><span class="linenos"> 57</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">response</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="Twitter_Session-58"><a href="#Twitter_Session-58"><span class="linenos"> 58</span></a>        <span class="sd">&quot;&quot;&quot;The last requests.response object received.&quot;&quot;&quot;</span>
</span><span id="Twitter_Session-59"><a href="#Twitter_Session-59"><span class="linenos"> 59</span></a>
</span><span id="Twitter_Session-60"><a href="#Twitter_Session-60"><span class="linenos"> 60</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Twitter_Session-61"><a href="#Twitter_Session-61"><span class="linenos"> 61</span></a>        <span class="sd">&quot;&quot;&quot;The log of Twitter server rates and limits. Appended as the endpoint is accessed. Refer: https://developer.twitter.com/en/docs/twitter-api/rate-limits&quot;&quot;&quot;</span>
</span><span id="Twitter_Session-62"><a href="#Twitter_Session-62"><span class="linenos"> 62</span></a>
</span><span id="Twitter_Session-63"><a href="#Twitter_Session-63"><span class="linenos"> 63</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">query_log</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Twitter_Session-64"><a href="#Twitter_Session-64"><span class="linenos"> 64</span></a>        <span class="sd">&quot;&quot;&quot;The log of Twitter queries and responses. Use to reference the transaction id, search term, etc.&quot;&quot;&quot;</span>
</span><span id="Twitter_Session-65"><a href="#Twitter_Session-65"><span class="linenos"> 65</span></a>
</span><span id="Twitter_Session-66"><a href="#Twitter_Session-66"><span class="linenos"> 66</span></a>    <span class="k">def</span> <span class="nf">get_token_local</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Twitter_Session-67"><a href="#Twitter_Session-67"><span class="linenos"> 67</span></a>
</span><span id="Twitter_Session-68"><a href="#Twitter_Session-68"><span class="linenos"> 68</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Twitter_Session-69"><a href="#Twitter_Session-69"><span class="linenos"> 69</span></a><span class="sd">        Retreive a Twitter bearer token from a JSON with the following schema:</span>
</span><span id="Twitter_Session-70"><a href="#Twitter_Session-70"><span class="linenos"> 70</span></a>
</span><span id="Twitter_Session-71"><a href="#Twitter_Session-71"><span class="linenos"> 71</span></a><span class="sd">            {&#39;keys&#39;:</span>
</span><span id="Twitter_Session-72"><a href="#Twitter_Session-72"><span class="linenos"> 72</span></a>
</span><span id="Twitter_Session-73"><a href="#Twitter_Session-73"><span class="linenos"> 73</span></a><span class="sd">                &#39;Bearer Token&#39;: &#39;token&#39;</span>
</span><span id="Twitter_Session-74"><a href="#Twitter_Session-74"><span class="linenos"> 74</span></a>
</span><span id="Twitter_Session-75"><a href="#Twitter_Session-75"><span class="linenos"> 75</span></a><span class="sd">                }</span>
</span><span id="Twitter_Session-76"><a href="#Twitter_Session-76"><span class="linenos"> 76</span></a>
</span><span id="Twitter_Session-77"><a href="#Twitter_Session-77"><span class="linenos"> 77</span></a><span class="sd">        #### Parameters</span>
</span><span id="Twitter_Session-78"><a href="#Twitter_Session-78"><span class="linenos"> 78</span></a>
</span><span id="Twitter_Session-79"><a href="#Twitter_Session-79"><span class="linenos"> 79</span></a><span class="sd">            path : str - File path to the JSON. Must be accessible with open(), and readable by read().</span>
</span><span id="Twitter_Session-80"><a href="#Twitter_Session-80"><span class="linenos"> 80</span></a>
</span><span id="Twitter_Session-81"><a href="#Twitter_Session-81"><span class="linenos"> 81</span></a><span class="sd">        #### Attributes</span>
</span><span id="Twitter_Session-82"><a href="#Twitter_Session-82"><span class="linenos"> 82</span></a>
</span><span id="Twitter_Session-83"><a href="#Twitter_Session-83"><span class="linenos"> 83</span></a><span class="sd">            self.token : str - The bearer token string.</span>
</span><span id="Twitter_Session-84"><a href="#Twitter_Session-84"><span class="linenos"> 84</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Twitter_Session-85"><a href="#Twitter_Session-85"><span class="linenos"> 85</span></a>
</span><span id="Twitter_Session-86"><a href="#Twitter_Session-86"><span class="linenos"> 86</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="Twitter_Session-87"><a href="#Twitter_Session-87"><span class="linenos"> 87</span></a>
</span><span id="Twitter_Session-88"><a href="#Twitter_Session-88"><span class="linenos"> 88</span></a>            <span class="n">temp</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</span><span id="Twitter_Session-89"><a href="#Twitter_Session-89"><span class="linenos"> 89</span></a>
</span><span id="Twitter_Session-90"><a href="#Twitter_Session-90"><span class="linenos"> 90</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">token</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="s2">&quot;keys&quot;</span><span class="p">][</span><span class="s2">&quot;Bearer Token&quot;</span><span class="p">]</span>
</span><span id="Twitter_Session-91"><a href="#Twitter_Session-91"><span class="linenos"> 91</span></a>            <span class="sd">&quot;&quot;&quot;This session&#39;s bearer token. Acquired from a Twitter developer account. Refer: https://developer.twitter.com/en/docs/twitter-api/getting-started/getting-access-to-the-twitter-api&quot;&quot;&quot;</span>
</span><span id="Twitter_Session-92"><a href="#Twitter_Session-92"><span class="linenos"> 92</span></a>
</span><span id="Twitter_Session-93"><a href="#Twitter_Session-93"><span class="linenos"> 93</span></a>    <span class="k">def</span> <span class="nf">get_url</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Twitter_Session-94"><a href="#Twitter_Session-94"><span class="linenos"> 94</span></a>
</span><span id="Twitter_Session-95"><a href="#Twitter_Session-95"><span class="linenos"> 95</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Twitter_Session-96"><a href="#Twitter_Session-96"><span class="linenos"> 96</span></a><span class="sd">        Simple HTTP GET request.</span>
</span><span id="Twitter_Session-97"><a href="#Twitter_Session-97"><span class="linenos"> 97</span></a>
</span><span id="Twitter_Session-98"><a href="#Twitter_Session-98"><span class="linenos"> 98</span></a><span class="sd">        #### Parameters</span>
</span><span id="Twitter_Session-99"><a href="#Twitter_Session-99"><span class="linenos"> 99</span></a>
</span><span id="Twitter_Session-100"><a href="#Twitter_Session-100"><span class="linenos">100</span></a><span class="sd">            url : str - The complete URL, with or without a scheme. If no scheme is specified, defaults to &#39;https://&#39;.</span>
</span><span id="Twitter_Session-101"><a href="#Twitter_Session-101"><span class="linenos">101</span></a>
</span><span id="Twitter_Session-102"><a href="#Twitter_Session-102"><span class="linenos">102</span></a><span class="sd">        #### Attributes</span>
</span><span id="Twitter_Session-103"><a href="#Twitter_Session-103"><span class="linenos">103</span></a>
</span><span id="Twitter_Session-104"><a href="#Twitter_Session-104"><span class="linenos">104</span></a><span class="sd">            self.response : Response - The complete requests.response object, set to the class variable response.</span>
</span><span id="Twitter_Session-105"><a href="#Twitter_Session-105"><span class="linenos">105</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Twitter_Session-106"><a href="#Twitter_Session-106"><span class="linenos">106</span></a>
</span><span id="Twitter_Session-107"><a href="#Twitter_Session-107"><span class="linenos">107</span></a>        <span class="k">try</span><span class="p">:</span>  <span class="c1"># try the call</span>
</span><span id="Twitter_Session-108"><a href="#Twitter_Session-108"><span class="linenos">108</span></a>
</span><span id="Twitter_Session-109"><a href="#Twitter_Session-109"><span class="linenos">109</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="Twitter_Session-110"><a href="#Twitter_Session-110"><span class="linenos">110</span></a>                <span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Authorization&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Bearer </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">},</span> <span class="n">stream</span><span class="o">=</span><span class="kc">False</span>
</span><span id="Twitter_Session-111"><a href="#Twitter_Session-111"><span class="linenos">111</span></a>            <span class="p">)</span>
</span><span id="Twitter_Session-112"><a href="#Twitter_Session-112"><span class="linenos">112</span></a>
</span><span id="Twitter_Session-113"><a href="#Twitter_Session-113"><span class="linenos">113</span></a>        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">MissingSchema</span><span class="p">:</span>
</span><span id="Twitter_Session-114"><a href="#Twitter_Session-114"><span class="linenos">114</span></a>
</span><span id="Twitter_Session-115"><a href="#Twitter_Session-115"><span class="linenos">115</span></a>            <span class="c1"># print(sys.exc_info())</span>
</span><span id="Twitter_Session-116"><a href="#Twitter_Session-116"><span class="linenos">116</span></a>
</span><span id="Twitter_Session-117"><a href="#Twitter_Session-117"><span class="linenos">117</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="Twitter_Session-118"><a href="#Twitter_Session-118"><span class="linenos">118</span></a>                <span class="n">url</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;https://</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="Twitter_Session-119"><a href="#Twitter_Session-119"><span class="linenos">119</span></a>                <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Authorization&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Bearer </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">},</span>
</span><span id="Twitter_Session-120"><a href="#Twitter_Session-120"><span class="linenos">120</span></a>                <span class="n">stream</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Twitter_Session-121"><a href="#Twitter_Session-121"><span class="linenos">121</span></a>            <span class="p">)</span>
</span><span id="Twitter_Session-122"><a href="#Twitter_Session-122"><span class="linenos">122</span></a>
</span><span id="Twitter_Session-123"><a href="#Twitter_Session-123"><span class="linenos">123</span></a>    <span class="k">def</span> <span class="nf">get_user_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="Twitter_Session-124"><a href="#Twitter_Session-124"><span class="linenos">124</span></a>
</span><span id="Twitter_Session-125"><a href="#Twitter_Session-125"><span class="linenos">125</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Twitter_Session-126"><a href="#Twitter_Session-126"><span class="linenos">126</span></a><span class="sd">        Request Twitter&#39;s users by username endpoint. Resets index.</span>
</span><span id="Twitter_Session-127"><a href="#Twitter_Session-127"><span class="linenos">127</span></a>
</span><span id="Twitter_Session-128"><a href="#Twitter_Session-128"><span class="linenos">128</span></a><span class="sd">        #### Parameters</span>
</span><span id="Twitter_Session-129"><a href="#Twitter_Session-129"><span class="linenos">129</span></a>
</span><span id="Twitter_Session-130"><a href="#Twitter_Session-130"><span class="linenos">130</span></a><span class="sd">            username : str - The @username. Can be passed with or without &#39;@&#39;.</span>
</span><span id="Twitter_Session-131"><a href="#Twitter_Session-131"><span class="linenos">131</span></a>
</span><span id="Twitter_Session-132"><a href="#Twitter_Session-132"><span class="linenos">132</span></a><span class="sd">            timer : bool</span>
</span><span id="Twitter_Session-133"><a href="#Twitter_Session-133"><span class="linenos">133</span></a>
</span><span id="Twitter_Session-134"><a href="#Twitter_Session-134"><span class="linenos">134</span></a><span class="sd">        #### Returns</span>
</span><span id="Twitter_Session-135"><a href="#Twitter_Session-135"><span class="linenos">135</span></a>
</span><span id="Twitter_Session-136"><a href="#Twitter_Session-136"><span class="linenos">136</span></a><span class="sd">            pandas.DataFrame - A parsed DataFrame generated from the response JSON.</span>
</span><span id="Twitter_Session-137"><a href="#Twitter_Session-137"><span class="linenos">137</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Twitter_Session-138"><a href="#Twitter_Session-138"><span class="linenos">138</span></a>
</span><span id="Twitter_Session-139"><a href="#Twitter_Session-139"><span class="linenos">139</span></a>        <span class="k">if</span> <span class="s2">&quot;timer&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="Twitter_Session-140"><a href="#Twitter_Session-140"><span class="linenos">140</span></a>
</span><span id="Twitter_Session-141"><a href="#Twitter_Session-141"><span class="linenos">141</span></a>            <span class="n">timer</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;timer&quot;</span><span class="p">]</span>
</span><span id="Twitter_Session-142"><a href="#Twitter_Session-142"><span class="linenos">142</span></a>
</span><span id="Twitter_Session-143"><a href="#Twitter_Session-143"><span class="linenos">143</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Twitter_Session-144"><a href="#Twitter_Session-144"><span class="linenos">144</span></a>
</span><span id="Twitter_Session-145"><a href="#Twitter_Session-145"><span class="linenos">145</span></a>            <span class="n">timer</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Twitter_Session-146"><a href="#Twitter_Session-146"><span class="linenos">146</span></a>
</span><span id="Twitter_Session-147"><a href="#Twitter_Session-147"><span class="linenos">147</span></a>        <span class="k">if</span> <span class="n">timer</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Twitter_Session-148"><a href="#Twitter_Session-148"><span class="linenos">148</span></a>
</span><span id="Twitter_Session-149"><a href="#Twitter_Session-149"><span class="linenos">149</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sleeping...-_-...&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session-150"><a href="#Twitter_Session-150"><span class="linenos">150</span></a>
</span><span id="Twitter_Session-151"><a href="#Twitter_Session-151"><span class="linenos">151</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">59</span><span class="p">)</span>
</span><span id="Twitter_Session-152"><a href="#Twitter_Session-152"><span class="linenos">152</span></a>
</span><span id="Twitter_Session-153"><a href="#Twitter_Session-153"><span class="linenos">153</span></a>        <span class="k">if</span> <span class="n">username</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;@&quot;</span><span class="p">:</span>
</span><span id="Twitter_Session-154"><a href="#Twitter_Session-154"><span class="linenos">154</span></a>
</span><span id="Twitter_Session-155"><a href="#Twitter_Session-155"><span class="linenos">155</span></a>            <span class="n">username</span> <span class="o">=</span> <span class="n">username</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="Twitter_Session-156"><a href="#Twitter_Session-156"><span class="linenos">156</span></a>
</span><span id="Twitter_Session-157"><a href="#Twitter_Session-157"><span class="linenos">157</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">get_url</span><span class="p">(</span>
</span><span id="Twitter_Session-158"><a href="#Twitter_Session-158"><span class="linenos">158</span></a>            <span class="n">url</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;https://api.twitter.com/2/users/by/username/</span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2">?user.fields=description,public_metrics,profile_image_url&quot;</span>
</span><span id="Twitter_Session-159"><a href="#Twitter_Session-159"><span class="linenos">159</span></a>        <span class="p">)</span>
</span><span id="Twitter_Session-160"><a href="#Twitter_Session-160"><span class="linenos">160</span></a>
</span><span id="Twitter_Session-161"><a href="#Twitter_Session-161"><span class="linenos">161</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Twitter_Session-162"><a href="#Twitter_Session-162"><span class="linenos">162</span></a>
</span><span id="Twitter_Session-163"><a href="#Twitter_Session-163"><span class="linenos">163</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;user_profile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_server_limits</span><span class="p">()</span>
</span><span id="Twitter_Session-164"><a href="#Twitter_Session-164"><span class="linenos">164</span></a>
</span><span id="Twitter_Session-165"><a href="#Twitter_Session-165"><span class="linenos">165</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;user_profile&quot;</span><span class="p">][</span><span class="s2">&quot;checked_at&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</span><span id="Twitter_Session-166"><a href="#Twitter_Session-166"><span class="linenos">166</span></a>
</span><span id="Twitter_Session-167"><a href="#Twitter_Session-167"><span class="linenos">167</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>
</span><span id="Twitter_Session-168"><a href="#Twitter_Session-168"><span class="linenos">168</span></a>
</span><span id="Twitter_Session-169"><a href="#Twitter_Session-169"><span class="linenos">169</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span><span id="Twitter_Session-170"><a href="#Twitter_Session-170"><span class="linenos">170</span></a>
</span><span id="Twitter_Session-171"><a href="#Twitter_Session-171"><span class="linenos">171</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="s2">&quot;metric&quot;</span><span class="p">})</span>
</span><span id="Twitter_Session-172"><a href="#Twitter_Session-172"><span class="linenos">172</span></a>
</span><span id="Twitter_Session-173"><a href="#Twitter_Session-173"><span class="linenos">173</span></a>            <span class="k">return</span> <span class="n">df</span>
</span><span id="Twitter_Session-174"><a href="#Twitter_Session-174"><span class="linenos">174</span></a>
</span><span id="Twitter_Session-175"><a href="#Twitter_Session-175"><span class="linenos">175</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="Twitter_Session-176"><a href="#Twitter_Session-176"><span class="linenos">176</span></a>
</span><span id="Twitter_Session-177"><a href="#Twitter_Session-177"><span class="linenos">177</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;user_profile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_server_limits</span><span class="p">()</span>
</span><span id="Twitter_Session-178"><a href="#Twitter_Session-178"><span class="linenos">178</span></a>
</span><span id="Twitter_Session-179"><a href="#Twitter_Session-179"><span class="linenos">179</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;user_profile&quot;</span><span class="p">][</span><span class="s2">&quot;checked_at&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</span><span id="Twitter_Session-180"><a href="#Twitter_Session-180"><span class="linenos">180</span></a>
</span><span id="Twitter_Session-181"><a href="#Twitter_Session-181"><span class="linenos">181</span></a>            <span class="k">return</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;errors&quot;</span><span class="p">])</span>
</span><span id="Twitter_Session-182"><a href="#Twitter_Session-182"><span class="linenos">182</span></a>
</span><span id="Twitter_Session-183"><a href="#Twitter_Session-183"><span class="linenos">183</span></a>    <span class="k">def</span> <span class="nf">get_user_tweets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Twitter_Session-184"><a href="#Twitter_Session-184"><span class="linenos">184</span></a>
</span><span id="Twitter_Session-185"><a href="#Twitter_Session-185"><span class="linenos">185</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Twitter_Session-186"><a href="#Twitter_Session-186"><span class="linenos">186</span></a><span class="sd">        Get all a user&#39;s tweets. This is a costly operation in that Twitter paginates tweets</span>
</span><span id="Twitter_Session-187"><a href="#Twitter_Session-187"><span class="linenos">187</span></a>
</span><span id="Twitter_Session-188"><a href="#Twitter_Session-188"><span class="linenos">188</span></a><span class="sd">        100 at a time. Due to rate limits, and depending on how many tweets a user has, this</span>
</span><span id="Twitter_Session-189"><a href="#Twitter_Session-189"><span class="linenos">189</span></a>
</span><span id="Twitter_Session-190"><a href="#Twitter_Session-190"><span class="linenos">190</span></a><span class="sd">        may take a while. Twitter rate epochs reset 15 minutes after the first call has been</span>
</span><span id="Twitter_Session-191"><a href="#Twitter_Session-191"><span class="linenos">191</span></a>
</span><span id="Twitter_Session-192"><a href="#Twitter_Session-192"><span class="linenos">192</span></a><span class="sd">        made. The rate limits vary. Refer to the rate limits returned in the headers of this</span>
</span><span id="Twitter_Session-193"><a href="#Twitter_Session-193"><span class="linenos">193</span></a>
</span><span id="Twitter_Session-194"><a href="#Twitter_Session-194"><span class="linenos">194</span></a><span class="sd">        class.</span>
</span><span id="Twitter_Session-195"><a href="#Twitter_Session-195"><span class="linenos">195</span></a>
</span><span id="Twitter_Session-196"><a href="#Twitter_Session-196"><span class="linenos">196</span></a><span class="sd">        #### Parameters</span>
</span><span id="Twitter_Session-197"><a href="#Twitter_Session-197"><span class="linenos">197</span></a>
</span><span id="Twitter_Session-198"><a href="#Twitter_Session-198"><span class="linenos">198</span></a><span class="sd">            user_id : str - The Twitter user&#39;s id. This is typically a 64-bit unsigned integer. Passed back to the server as a string to avoid accuracy loss. Read more: https://developer.twitter.com/en/docs/twitter-ids</span>
</span><span id="Twitter_Session-199"><a href="#Twitter_Session-199"><span class="linenos">199</span></a>
</span><span id="Twitter_Session-200"><a href="#Twitter_Session-200"><span class="linenos">200</span></a><span class="sd">            pages : int - Number of pages to request. Pages are 100 tweets. To get a user&#39;s entire profile, check their tweet count, divide by 100, and round up. If pages is not specified, the function will run recursively until all available pages have been retrieved or the rate limit has been reached.</span>
</span><span id="Twitter_Session-201"><a href="#Twitter_Session-201"><span class="linenos">201</span></a>
</span><span id="Twitter_Session-202"><a href="#Twitter_Session-202"><span class="linenos">202</span></a><span class="sd">            timer : bool</span>
</span><span id="Twitter_Session-203"><a href="#Twitter_Session-203"><span class="linenos">203</span></a>
</span><span id="Twitter_Session-204"><a href="#Twitter_Session-204"><span class="linenos">204</span></a><span class="sd">        #### Returns</span>
</span><span id="Twitter_Session-205"><a href="#Twitter_Session-205"><span class="linenos">205</span></a>
</span><span id="Twitter_Session-206"><a href="#Twitter_Session-206"><span class="linenos">206</span></a><span class="sd">            pandas.DataFrame - The DataFrame with a user&#39;s tweets.</span>
</span><span id="Twitter_Session-207"><a href="#Twitter_Session-207"><span class="linenos">207</span></a>
</span><span id="Twitter_Session-208"><a href="#Twitter_Session-208"><span class="linenos">208</span></a><span class="sd">        #### Example</span>
</span><span id="Twitter_Session-209"><a href="#Twitter_Session-209"><span class="linenos">209</span></a>
</span><span id="Twitter_Session-210"><a href="#Twitter_Session-210"><span class="linenos">210</span></a><span class="sd">            Getting all available user tweets</span>
</span><span id="Twitter_Session-211"><a href="#Twitter_Session-211"><span class="linenos">211</span></a>
</span><span id="Twitter_Session-212"><a href="#Twitter_Session-212"><span class="linenos">212</span></a><span class="sd">            `df = t1.get_user_profile(&#39;elonmusk&#39;)`</span>
</span><span id="Twitter_Session-213"><a href="#Twitter_Session-213"><span class="linenos">213</span></a><span class="sd">            `df = t1.get_user_tweets(df[&#39;id&#39;][0], round(df[&#39;tweet_count&#39;][0] / 100))`</span>
</span><span id="Twitter_Session-214"><a href="#Twitter_Session-214"><span class="linenos">214</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Twitter_Session-215"><a href="#Twitter_Session-215"><span class="linenos">215</span></a>
</span><span id="Twitter_Session-216"><a href="#Twitter_Session-216"><span class="linenos">216</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="Twitter_Session-217"><a href="#Twitter_Session-217"><span class="linenos">217</span></a>
</span><span id="Twitter_Session-218"><a href="#Twitter_Session-218"><span class="linenos">218</span></a>        <span class="k">if</span> <span class="s2">&quot;pages&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="Twitter_Session-219"><a href="#Twitter_Session-219"><span class="linenos">219</span></a>
</span><span id="Twitter_Session-220"><a href="#Twitter_Session-220"><span class="linenos">220</span></a>            <span class="n">pages</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;pages&quot;</span><span class="p">]</span>
</span><span id="Twitter_Session-221"><a href="#Twitter_Session-221"><span class="linenos">221</span></a>
</span><span id="Twitter_Session-222"><a href="#Twitter_Session-222"><span class="linenos">222</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Twitter_Session-223"><a href="#Twitter_Session-223"><span class="linenos">223</span></a>
</span><span id="Twitter_Session-224"><a href="#Twitter_Session-224"><span class="linenos">224</span></a>            <span class="n">pages</span> <span class="o">=</span> <span class="mi">1500</span>
</span><span id="Twitter_Session-225"><a href="#Twitter_Session-225"><span class="linenos">225</span></a>
</span><span id="Twitter_Session-226"><a href="#Twitter_Session-226"><span class="linenos">226</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pages</span><span class="p">):</span>
</span><span id="Twitter_Session-227"><a href="#Twitter_Session-227"><span class="linenos">227</span></a>
</span><span id="Twitter_Session-228"><a href="#Twitter_Session-228"><span class="linenos">228</span></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Twitter_Session-229"><a href="#Twitter_Session-229"><span class="linenos">229</span></a>
</span><span id="Twitter_Session-230"><a href="#Twitter_Session-230"><span class="linenos">230</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">get_url</span><span class="p">(</span>
</span><span id="Twitter_Session-231"><a href="#Twitter_Session-231"><span class="linenos">231</span></a>                    <span class="sa">f</span><span class="s2">&quot;https://api.twitter.com/2/users/</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">/tweets?tweet.fields=created_at,text,public_metrics&amp;max_results=100&quot;</span>
</span><span id="Twitter_Session-232"><a href="#Twitter_Session-232"><span class="linenos">232</span></a>                <span class="p">)</span>
</span><span id="Twitter_Session-233"><a href="#Twitter_Session-233"><span class="linenos">233</span></a>
</span><span id="Twitter_Session-234"><a href="#Twitter_Session-234"><span class="linenos">234</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">):</span>
</span><span id="Twitter_Session-235"><a href="#Twitter_Session-235"><span class="linenos">235</span></a>
</span><span id="Twitter_Session-236"><a href="#Twitter_Session-236"><span class="linenos">236</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;UsageCapExceeded&quot;</span><span class="p">:</span>
</span><span id="Twitter_Session-237"><a href="#Twitter_Session-237"><span class="linenos">237</span></a>
</span><span id="Twitter_Session-238"><a href="#Twitter_Session-238"><span class="linenos">238</span></a>                        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Usage cap exceeded for Tweets.&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session-239"><a href="#Twitter_Session-239"><span class="linenos">239</span></a>
</span><span id="Twitter_Session-240"><a href="#Twitter_Session-240"><span class="linenos">240</span></a>                        <span class="k">break</span>
</span><span id="Twitter_Session-241"><a href="#Twitter_Session-241"><span class="linenos">241</span></a>
</span><span id="Twitter_Session-242"><a href="#Twitter_Session-242"><span class="linenos">242</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">):</span>
</span><span id="Twitter_Session-243"><a href="#Twitter_Session-243"><span class="linenos">243</span></a>
</span><span id="Twitter_Session-244"><a href="#Twitter_Session-244"><span class="linenos">244</span></a>                    <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>
</span><span id="Twitter_Session-245"><a href="#Twitter_Session-245"><span class="linenos">245</span></a>
</span><span id="Twitter_Session-246"><a href="#Twitter_Session-246"><span class="linenos">246</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Twitter_Session-247"><a href="#Twitter_Session-247"><span class="linenos">247</span></a>
</span><span id="Twitter_Session-248"><a href="#Twitter_Session-248"><span class="linenos">248</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="Twitter_Session-249"><a href="#Twitter_Session-249"><span class="linenos">249</span></a>
</span><span id="Twitter_Session-250"><a href="#Twitter_Session-250"><span class="linenos">250</span></a>                    <span class="n">next_token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;meta&quot;</span><span class="p">][</span><span class="s2">&quot;next_token&quot;</span><span class="p">]</span>
</span><span id="Twitter_Session-251"><a href="#Twitter_Session-251"><span class="linenos">251</span></a>
</span><span id="Twitter_Session-252"><a href="#Twitter_Session-252"><span class="linenos">252</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">get_url</span><span class="p">(</span>
</span><span id="Twitter_Session-253"><a href="#Twitter_Session-253"><span class="linenos">253</span></a>                        <span class="sa">f</span><span class="s2">&quot;https://api.twitter.com/2/users/</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">/tweets?tweet.fields=created_at,text,public_metrics&amp;max_results=100&amp;pagination_token=</span><span class="si">{</span><span class="n">next_token</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="Twitter_Session-254"><a href="#Twitter_Session-254"><span class="linenos">254</span></a>                    <span class="p">)</span>
</span><span id="Twitter_Session-255"><a href="#Twitter_Session-255"><span class="linenos">255</span></a>
</span><span id="Twitter_Session-256"><a href="#Twitter_Session-256"><span class="linenos">256</span></a>                    <span class="n">df2</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>
</span><span id="Twitter_Session-257"><a href="#Twitter_Session-257"><span class="linenos">257</span></a>
</span><span id="Twitter_Session-258"><a href="#Twitter_Session-258"><span class="linenos">258</span></a>                    <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Twitter_Session-259"><a href="#Twitter_Session-259"><span class="linenos">259</span></a>
</span><span id="Twitter_Session-260"><a href="#Twitter_Session-260"><span class="linenos">260</span></a>                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="Twitter_Session-261"><a href="#Twitter_Session-261"><span class="linenos">261</span></a>
</span><span id="Twitter_Session-262"><a href="#Twitter_Session-262"><span class="linenos">262</span></a>                    <span class="k">break</span>
</span><span id="Twitter_Session-263"><a href="#Twitter_Session-263"><span class="linenos">263</span></a>
</span><span id="Twitter_Session-264"><a href="#Twitter_Session-264"><span class="linenos">264</span></a>            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;timer&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="Twitter_Session-265"><a href="#Twitter_Session-265"><span class="linenos">265</span></a>
</span><span id="Twitter_Session-266"><a href="#Twitter_Session-266"><span class="linenos">266</span></a>                <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;timer&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Twitter_Session-267"><a href="#Twitter_Session-267"><span class="linenos">267</span></a>
</span><span id="Twitter_Session-268"><a href="#Twitter_Session-268"><span class="linenos">268</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sleeping...-_-...&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session-269"><a href="#Twitter_Session-269"><span class="linenos">269</span></a>
</span><span id="Twitter_Session-270"><a href="#Twitter_Session-270"><span class="linenos">270</span></a>                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">59</span><span class="p">)</span>
</span><span id="Twitter_Session-271"><a href="#Twitter_Session-271"><span class="linenos">271</span></a>
</span><span id="Twitter_Session-272"><a href="#Twitter_Session-272"><span class="linenos">272</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Twitter_Session-273"><a href="#Twitter_Session-273"><span class="linenos">273</span></a>
</span><span id="Twitter_Session-274"><a href="#Twitter_Session-274"><span class="linenos">274</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span><span id="Twitter_Session-275"><a href="#Twitter_Session-275"><span class="linenos">275</span></a>
</span><span id="Twitter_Session-276"><a href="#Twitter_Session-276"><span class="linenos">276</span></a>            <span class="n">df2</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;public_metrics&quot;</span><span class="p">])</span>
</span><span id="Twitter_Session-277"><a href="#Twitter_Session-277"><span class="linenos">277</span></a>
</span><span id="Twitter_Session-278"><a href="#Twitter_Session-278"><span class="linenos">278</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;user_tweets&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_server_limits</span><span class="p">()</span>
</span><span id="Twitter_Session-279"><a href="#Twitter_Session-279"><span class="linenos">279</span></a>
</span><span id="Twitter_Session-280"><a href="#Twitter_Session-280"><span class="linenos">280</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;user_tweets&quot;</span><span class="p">][</span><span class="s2">&quot;checked_at&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</span><span id="Twitter_Session-281"><a href="#Twitter_Session-281"><span class="linenos">281</span></a>
</span><span id="Twitter_Session-282"><a href="#Twitter_Session-282"><span class="linenos">282</span></a>            <span class="k">return</span> <span class="n">pandas</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span>
</span><span id="Twitter_Session-283"><a href="#Twitter_Session-283"><span class="linenos">283</span></a>                <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;public_metrics&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
</span><span id="Twitter_Session-284"><a href="#Twitter_Session-284"><span class="linenos">284</span></a>            <span class="p">)</span>
</span><span id="Twitter_Session-285"><a href="#Twitter_Session-285"><span class="linenos">285</span></a>
</span><span id="Twitter_Session-286"><a href="#Twitter_Session-286"><span class="linenos">286</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="Twitter_Session-287"><a href="#Twitter_Session-287"><span class="linenos">287</span></a>
</span><span id="Twitter_Session-288"><a href="#Twitter_Session-288"><span class="linenos">288</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;user_tweets&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_server_limits</span><span class="p">()</span>
</span><span id="Twitter_Session-289"><a href="#Twitter_Session-289"><span class="linenos">289</span></a>
</span><span id="Twitter_Session-290"><a href="#Twitter_Session-290"><span class="linenos">290</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;user_tweets&quot;</span><span class="p">][</span><span class="s2">&quot;checked_at&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</span><span id="Twitter_Session-291"><a href="#Twitter_Session-291"><span class="linenos">291</span></a>
</span><span id="Twitter_Session-292"><a href="#Twitter_Session-292"><span class="linenos">292</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;errors&quot;</span><span class="p">):</span>
</span><span id="Twitter_Session-293"><a href="#Twitter_Session-293"><span class="linenos">293</span></a>
</span><span id="Twitter_Session-294"><a href="#Twitter_Session-294"><span class="linenos">294</span></a>                <span class="k">return</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;errors&quot;</span><span class="p">])</span>
</span><span id="Twitter_Session-295"><a href="#Twitter_Session-295"><span class="linenos">295</span></a>
</span><span id="Twitter_Session-296"><a href="#Twitter_Session-296"><span class="linenos">296</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Twitter_Session-297"><a href="#Twitter_Session-297"><span class="linenos">297</span></a>
</span><span id="Twitter_Session-298"><a href="#Twitter_Session-298"><span class="linenos">298</span></a>                <span class="k">return</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()])</span>
</span><span id="Twitter_Session-299"><a href="#Twitter_Session-299"><span class="linenos">299</span></a>
</span><span id="Twitter_Session-300"><a href="#Twitter_Session-300"><span class="linenos">300</span></a>    <span class="k">def</span> <span class="nf">get_user_following</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Twitter_Session-301"><a href="#Twitter_Session-301"><span class="linenos">301</span></a>
</span><span id="Twitter_Session-302"><a href="#Twitter_Session-302"><span class="linenos">302</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Twitter_Session-303"><a href="#Twitter_Session-303"><span class="linenos">303</span></a><span class="sd">        Get all the users the requested account follows. If `pages` is not specified the function will run recursively.</span>
</span><span id="Twitter_Session-304"><a href="#Twitter_Session-304"><span class="linenos">304</span></a>
</span><span id="Twitter_Session-305"><a href="#Twitter_Session-305"><span class="linenos">305</span></a><span class="sd">        Endpoint: Users &gt; Follows lookup &gt; Limit: 15</span>
</span><span id="Twitter_Session-306"><a href="#Twitter_Session-306"><span class="linenos">306</span></a>
</span><span id="Twitter_Session-307"><a href="#Twitter_Session-307"><span class="linenos">307</span></a><span class="sd">        #### Parameters</span>
</span><span id="Twitter_Session-308"><a href="#Twitter_Session-308"><span class="linenos">308</span></a>
</span><span id="Twitter_Session-309"><a href="#Twitter_Session-309"><span class="linenos">309</span></a><span class="sd">            user_id : str - The Twitter user&#39;s id. This is typically a 64-bit unsigned integer. Passed back to the server as a string to avoid accuracy loss. Read more: https://developer.twitter.com/en/docs/twitter-ids</span>
</span><span id="Twitter_Session-310"><a href="#Twitter_Session-310"><span class="linenos">310</span></a>
</span><span id="Twitter_Session-311"><a href="#Twitter_Session-311"><span class="linenos">311</span></a><span class="sd">            pages : int - Number of pages to request. Pages are 100 tweets. To get a user&#39;s entire profile, check their tweet count, divide by 100, and round up. If pages is not specified, the function will run recursively until all available pages have been retrieved or the rate limit has been reached.</span>
</span><span id="Twitter_Session-312"><a href="#Twitter_Session-312"><span class="linenos">312</span></a>
</span><span id="Twitter_Session-313"><a href="#Twitter_Session-313"><span class="linenos">313</span></a><span class="sd">            timer : bool - Default `False`. If `True`, the script will use a sleep timer to prevent running over the rate limit. This means one page is collected per minute, until the end of pagination.</span>
</span><span id="Twitter_Session-314"><a href="#Twitter_Session-314"><span class="linenos">314</span></a>
</span><span id="Twitter_Session-315"><a href="#Twitter_Session-315"><span class="linenos">315</span></a><span class="sd">        #### Returns</span>
</span><span id="Twitter_Session-316"><a href="#Twitter_Session-316"><span class="linenos">316</span></a>
</span><span id="Twitter_Session-317"><a href="#Twitter_Session-317"><span class="linenos">317</span></a><span class="sd">            pandas.DataFrame - The DataFrame with a user&#39;s tweets.</span>
</span><span id="Twitter_Session-318"><a href="#Twitter_Session-318"><span class="linenos">318</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Twitter_Session-319"><a href="#Twitter_Session-319"><span class="linenos">319</span></a>
</span><span id="Twitter_Session-320"><a href="#Twitter_Session-320"><span class="linenos">320</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="Twitter_Session-321"><a href="#Twitter_Session-321"><span class="linenos">321</span></a>
</span><span id="Twitter_Session-322"><a href="#Twitter_Session-322"><span class="linenos">322</span></a>        <span class="k">if</span> <span class="s2">&quot;pages&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="Twitter_Session-323"><a href="#Twitter_Session-323"><span class="linenos">323</span></a>
</span><span id="Twitter_Session-324"><a href="#Twitter_Session-324"><span class="linenos">324</span></a>            <span class="n">pages</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;pages&quot;</span><span class="p">]</span>
</span><span id="Twitter_Session-325"><a href="#Twitter_Session-325"><span class="linenos">325</span></a>
</span><span id="Twitter_Session-326"><a href="#Twitter_Session-326"><span class="linenos">326</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Twitter_Session-327"><a href="#Twitter_Session-327"><span class="linenos">327</span></a>
</span><span id="Twitter_Session-328"><a href="#Twitter_Session-328"><span class="linenos">328</span></a>            <span class="n">pages</span> <span class="o">=</span> <span class="mi">15</span>
</span><span id="Twitter_Session-329"><a href="#Twitter_Session-329"><span class="linenos">329</span></a>
</span><span id="Twitter_Session-330"><a href="#Twitter_Session-330"><span class="linenos">330</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pages</span><span class="p">):</span>
</span><span id="Twitter_Session-331"><a href="#Twitter_Session-331"><span class="linenos">331</span></a>
</span><span id="Twitter_Session-332"><a href="#Twitter_Session-332"><span class="linenos">332</span></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Twitter_Session-333"><a href="#Twitter_Session-333"><span class="linenos">333</span></a>
</span><span id="Twitter_Session-334"><a href="#Twitter_Session-334"><span class="linenos">334</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">get_url</span><span class="p">(</span>
</span><span id="Twitter_Session-335"><a href="#Twitter_Session-335"><span class="linenos">335</span></a>                    <span class="sa">f</span><span class="s2">&quot;https://api.twitter.com/2/users/</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">/following?user.fields=id,name,username,public_metrics&amp;max_results=1000&quot;</span>
</span><span id="Twitter_Session-336"><a href="#Twitter_Session-336"><span class="linenos">336</span></a>                <span class="p">)</span>
</span><span id="Twitter_Session-337"><a href="#Twitter_Session-337"><span class="linenos">337</span></a>
</span><span id="Twitter_Session-338"><a href="#Twitter_Session-338"><span class="linenos">338</span></a>                <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>
</span><span id="Twitter_Session-339"><a href="#Twitter_Session-339"><span class="linenos">339</span></a>
</span><span id="Twitter_Session-340"><a href="#Twitter_Session-340"><span class="linenos">340</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Twitter_Session-341"><a href="#Twitter_Session-341"><span class="linenos">341</span></a>
</span><span id="Twitter_Session-342"><a href="#Twitter_Session-342"><span class="linenos">342</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="Twitter_Session-343"><a href="#Twitter_Session-343"><span class="linenos">343</span></a>
</span><span id="Twitter_Session-344"><a href="#Twitter_Session-344"><span class="linenos">344</span></a>                    <span class="n">next_token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;meta&quot;</span><span class="p">][</span><span class="s2">&quot;next_token&quot;</span><span class="p">]</span>
</span><span id="Twitter_Session-345"><a href="#Twitter_Session-345"><span class="linenos">345</span></a>
</span><span id="Twitter_Session-346"><a href="#Twitter_Session-346"><span class="linenos">346</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">get_url</span><span class="p">(</span>
</span><span id="Twitter_Session-347"><a href="#Twitter_Session-347"><span class="linenos">347</span></a>                        <span class="sa">f</span><span class="s2">&quot;https://api.twitter.com/2/users/</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">/following?user.fields=id,name,username,public_metrics&amp;max_results=1000&amp;pagination_token=</span><span class="si">{</span><span class="n">next_token</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="Twitter_Session-348"><a href="#Twitter_Session-348"><span class="linenos">348</span></a>                    <span class="p">)</span>
</span><span id="Twitter_Session-349"><a href="#Twitter_Session-349"><span class="linenos">349</span></a>
</span><span id="Twitter_Session-350"><a href="#Twitter_Session-350"><span class="linenos">350</span></a>                    <span class="n">df2</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>
</span><span id="Twitter_Session-351"><a href="#Twitter_Session-351"><span class="linenos">351</span></a>
</span><span id="Twitter_Session-352"><a href="#Twitter_Session-352"><span class="linenos">352</span></a>                    <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Twitter_Session-353"><a href="#Twitter_Session-353"><span class="linenos">353</span></a>
</span><span id="Twitter_Session-354"><a href="#Twitter_Session-354"><span class="linenos">354</span></a>                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="Twitter_Session-355"><a href="#Twitter_Session-355"><span class="linenos">355</span></a>
</span><span id="Twitter_Session-356"><a href="#Twitter_Session-356"><span class="linenos">356</span></a>                    <span class="k">break</span>
</span><span id="Twitter_Session-357"><a href="#Twitter_Session-357"><span class="linenos">357</span></a>
</span><span id="Twitter_Session-358"><a href="#Twitter_Session-358"><span class="linenos">358</span></a>            <span class="k">if</span> <span class="s2">&quot;timer&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="Twitter_Session-359"><a href="#Twitter_Session-359"><span class="linenos">359</span></a>
</span><span id="Twitter_Session-360"><a href="#Twitter_Session-360"><span class="linenos">360</span></a>                <span class="n">timer</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;timer&quot;</span><span class="p">]</span>
</span><span id="Twitter_Session-361"><a href="#Twitter_Session-361"><span class="linenos">361</span></a>
</span><span id="Twitter_Session-362"><a href="#Twitter_Session-362"><span class="linenos">362</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Twitter_Session-363"><a href="#Twitter_Session-363"><span class="linenos">363</span></a>
</span><span id="Twitter_Session-364"><a href="#Twitter_Session-364"><span class="linenos">364</span></a>                <span class="n">timer</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Twitter_Session-365"><a href="#Twitter_Session-365"><span class="linenos">365</span></a>
</span><span id="Twitter_Session-366"><a href="#Twitter_Session-366"><span class="linenos">366</span></a>            <span class="k">if</span> <span class="n">timer</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Twitter_Session-367"><a href="#Twitter_Session-367"><span class="linenos">367</span></a>
</span><span id="Twitter_Session-368"><a href="#Twitter_Session-368"><span class="linenos">368</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sleeping...-_-...&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session-369"><a href="#Twitter_Session-369"><span class="linenos">369</span></a>
</span><span id="Twitter_Session-370"><a href="#Twitter_Session-370"><span class="linenos">370</span></a>                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">59</span><span class="p">)</span>
</span><span id="Twitter_Session-371"><a href="#Twitter_Session-371"><span class="linenos">371</span></a>
</span><span id="Twitter_Session-372"><a href="#Twitter_Session-372"><span class="linenos">372</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;user_following&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_server_limits</span><span class="p">()</span>
</span><span id="Twitter_Session-373"><a href="#Twitter_Session-373"><span class="linenos">373</span></a>
</span><span id="Twitter_Session-374"><a href="#Twitter_Session-374"><span class="linenos">374</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;user_following&quot;</span><span class="p">][</span><span class="s2">&quot;checked_at&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</span><span id="Twitter_Session-375"><a href="#Twitter_Session-375"><span class="linenos">375</span></a>
</span><span id="Twitter_Session-376"><a href="#Twitter_Session-376"><span class="linenos">376</span></a>        <span class="k">return</span> <span class="n">df</span>
</span><span id="Twitter_Session-377"><a href="#Twitter_Session-377"><span class="linenos">377</span></a>
</span><span id="Twitter_Session-378"><a href="#Twitter_Session-378"><span class="linenos">378</span></a>    <span class="k">def</span> <span class="nf">get_user_followers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Twitter_Session-379"><a href="#Twitter_Session-379"><span class="linenos">379</span></a>
</span><span id="Twitter_Session-380"><a href="#Twitter_Session-380"><span class="linenos">380</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Twitter_Session-381"><a href="#Twitter_Session-381"><span class="linenos">381</span></a><span class="sd">        Get a user&#39;s followers.</span>
</span><span id="Twitter_Session-382"><a href="#Twitter_Session-382"><span class="linenos">382</span></a>
</span><span id="Twitter_Session-383"><a href="#Twitter_Session-383"><span class="linenos">383</span></a><span class="sd">        Attributes</span>
</span><span id="Twitter_Session-384"><a href="#Twitter_Session-384"><span class="linenos">384</span></a>
</span><span id="Twitter_Session-385"><a href="#Twitter_Session-385"><span class="linenos">385</span></a><span class="sd">            pages : int</span>
</span><span id="Twitter_Session-386"><a href="#Twitter_Session-386"><span class="linenos">386</span></a>
</span><span id="Twitter_Session-387"><a href="#Twitter_Session-387"><span class="linenos">387</span></a><span class="sd">            timer : bool</span>
</span><span id="Twitter_Session-388"><a href="#Twitter_Session-388"><span class="linenos">388</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Twitter_Session-389"><a href="#Twitter_Session-389"><span class="linenos">389</span></a>
</span><span id="Twitter_Session-390"><a href="#Twitter_Session-390"><span class="linenos">390</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="Twitter_Session-391"><a href="#Twitter_Session-391"><span class="linenos">391</span></a>
</span><span id="Twitter_Session-392"><a href="#Twitter_Session-392"><span class="linenos">392</span></a>        <span class="k">if</span> <span class="s2">&quot;pages&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="Twitter_Session-393"><a href="#Twitter_Session-393"><span class="linenos">393</span></a>
</span><span id="Twitter_Session-394"><a href="#Twitter_Session-394"><span class="linenos">394</span></a>            <span class="n">pages</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;pages&quot;</span><span class="p">]</span>
</span><span id="Twitter_Session-395"><a href="#Twitter_Session-395"><span class="linenos">395</span></a>
</span><span id="Twitter_Session-396"><a href="#Twitter_Session-396"><span class="linenos">396</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Twitter_Session-397"><a href="#Twitter_Session-397"><span class="linenos">397</span></a>
</span><span id="Twitter_Session-398"><a href="#Twitter_Session-398"><span class="linenos">398</span></a>            <span class="n">pages</span> <span class="o">=</span> <span class="mi">15</span>
</span><span id="Twitter_Session-399"><a href="#Twitter_Session-399"><span class="linenos">399</span></a>
</span><span id="Twitter_Session-400"><a href="#Twitter_Session-400"><span class="linenos">400</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pages</span><span class="p">):</span>
</span><span id="Twitter_Session-401"><a href="#Twitter_Session-401"><span class="linenos">401</span></a>
</span><span id="Twitter_Session-402"><a href="#Twitter_Session-402"><span class="linenos">402</span></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Twitter_Session-403"><a href="#Twitter_Session-403"><span class="linenos">403</span></a>
</span><span id="Twitter_Session-404"><a href="#Twitter_Session-404"><span class="linenos">404</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">get_url</span><span class="p">(</span>
</span><span id="Twitter_Session-405"><a href="#Twitter_Session-405"><span class="linenos">405</span></a>                    <span class="sa">f</span><span class="s2">&quot;https://api.twitter.com/2/users/</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">/followers?user.fields=id,name,username,public_metrics&amp;max_results=1000&quot;</span>
</span><span id="Twitter_Session-406"><a href="#Twitter_Session-406"><span class="linenos">406</span></a>                <span class="p">)</span>
</span><span id="Twitter_Session-407"><a href="#Twitter_Session-407"><span class="linenos">407</span></a>
</span><span id="Twitter_Session-408"><a href="#Twitter_Session-408"><span class="linenos">408</span></a>                <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>
</span><span id="Twitter_Session-409"><a href="#Twitter_Session-409"><span class="linenos">409</span></a>
</span><span id="Twitter_Session-410"><a href="#Twitter_Session-410"><span class="linenos">410</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Twitter_Session-411"><a href="#Twitter_Session-411"><span class="linenos">411</span></a>
</span><span id="Twitter_Session-412"><a href="#Twitter_Session-412"><span class="linenos">412</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="Twitter_Session-413"><a href="#Twitter_Session-413"><span class="linenos">413</span></a>
</span><span id="Twitter_Session-414"><a href="#Twitter_Session-414"><span class="linenos">414</span></a>                    <span class="n">next_token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;meta&quot;</span><span class="p">][</span><span class="s2">&quot;next_token&quot;</span><span class="p">]</span>
</span><span id="Twitter_Session-415"><a href="#Twitter_Session-415"><span class="linenos">415</span></a>
</span><span id="Twitter_Session-416"><a href="#Twitter_Session-416"><span class="linenos">416</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">get_url</span><span class="p">(</span>
</span><span id="Twitter_Session-417"><a href="#Twitter_Session-417"><span class="linenos">417</span></a>                        <span class="sa">f</span><span class="s2">&quot;https://api.twitter.com/2/users/</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">/followers?user.fields=id,name,username,public_metrics&amp;max_results=1000&amp;pagination_token=</span><span class="si">{</span><span class="n">next_token</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="Twitter_Session-418"><a href="#Twitter_Session-418"><span class="linenos">418</span></a>                    <span class="p">)</span>
</span><span id="Twitter_Session-419"><a href="#Twitter_Session-419"><span class="linenos">419</span></a>
</span><span id="Twitter_Session-420"><a href="#Twitter_Session-420"><span class="linenos">420</span></a>                    <span class="n">df2</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>
</span><span id="Twitter_Session-421"><a href="#Twitter_Session-421"><span class="linenos">421</span></a>
</span><span id="Twitter_Session-422"><a href="#Twitter_Session-422"><span class="linenos">422</span></a>                    <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Twitter_Session-423"><a href="#Twitter_Session-423"><span class="linenos">423</span></a>
</span><span id="Twitter_Session-424"><a href="#Twitter_Session-424"><span class="linenos">424</span></a>                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="Twitter_Session-425"><a href="#Twitter_Session-425"><span class="linenos">425</span></a>
</span><span id="Twitter_Session-426"><a href="#Twitter_Session-426"><span class="linenos">426</span></a>                    <span class="k">break</span>
</span><span id="Twitter_Session-427"><a href="#Twitter_Session-427"><span class="linenos">427</span></a>
</span><span id="Twitter_Session-428"><a href="#Twitter_Session-428"><span class="linenos">428</span></a>            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;timer&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="Twitter_Session-429"><a href="#Twitter_Session-429"><span class="linenos">429</span></a>
</span><span id="Twitter_Session-430"><a href="#Twitter_Session-430"><span class="linenos">430</span></a>                <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;timer&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Twitter_Session-431"><a href="#Twitter_Session-431"><span class="linenos">431</span></a>
</span><span id="Twitter_Session-432"><a href="#Twitter_Session-432"><span class="linenos">432</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sleeping...-_-...&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session-433"><a href="#Twitter_Session-433"><span class="linenos">433</span></a>
</span><span id="Twitter_Session-434"><a href="#Twitter_Session-434"><span class="linenos">434</span></a>                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">59</span><span class="p">)</span>
</span><span id="Twitter_Session-435"><a href="#Twitter_Session-435"><span class="linenos">435</span></a>
</span><span id="Twitter_Session-436"><a href="#Twitter_Session-436"><span class="linenos">436</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;user_followers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_server_limits</span><span class="p">()</span>
</span><span id="Twitter_Session-437"><a href="#Twitter_Session-437"><span class="linenos">437</span></a>
</span><span id="Twitter_Session-438"><a href="#Twitter_Session-438"><span class="linenos">438</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;user_followers&quot;</span><span class="p">][</span><span class="s2">&quot;checked_at&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</span><span id="Twitter_Session-439"><a href="#Twitter_Session-439"><span class="linenos">439</span></a>
</span><span id="Twitter_Session-440"><a href="#Twitter_Session-440"><span class="linenos">440</span></a>        <span class="k">return</span> <span class="n">df</span>
</span><span id="Twitter_Session-441"><a href="#Twitter_Session-441"><span class="linenos">441</span></a>
</span><span id="Twitter_Session-442"><a href="#Twitter_Session-442"><span class="linenos">442</span></a>    <span class="k">def</span> <span class="nf">get_user_snapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Twitter_Session-443"><a href="#Twitter_Session-443"><span class="linenos">443</span></a>
</span><span id="Twitter_Session-444"><a href="#Twitter_Session-444"><span class="linenos">444</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Twitter_Session-445"><a href="#Twitter_Session-445"><span class="linenos">445</span></a><span class="sd">        Get profile, tweets, following, and followers of user</span>
</span><span id="Twitter_Session-446"><a href="#Twitter_Session-446"><span class="linenos">446</span></a><span class="sd">        with no page limits, and write to db.</span>
</span><span id="Twitter_Session-447"><a href="#Twitter_Session-447"><span class="linenos">447</span></a>
</span><span id="Twitter_Session-448"><a href="#Twitter_Session-448"><span class="linenos">448</span></a><span class="sd">        Must already have instantiated a Twitter_Session class</span>
</span><span id="Twitter_Session-449"><a href="#Twitter_Session-449"><span class="linenos">449</span></a><span class="sd">        object, and passed it a bearer token using get_token_local().</span>
</span><span id="Twitter_Session-450"><a href="#Twitter_Session-450"><span class="linenos">450</span></a>
</span><span id="Twitter_Session-451"><a href="#Twitter_Session-451"><span class="linenos">451</span></a><span class="sd">        Parameters</span>
</span><span id="Twitter_Session-452"><a href="#Twitter_Session-452"><span class="linenos">452</span></a>
</span><span id="Twitter_Session-453"><a href="#Twitter_Session-453"><span class="linenos">453</span></a><span class="sd">            username : str - The @username. Can be passed with or without &#39;@&#39;.</span>
</span><span id="Twitter_Session-454"><a href="#Twitter_Session-454"><span class="linenos">454</span></a>
</span><span id="Twitter_Session-455"><a href="#Twitter_Session-455"><span class="linenos">455</span></a><span class="sd">            followers : bool - Gather followers. Default == `False`.</span>
</span><span id="Twitter_Session-456"><a href="#Twitter_Session-456"><span class="linenos">456</span></a>
</span><span id="Twitter_Session-457"><a href="#Twitter_Session-457"><span class="linenos">457</span></a><span class="sd">            following : bool - Gather following. Default == `False`.</span>
</span><span id="Twitter_Session-458"><a href="#Twitter_Session-458"><span class="linenos">458</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Twitter_Session-459"><a href="#Twitter_Session-459"><span class="linenos">459</span></a>
</span><span id="Twitter_Session-460"><a href="#Twitter_Session-460"><span class="linenos">460</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_user_profile</span><span class="p">(</span><span class="n">username</span><span class="p">)</span>
</span><span id="Twitter_Session-461"><a href="#Twitter_Session-461"><span class="linenos">461</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">df_to_db</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">df</span><span class="p">,</span> <span class="s2">&quot;profile&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session-462"><a href="#Twitter_Session-462"><span class="linenos">462</span></a>
</span><span id="Twitter_Session-463"><a href="#Twitter_Session-463"><span class="linenos">463</span></a>        <span class="n">df2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_user_tweets</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Twitter_Session-464"><a href="#Twitter_Session-464"><span class="linenos">464</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">df_to_db</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">df2</span><span class="p">,</span> <span class="s2">&quot;tweets&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session-465"><a href="#Twitter_Session-465"><span class="linenos">465</span></a>
</span><span id="Twitter_Session-466"><a href="#Twitter_Session-466"><span class="linenos">466</span></a>        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;followers&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="Twitter_Session-467"><a href="#Twitter_Session-467"><span class="linenos">467</span></a>
</span><span id="Twitter_Session-468"><a href="#Twitter_Session-468"><span class="linenos">468</span></a>            <span class="n">df3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_user_following</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Twitter_Session-469"><a href="#Twitter_Session-469"><span class="linenos">469</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">df_to_db</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">df3</span><span class="p">,</span> <span class="s2">&quot;following&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session-470"><a href="#Twitter_Session-470"><span class="linenos">470</span></a>
</span><span id="Twitter_Session-471"><a href="#Twitter_Session-471"><span class="linenos">471</span></a>        <span class="k">elif</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;following&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="Twitter_Session-472"><a href="#Twitter_Session-472"><span class="linenos">472</span></a>
</span><span id="Twitter_Session-473"><a href="#Twitter_Session-473"><span class="linenos">473</span></a>            <span class="n">df4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_user_followers</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Twitter_Session-474"><a href="#Twitter_Session-474"><span class="linenos">474</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">df_to_db</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">df4</span><span class="p">,</span> <span class="s2">&quot;followers&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session-475"><a href="#Twitter_Session-475"><span class="linenos">475</span></a>
</span><span id="Twitter_Session-476"><a href="#Twitter_Session-476"><span class="linenos">476</span></a>    <span class="k">def</span> <span class="nf">get_string_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Twitter_Session-477"><a href="#Twitter_Session-477"><span class="linenos">477</span></a>
</span><span id="Twitter_Session-478"><a href="#Twitter_Session-478"><span class="linenos">478</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Twitter_Session-479"><a href="#Twitter_Session-479"><span class="linenos">479</span></a><span class="sd">        Query Twitter. Returns the last n pages of tweets containing the query string.</span>
</span><span id="Twitter_Session-480"><a href="#Twitter_Session-480"><span class="linenos">480</span></a>
</span><span id="Twitter_Session-481"><a href="#Twitter_Session-481"><span class="linenos">481</span></a><span class="sd">        #### Parameters</span>
</span><span id="Twitter_Session-482"><a href="#Twitter_Session-482"><span class="linenos">482</span></a>
</span><span id="Twitter_Session-483"><a href="#Twitter_Session-483"><span class="linenos">483</span></a><span class="sd">            query : str - The string to be searched for. Can include hashtags.</span>
</span><span id="Twitter_Session-484"><a href="#Twitter_Session-484"><span class="linenos">484</span></a>
</span><span id="Twitter_Session-485"><a href="#Twitter_Session-485"><span class="linenos">485</span></a><span class="sd">            pages : int - The number of pages to return. A page is 100 tweets. Default = 0.</span>
</span><span id="Twitter_Session-486"><a href="#Twitter_Session-486"><span class="linenos">486</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Twitter_Session-487"><a href="#Twitter_Session-487"><span class="linenos">487</span></a>
</span><span id="Twitter_Session-488"><a href="#Twitter_Session-488"><span class="linenos">488</span></a>        <span class="k">if</span> <span class="s2">&quot;pages&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="Twitter_Session-489"><a href="#Twitter_Session-489"><span class="linenos">489</span></a>
</span><span id="Twitter_Session-490"><a href="#Twitter_Session-490"><span class="linenos">490</span></a>            <span class="n">pages</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;pages&quot;</span><span class="p">]</span>
</span><span id="Twitter_Session-491"><a href="#Twitter_Session-491"><span class="linenos">491</span></a>
</span><span id="Twitter_Session-492"><a href="#Twitter_Session-492"><span class="linenos">492</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Twitter_Session-493"><a href="#Twitter_Session-493"><span class="linenos">493</span></a>
</span><span id="Twitter_Session-494"><a href="#Twitter_Session-494"><span class="linenos">494</span></a>            <span class="n">pages</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Twitter_Session-495"><a href="#Twitter_Session-495"><span class="linenos">495</span></a>
</span><span id="Twitter_Session-496"><a href="#Twitter_Session-496"><span class="linenos">496</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="Twitter_Session-497"><a href="#Twitter_Session-497"><span class="linenos">497</span></a>
</span><span id="Twitter_Session-498"><a href="#Twitter_Session-498"><span class="linenos">498</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pages</span><span class="p">):</span>
</span><span id="Twitter_Session-499"><a href="#Twitter_Session-499"><span class="linenos">499</span></a>
</span><span id="Twitter_Session-500"><a href="#Twitter_Session-500"><span class="linenos">500</span></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Twitter_Session-501"><a href="#Twitter_Session-501"><span class="linenos">501</span></a>
</span><span id="Twitter_Session-502"><a href="#Twitter_Session-502"><span class="linenos">502</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">get_url</span><span class="p">(</span>
</span><span id="Twitter_Session-503"><a href="#Twitter_Session-503"><span class="linenos">503</span></a>                    <span class="sa">f</span><span class="s2">&quot;https://api.twitter.com/2/tweets/search/recent?query=</span><span class="si">{</span><span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">query</span><span class="p">)</span><span class="si">}</span><span class="s2">&amp;max_results=100&quot;</span>
</span><span id="Twitter_Session-504"><a href="#Twitter_Session-504"><span class="linenos">504</span></a>                <span class="p">)</span>
</span><span id="Twitter_Session-505"><a href="#Twitter_Session-505"><span class="linenos">505</span></a>
</span><span id="Twitter_Session-506"><a href="#Twitter_Session-506"><span class="linenos">506</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;query&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_server_limits</span><span class="p">()</span>
</span><span id="Twitter_Session-507"><a href="#Twitter_Session-507"><span class="linenos">507</span></a>
</span><span id="Twitter_Session-508"><a href="#Twitter_Session-508"><span class="linenos">508</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;query&quot;</span><span class="p">][</span><span class="s2">&quot;checked_at&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</span><span id="Twitter_Session-509"><a href="#Twitter_Session-509"><span class="linenos">509</span></a>
</span><span id="Twitter_Session-510"><a href="#Twitter_Session-510"><span class="linenos">510</span></a>                <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>
</span><span id="Twitter_Session-511"><a href="#Twitter_Session-511"><span class="linenos">511</span></a>
</span><span id="Twitter_Session-512"><a href="#Twitter_Session-512"><span class="linenos">512</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Twitter_Session-513"><a href="#Twitter_Session-513"><span class="linenos">513</span></a>
</span><span id="Twitter_Session-514"><a href="#Twitter_Session-514"><span class="linenos">514</span></a>                <span class="n">next_token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;meta&quot;</span><span class="p">][</span><span class="s2">&quot;next_token&quot;</span><span class="p">]</span>
</span><span id="Twitter_Session-515"><a href="#Twitter_Session-515"><span class="linenos">515</span></a>
</span><span id="Twitter_Session-516"><a href="#Twitter_Session-516"><span class="linenos">516</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">get_url</span><span class="p">(</span>
</span><span id="Twitter_Session-517"><a href="#Twitter_Session-517"><span class="linenos">517</span></a>                    <span class="sa">f</span><span class="s2">&quot;https://api.twitter.com/2/tweets/search/recent?query=</span><span class="si">{</span><span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">query</span><span class="p">)</span><span class="si">}</span><span class="s2">&amp;max_results=100&amp;pagination_token=</span><span class="si">{</span><span class="n">next_token</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="Twitter_Session-518"><a href="#Twitter_Session-518"><span class="linenos">518</span></a>                <span class="p">)</span>
</span><span id="Twitter_Session-519"><a href="#Twitter_Session-519"><span class="linenos">519</span></a>
</span><span id="Twitter_Session-520"><a href="#Twitter_Session-520"><span class="linenos">520</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;query&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_server_limits</span><span class="p">()</span>
</span><span id="Twitter_Session-521"><a href="#Twitter_Session-521"><span class="linenos">521</span></a>
</span><span id="Twitter_Session-522"><a href="#Twitter_Session-522"><span class="linenos">522</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;query&quot;</span><span class="p">][</span><span class="s2">&quot;checked_at&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</span><span id="Twitter_Session-523"><a href="#Twitter_Session-523"><span class="linenos">523</span></a>
</span><span id="Twitter_Session-524"><a href="#Twitter_Session-524"><span class="linenos">524</span></a>                <span class="n">df2</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>
</span><span id="Twitter_Session-525"><a href="#Twitter_Session-525"><span class="linenos">525</span></a>
</span><span id="Twitter_Session-526"><a href="#Twitter_Session-526"><span class="linenos">526</span></a>                <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Twitter_Session-527"><a href="#Twitter_Session-527"><span class="linenos">527</span></a>
</span><span id="Twitter_Session-528"><a href="#Twitter_Session-528"><span class="linenos">528</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">query_log</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">query_log</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="Twitter_Session-529"><a href="#Twitter_Session-529"><span class="linenos">529</span></a>            <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span>
</span><span id="Twitter_Session-530"><a href="#Twitter_Session-530"><span class="linenos">530</span></a>            <span class="s2">&quot;x-transaction-id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;x-transaction-id&quot;</span><span class="p">],</span>
</span><span id="Twitter_Session-531"><a href="#Twitter_Session-531"><span class="linenos">531</span></a>            <span class="s2">&quot;query_term&quot;</span><span class="p">:</span> <span class="n">query</span><span class="p">,</span>
</span><span id="Twitter_Session-532"><a href="#Twitter_Session-532"><span class="linenos">532</span></a>            <span class="s2">&quot;parsed_query_term&quot;</span><span class="p">:</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">query</span><span class="p">),</span>
</span><span id="Twitter_Session-533"><a href="#Twitter_Session-533"><span class="linenos">533</span></a>        <span class="p">}</span>
</span><span id="Twitter_Session-534"><a href="#Twitter_Session-534"><span class="linenos">534</span></a>
</span><span id="Twitter_Session-535"><a href="#Twitter_Session-535"><span class="linenos">535</span></a>        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span><span id="Twitter_Session-536"><a href="#Twitter_Session-536"><span class="linenos">536</span></a>
</span><span id="Twitter_Session-537"><a href="#Twitter_Session-537"><span class="linenos">537</span></a>    <span class="k">def</span> <span class="nf">return_server_limits</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="Twitter_Session-538"><a href="#Twitter_Session-538"><span class="linenos">538</span></a>
</span><span id="Twitter_Session-539"><a href="#Twitter_Session-539"><span class="linenos">539</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Twitter_Session-540"><a href="#Twitter_Session-540"><span class="linenos">540</span></a><span class="sd">        Return Twitter server rate limits and timers from the response in memory. Used to update the limit log internally.</span>
</span><span id="Twitter_Session-541"><a href="#Twitter_Session-541"><span class="linenos">541</span></a>
</span><span id="Twitter_Session-542"><a href="#Twitter_Session-542"><span class="linenos">542</span></a><span class="sd">        #### Returns</span>
</span><span id="Twitter_Session-543"><a href="#Twitter_Session-543"><span class="linenos">543</span></a>
</span><span id="Twitter_Session-544"><a href="#Twitter_Session-544"><span class="linenos">544</span></a><span class="sd">            A dictionary with the following schema:</span>
</span><span id="Twitter_Session-545"><a href="#Twitter_Session-545"><span class="linenos">545</span></a>
</span><span id="Twitter_Session-546"><a href="#Twitter_Session-546"><span class="linenos">546</span></a><span class="sd">                {</span>
</span><span id="Twitter_Session-547"><a href="#Twitter_Session-547"><span class="linenos">547</span></a><span class="sd">                    &#39;remaining&#39;: float,</span>
</span><span id="Twitter_Session-548"><a href="#Twitter_Session-548"><span class="linenos">548</span></a><span class="sd">                    &#39;limit&#39;: float,</span>
</span><span id="Twitter_Session-549"><a href="#Twitter_Session-549"><span class="linenos">549</span></a><span class="sd">                    &#39;limit_reset&#39;: str,</span>
</span><span id="Twitter_Session-550"><a href="#Twitter_Session-550"><span class="linenos">550</span></a><span class="sd">                    &#39;percent_remaining&#39;: int,</span>
</span><span id="Twitter_Session-551"><a href="#Twitter_Session-551"><span class="linenos">551</span></a><span class="sd">                    &#39;limit_delta&#39;: str</span>
</span><span id="Twitter_Session-552"><a href="#Twitter_Session-552"><span class="linenos">552</span></a><span class="sd">                    }</span>
</span><span id="Twitter_Session-553"><a href="#Twitter_Session-553"><span class="linenos">553</span></a>
</span><span id="Twitter_Session-554"><a href="#Twitter_Session-554"><span class="linenos">554</span></a><span class="sd">            ##### Attributes</span>
</span><span id="Twitter_Session-555"><a href="#Twitter_Session-555"><span class="linenos">555</span></a>
</span><span id="Twitter_Session-556"><a href="#Twitter_Session-556"><span class="linenos">556</span></a><span class="sd">                remaining : float - Transmission-rate limit remaining in epoch for this endpoint.</span>
</span><span id="Twitter_Session-557"><a href="#Twitter_Session-557"><span class="linenos">557</span></a>
</span><span id="Twitter_Session-558"><a href="#Twitter_Session-558"><span class="linenos">558</span></a><span class="sd">                limit : float - Total call limit for the endpoint, per epoch.</span>
</span><span id="Twitter_Session-559"><a href="#Twitter_Session-559"><span class="linenos">559</span></a>
</span><span id="Twitter_Session-560"><a href="#Twitter_Session-560"><span class="linenos">560</span></a><span class="sd">                limit_reset : str - The time when the limit epoch resets. Converted from unix time stamp to a string with `%H:%M:%S` format.</span>
</span><span id="Twitter_Session-561"><a href="#Twitter_Session-561"><span class="linenos">561</span></a>
</span><span id="Twitter_Session-562"><a href="#Twitter_Session-562"><span class="linenos">562</span></a><span class="sd">                percent_remaining : int - Percentage remaining in the call limit, for this epoch.</span>
</span><span id="Twitter_Session-563"><a href="#Twitter_Session-563"><span class="linenos">563</span></a>
</span><span id="Twitter_Session-564"><a href="#Twitter_Session-564"><span class="linenos">564</span></a><span class="sd">                limit_delta : str - Difference between when the limit resets and now, in `%H:%M:%S` format.</span>
</span><span id="Twitter_Session-565"><a href="#Twitter_Session-565"><span class="linenos">565</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Twitter_Session-566"><a href="#Twitter_Session-566"><span class="linenos">566</span></a>
</span><span id="Twitter_Session-567"><a href="#Twitter_Session-567"><span class="linenos">567</span></a>        <span class="n">return_headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">headers</span>
</span><span id="Twitter_Session-568"><a href="#Twitter_Session-568"><span class="linenos">568</span></a>
</span><span id="Twitter_Session-569"><a href="#Twitter_Session-569"><span class="linenos">569</span></a>        <span class="n">remaining</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">return_headers</span><span class="p">[</span><span class="s2">&quot;x-rate-limit-remaining&quot;</span><span class="p">])</span>
</span><span id="Twitter_Session-570"><a href="#Twitter_Session-570"><span class="linenos">570</span></a>
</span><span id="Twitter_Session-571"><a href="#Twitter_Session-571"><span class="linenos">571</span></a>        <span class="n">limit</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">return_headers</span><span class="p">[</span><span class="s2">&quot;x-rate-limit-limit&quot;</span><span class="p">])</span>
</span><span id="Twitter_Session-572"><a href="#Twitter_Session-572"><span class="linenos">572</span></a>
</span><span id="Twitter_Session-573"><a href="#Twitter_Session-573"><span class="linenos">573</span></a>        <span class="n">percent_remaining</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">remaining</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">limit</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
</span><span id="Twitter_Session-574"><a href="#Twitter_Session-574"><span class="linenos">574</span></a>
</span><span id="Twitter_Session-575"><a href="#Twitter_Session-575"><span class="linenos">575</span></a>        <span class="c1"># TODO rename this variable</span>
</span><span id="Twitter_Session-576"><a href="#Twitter_Session-576"><span class="linenos">576</span></a>        <span class="c1"># NOTE this is used as the delta in a streamlit.metric object</span>
</span><span id="Twitter_Session-577"><a href="#Twitter_Session-577"><span class="linenos">577</span></a>        <span class="n">remaining_math</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span> <span class="o">-</span> <span class="n">percent_remaining</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="Twitter_Session-578"><a href="#Twitter_Session-578"><span class="linenos">578</span></a>
</span><span id="Twitter_Session-579"><a href="#Twitter_Session-579"><span class="linenos">579</span></a>        <span class="c1"># TODO there has to be a better way than the following:</span>
</span><span id="Twitter_Session-580"><a href="#Twitter_Session-580"><span class="linenos">580</span></a>        <span class="n">limit_reset</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span>
</span><span id="Twitter_Session-581"><a href="#Twitter_Session-581"><span class="linenos">581</span></a>            <span class="s2">&quot;%H:%M:%S&quot;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">localtime</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">return_headers</span><span class="p">[</span><span class="s2">&quot;x-rate-limit-reset&quot;</span><span class="p">]))</span>
</span><span id="Twitter_Session-582"><a href="#Twitter_Session-582"><span class="linenos">582</span></a>        <span class="p">)</span>
</span><span id="Twitter_Session-583"><a href="#Twitter_Session-583"><span class="linenos">583</span></a>
</span><span id="Twitter_Session-584"><a href="#Twitter_Session-584"><span class="linenos">584</span></a>        <span class="n">limit_reset</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">limit_reset</span><span class="p">,</span> <span class="s2">&quot;%H:%M:%S&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session-585"><a href="#Twitter_Session-585"><span class="linenos">585</span></a>
</span><span id="Twitter_Session-586"><a href="#Twitter_Session-586"><span class="linenos">586</span></a>        <span class="n">limit_reset</span> <span class="o">=</span> <span class="n">limit_reset</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="Twitter_Session-587"><a href="#Twitter_Session-587"><span class="linenos">587</span></a>
</span><span id="Twitter_Session-588"><a href="#Twitter_Session-588"><span class="linenos">588</span></a>        <span class="n">time_now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</span><span id="Twitter_Session-589"><a href="#Twitter_Session-589"><span class="linenos">589</span></a>
</span><span id="Twitter_Session-590"><a href="#Twitter_Session-590"><span class="linenos">590</span></a>        <span class="n">time_now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span>
</span><span id="Twitter_Session-591"><a href="#Twitter_Session-591"><span class="linenos">591</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">time_now</span><span class="o">.</span><span class="n">hour</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">time_now</span><span class="o">.</span><span class="n">minute</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">time_now</span><span class="o">.</span><span class="n">second</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;%H:%M:%S&quot;</span>
</span><span id="Twitter_Session-592"><a href="#Twitter_Session-592"><span class="linenos">592</span></a>        <span class="p">)</span>
</span><span id="Twitter_Session-593"><a href="#Twitter_Session-593"><span class="linenos">593</span></a>
</span><span id="Twitter_Session-594"><a href="#Twitter_Session-594"><span class="linenos">594</span></a>        <span class="n">time_now</span> <span class="o">=</span> <span class="n">time_now</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="Twitter_Session-595"><a href="#Twitter_Session-595"><span class="linenos">595</span></a>
</span><span id="Twitter_Session-596"><a href="#Twitter_Session-596"><span class="linenos">596</span></a>        <span class="n">limit_reset</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">(),</span> <span class="n">limit_reset</span><span class="p">)</span>
</span><span id="Twitter_Session-597"><a href="#Twitter_Session-597"><span class="linenos">597</span></a>
</span><span id="Twitter_Session-598"><a href="#Twitter_Session-598"><span class="linenos">598</span></a>        <span class="n">time_now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">(),</span> <span class="n">time_now</span><span class="p">)</span>
</span><span id="Twitter_Session-599"><a href="#Twitter_Session-599"><span class="linenos">599</span></a>
</span><span id="Twitter_Session-600"><a href="#Twitter_Session-600"><span class="linenos">600</span></a>        <span class="n">limit_delta</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">limit_reset</span> <span class="o">-</span> <span class="n">time_now</span><span class="p">)</span>
</span><span id="Twitter_Session-601"><a href="#Twitter_Session-601"><span class="linenos">601</span></a>
</span><span id="Twitter_Session-602"><a href="#Twitter_Session-602"><span class="linenos">602</span></a>        <span class="n">limit_reset</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">limit_reset</span><span class="p">,</span> <span class="s2">&quot;%H:%M:%S&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session-603"><a href="#Twitter_Session-603"><span class="linenos">603</span></a>
</span><span id="Twitter_Session-604"><a href="#Twitter_Session-604"><span class="linenos">604</span></a>        <span class="nb">dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="Twitter_Session-605"><a href="#Twitter_Session-605"><span class="linenos">605</span></a>            <span class="s2">&quot;remaining&quot;</span><span class="p">:</span> <span class="n">remaining</span><span class="p">,</span>
</span><span id="Twitter_Session-606"><a href="#Twitter_Session-606"><span class="linenos">606</span></a>            <span class="s2">&quot;limit&quot;</span><span class="p">:</span> <span class="n">limit</span><span class="p">,</span>
</span><span id="Twitter_Session-607"><a href="#Twitter_Session-607"><span class="linenos">607</span></a>            <span class="s2">&quot;limit_reset&quot;</span><span class="p">:</span> <span class="n">limit_reset</span><span class="p">,</span>
</span><span id="Twitter_Session-608"><a href="#Twitter_Session-608"><span class="linenos">608</span></a>            <span class="s2">&quot;percent_remaining&quot;</span><span class="p">:</span> <span class="n">percent_remaining</span><span class="p">,</span>
</span><span id="Twitter_Session-609"><a href="#Twitter_Session-609"><span class="linenos">609</span></a>            <span class="s2">&quot;limit_delta&quot;</span><span class="p">:</span> <span class="n">limit_delta</span><span class="p">,</span>
</span><span id="Twitter_Session-610"><a href="#Twitter_Session-610"><span class="linenos">610</span></a>        <span class="p">}</span>
</span><span id="Twitter_Session-611"><a href="#Twitter_Session-611"><span class="linenos">611</span></a>
</span><span id="Twitter_Session-612"><a href="#Twitter_Session-612"><span class="linenos">612</span></a>        <span class="k">return</span> <span class="nb">dict</span>
</span><span id="Twitter_Session-613"><a href="#Twitter_Session-613"><span class="linenos">613</span></a>
</span><span id="Twitter_Session-614"><a href="#Twitter_Session-614"><span class="linenos">614</span></a>    <span class="k">def</span> <span class="nf">df_to_db</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Twitter_Session-615"><a href="#Twitter_Session-615"><span class="linenos">615</span></a>
</span><span id="Twitter_Session-616"><a href="#Twitter_Session-616"><span class="linenos">616</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Twitter_Session-617"><a href="#Twitter_Session-617"><span class="linenos">617</span></a><span class="sd">        Write user&#39;s twitter data to a SQLite3 database using an SQLAlchemy engine.</span>
</span><span id="Twitter_Session-618"><a href="#Twitter_Session-618"><span class="linenos">618</span></a>
</span><span id="Twitter_Session-619"><a href="#Twitter_Session-619"><span class="linenos">619</span></a><span class="sd">        #### Parameters</span>
</span><span id="Twitter_Session-620"><a href="#Twitter_Session-620"><span class="linenos">620</span></a>
</span><span id="Twitter_Session-621"><a href="#Twitter_Session-621"><span class="linenos">621</span></a><span class="sd">            data : pandas.DataFrame - The DataFrame with user profile data, as formatted by get_user_profile().</span>
</span><span id="Twitter_Session-622"><a href="#Twitter_Session-622"><span class="linenos">622</span></a>
</span><span id="Twitter_Session-623"><a href="#Twitter_Session-623"><span class="linenos">623</span></a><span class="sd">            type : str - profile, tweets, following, query</span>
</span><span id="Twitter_Session-624"><a href="#Twitter_Session-624"><span class="linenos">624</span></a>
</span><span id="Twitter_Session-625"><a href="#Twitter_Session-625"><span class="linenos">625</span></a><span class="sd">            query_term : str - The term used in a get_string_query().</span>
</span><span id="Twitter_Session-626"><a href="#Twitter_Session-626"><span class="linenos">626</span></a>
</span><span id="Twitter_Session-627"><a href="#Twitter_Session-627"><span class="linenos">627</span></a><span class="sd">        #### Attributes</span>
</span><span id="Twitter_Session-628"><a href="#Twitter_Session-628"><span class="linenos">628</span></a>
</span><span id="Twitter_Session-629"><a href="#Twitter_Session-629"><span class="linenos">629</span></a><span class="sd">            id : str - The table id to be stored under. If type is profile, tweets, or following the id will be the user id of the profile. If a query, use &#39;x-transaction-id&#39; from the query response header.</span>
</span><span id="Twitter_Session-630"><a href="#Twitter_Session-630"><span class="linenos">630</span></a>
</span><span id="Twitter_Session-631"><a href="#Twitter_Session-631"><span class="linenos">631</span></a><span class="sd">        #### Example</span>
</span><span id="Twitter_Session-632"><a href="#Twitter_Session-632"><span class="linenos">632</span></a>
</span><span id="Twitter_Session-633"><a href="#Twitter_Session-633"><span class="linenos">633</span></a><span class="sd">            `t1 = Twitter_Session()`</span>
</span><span id="Twitter_Session-634"><a href="#Twitter_Session-634"><span class="linenos">634</span></a><span class="sd">            `t1.get_token_local(&#39;/home/user/keys.json&#39;)`</span>
</span><span id="Twitter_Session-635"><a href="#Twitter_Session-635"><span class="linenos">635</span></a><span class="sd">            `df = t1.get_user_profile(&#39;elonmusk&#39;)`</span>
</span><span id="Twitter_Session-636"><a href="#Twitter_Session-636"><span class="linenos">636</span></a><span class="sd">            `t1.df_to_db(user_id = df[&#39;id&#39;][0], data = df, type=&#39;profile&#39;)`</span>
</span><span id="Twitter_Session-637"><a href="#Twitter_Session-637"><span class="linenos">637</span></a><span class="sd">            `df2 = t1.get_user_tweets(user_id = df[&#39;id&#39;][0])`</span>
</span><span id="Twitter_Session-638"><a href="#Twitter_Session-638"><span class="linenos">638</span></a><span class="sd">            `t1.df_to_db(user_id = df[&#39;id&#39;][0], data = df2, type=&#39;tweets&#39;)`</span>
</span><span id="Twitter_Session-639"><a href="#Twitter_Session-639"><span class="linenos">639</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Twitter_Session-640"><a href="#Twitter_Session-640"><span class="linenos">640</span></a>
</span><span id="Twitter_Session-641"><a href="#Twitter_Session-641"><span class="linenos">641</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Twitter_Session-642"><a href="#Twitter_Session-642"><span class="linenos">642</span></a>
</span><span id="Twitter_Session-643"><a href="#Twitter_Session-643"><span class="linenos">643</span></a>            <span class="n">query_term</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;query_term&quot;</span><span class="p">]</span>
</span><span id="Twitter_Session-644"><a href="#Twitter_Session-644"><span class="linenos">644</span></a>
</span><span id="Twitter_Session-645"><a href="#Twitter_Session-645"><span class="linenos">645</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="Twitter_Session-646"><a href="#Twitter_Session-646"><span class="linenos">646</span></a>
</span><span id="Twitter_Session-647"><a href="#Twitter_Session-647"><span class="linenos">647</span></a>            <span class="n">query_term</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="Twitter_Session-648"><a href="#Twitter_Session-648"><span class="linenos">648</span></a>
</span><span id="Twitter_Session-649"><a href="#Twitter_Session-649"><span class="linenos">649</span></a>        <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;profile&quot;</span><span class="p">:</span>
</span><span id="Twitter_Session-650"><a href="#Twitter_Session-650"><span class="linenos">650</span></a>
</span><span id="Twitter_Session-651"><a href="#Twitter_Session-651"><span class="linenos">651</span></a>            <span class="n">engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sqlite:///data/</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">.db&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session-652"><a href="#Twitter_Session-652"><span class="linenos">652</span></a>
</span><span id="Twitter_Session-653"><a href="#Twitter_Session-653"><span class="linenos">653</span></a>            <span class="n">table_name</span> <span class="o">=</span> <span class="s2">&quot;profile&quot;</span>
</span><span id="Twitter_Session-654"><a href="#Twitter_Session-654"><span class="linenos">654</span></a>
</span><span id="Twitter_Session-655"><a href="#Twitter_Session-655"><span class="linenos">655</span></a>        <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;tweets&quot;</span><span class="p">:</span>
</span><span id="Twitter_Session-656"><a href="#Twitter_Session-656"><span class="linenos">656</span></a>
</span><span id="Twitter_Session-657"><a href="#Twitter_Session-657"><span class="linenos">657</span></a>            <span class="n">engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sqlite:///data/</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">.db&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session-658"><a href="#Twitter_Session-658"><span class="linenos">658</span></a>
</span><span id="Twitter_Session-659"><a href="#Twitter_Session-659"><span class="linenos">659</span></a>            <span class="n">table_name</span> <span class="o">=</span> <span class="s2">&quot;tweets&quot;</span>
</span><span id="Twitter_Session-660"><a href="#Twitter_Session-660"><span class="linenos">660</span></a>
</span><span id="Twitter_Session-661"><a href="#Twitter_Session-661"><span class="linenos">661</span></a>        <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;following&quot;</span><span class="p">:</span>
</span><span id="Twitter_Session-662"><a href="#Twitter_Session-662"><span class="linenos">662</span></a>
</span><span id="Twitter_Session-663"><a href="#Twitter_Session-663"><span class="linenos">663</span></a>            <span class="n">engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sqlite:///data/</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">.db&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session-664"><a href="#Twitter_Session-664"><span class="linenos">664</span></a>
</span><span id="Twitter_Session-665"><a href="#Twitter_Session-665"><span class="linenos">665</span></a>            <span class="n">table_name</span> <span class="o">=</span> <span class="s2">&quot;following&quot;</span>
</span><span id="Twitter_Session-666"><a href="#Twitter_Session-666"><span class="linenos">666</span></a>
</span><span id="Twitter_Session-667"><a href="#Twitter_Session-667"><span class="linenos">667</span></a>        <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;followers&quot;</span><span class="p">:</span>
</span><span id="Twitter_Session-668"><a href="#Twitter_Session-668"><span class="linenos">668</span></a>
</span><span id="Twitter_Session-669"><a href="#Twitter_Session-669"><span class="linenos">669</span></a>            <span class="n">engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sqlite:///data/</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">.db&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session-670"><a href="#Twitter_Session-670"><span class="linenos">670</span></a>
</span><span id="Twitter_Session-671"><a href="#Twitter_Session-671"><span class="linenos">671</span></a>            <span class="n">table_name</span> <span class="o">=</span> <span class="s2">&quot;followers&quot;</span>
</span><span id="Twitter_Session-672"><a href="#Twitter_Session-672"><span class="linenos">672</span></a>
</span><span id="Twitter_Session-673"><a href="#Twitter_Session-673"><span class="linenos">673</span></a>        <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;query&quot;</span><span class="p">:</span>
</span><span id="Twitter_Session-674"><a href="#Twitter_Session-674"><span class="linenos">674</span></a>
</span><span id="Twitter_Session-675"><a href="#Twitter_Session-675"><span class="linenos">675</span></a>            <span class="n">engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;sqlite:///data/twitter_queries.db&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session-676"><a href="#Twitter_Session-676"><span class="linenos">676</span></a>
</span><span id="Twitter_Session-677"><a href="#Twitter_Session-677"><span class="linenos">677</span></a>            <span class="n">table_name</span> <span class="o">=</span> <span class="nb">id</span>
</span><span id="Twitter_Session-678"><a href="#Twitter_Session-678"><span class="linenos">678</span></a>            <span class="sd">&quot;&quot;&quot;For queries, use self.response.headers[&#39;x-transaction-id&#39;]&quot;&quot;&quot;</span>
</span><span id="Twitter_Session-679"><a href="#Twitter_Session-679"><span class="linenos">679</span></a>
</span><span id="Twitter_Session-680"><a href="#Twitter_Session-680"><span class="linenos">680</span></a>            <span class="n">data</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;query_term&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">query_term</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))])</span>
</span><span id="Twitter_Session-681"><a href="#Twitter_Session-681"><span class="linenos">681</span></a>
</span><span id="Twitter_Session-682"><a href="#Twitter_Session-682"><span class="linenos">682</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Twitter_Session-683"><a href="#Twitter_Session-683"><span class="linenos">683</span></a>
</span><span id="Twitter_Session-684"><a href="#Twitter_Session-684"><span class="linenos">684</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;type must be one of: profile, tweets, following, query&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session-685"><a href="#Twitter_Session-685"><span class="linenos">685</span></a>
</span><span id="Twitter_Session-686"><a href="#Twitter_Session-686"><span class="linenos">686</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Twitter_Session-687"><a href="#Twitter_Session-687"><span class="linenos">687</span></a>
</span><span id="Twitter_Session-688"><a href="#Twitter_Session-688"><span class="linenos">688</span></a>            <span class="n">data</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span>
</span><span id="Twitter_Session-689"><a href="#Twitter_Session-689"><span class="linenos">689</span></a>                <span class="mi">0</span><span class="p">,</span>
</span><span id="Twitter_Session-690"><a href="#Twitter_Session-690"><span class="linenos">690</span></a>                <span class="s2">&quot;capture_timestamp&quot;</span><span class="p">,</span>
</span><span id="Twitter_Session-691"><a href="#Twitter_Session-691"><span class="linenos">691</span></a>                <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))],</span>
</span><span id="Twitter_Session-692"><a href="#Twitter_Session-692"><span class="linenos">692</span></a>            <span class="p">)</span>
</span><span id="Twitter_Session-693"><a href="#Twitter_Session-693"><span class="linenos">693</span></a>
</span><span id="Twitter_Session-694"><a href="#Twitter_Session-694"><span class="linenos">694</span></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>  <span class="c1"># work-around to avoid producing a Nonetype DataFrame</span>
</span><span id="Twitter_Session-695"><a href="#Twitter_Session-695"><span class="linenos">695</span></a>
</span><span id="Twitter_Session-696"><a href="#Twitter_Session-696"><span class="linenos">696</span></a>            <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="s2">&quot;capture_timestamp&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Twitter_Session-697"><a href="#Twitter_Session-697"><span class="linenos">697</span></a>
</span><span id="Twitter_Session-698"><a href="#Twitter_Session-698"><span class="linenos">698</span></a>            <span class="n">data</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span>
</span><span id="Twitter_Session-699"><a href="#Twitter_Session-699"><span class="linenos">699</span></a>                <span class="mi">0</span><span class="p">,</span>
</span><span id="Twitter_Session-700"><a href="#Twitter_Session-700"><span class="linenos">700</span></a>                <span class="s2">&quot;capture_timestamp&quot;</span><span class="p">,</span>
</span><span id="Twitter_Session-701"><a href="#Twitter_Session-701"><span class="linenos">701</span></a>                <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))],</span>
</span><span id="Twitter_Session-702"><a href="#Twitter_Session-702"><span class="linenos">702</span></a>            <span class="p">)</span>
</span><span id="Twitter_Session-703"><a href="#Twitter_Session-703"><span class="linenos">703</span></a>
</span><span id="Twitter_Session-704"><a href="#Twitter_Session-704"><span class="linenos">704</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;str&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session-705"><a href="#Twitter_Session-705"><span class="linenos">705</span></a>
</span><span id="Twitter_Session-706"><a href="#Twitter_Session-706"><span class="linenos">706</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
</span><span id="Twitter_Session-707"><a href="#Twitter_Session-707"><span class="linenos">707</span></a>
</span><span id="Twitter_Session-708"><a href="#Twitter_Session-708"><span class="linenos">708</span></a>        <span class="n">data</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">table_name</span><span class="p">),</span> <span class="n">con</span><span class="o">=</span><span class="n">engine</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s2">&quot;append&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Twitter_Session-709"><a href="#Twitter_Session-709"><span class="linenos">709</span></a>
</span><span id="Twitter_Session-710"><a href="#Twitter_Session-710"><span class="linenos">710</span></a>        <span class="n">engine</span><span class="o">.</span><span class="n">dispose</span><span class="p">()</span>
</span><span id="Twitter_Session-711"><a href="#Twitter_Session-711"><span class="linenos">711</span></a>
</span><span id="Twitter_Session-712"><a href="#Twitter_Session-712"><span class="linenos">712</span></a>    <span class="k">def</span> <span class="nf">db_to_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="Twitter_Session-713"><a href="#Twitter_Session-713"><span class="linenos">713</span></a>
</span><span id="Twitter_Session-714"><a href="#Twitter_Session-714"><span class="linenos">714</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Twitter_Session-715"><a href="#Twitter_Session-715"><span class="linenos">715</span></a><span class="sd">        Read a user&#39;s data from a specified database into a pandas DataFrame.</span>
</span><span id="Twitter_Session-716"><a href="#Twitter_Session-716"><span class="linenos">716</span></a>
</span><span id="Twitter_Session-717"><a href="#Twitter_Session-717"><span class="linenos">717</span></a><span class="sd">        #### Paramters</span>
</span><span id="Twitter_Session-718"><a href="#Twitter_Session-718"><span class="linenos">718</span></a>
</span><span id="Twitter_Session-719"><a href="#Twitter_Session-719"><span class="linenos">719</span></a><span class="sd">            id : str - The user id of the profile. Can be referenced from the dataframe, or passed as string.</span>
</span><span id="Twitter_Session-720"><a href="#Twitter_Session-720"><span class="linenos">720</span></a>
</span><span id="Twitter_Session-721"><a href="#Twitter_Session-721"><span class="linenos">721</span></a><span class="sd">            type : str - profile, tweets, following</span>
</span><span id="Twitter_Session-722"><a href="#Twitter_Session-722"><span class="linenos">722</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Twitter_Session-723"><a href="#Twitter_Session-723"><span class="linenos">723</span></a>
</span><span id="Twitter_Session-724"><a href="#Twitter_Session-724"><span class="linenos">724</span></a>        <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;profile&quot;</span><span class="p">:</span>
</span><span id="Twitter_Session-725"><a href="#Twitter_Session-725"><span class="linenos">725</span></a>
</span><span id="Twitter_Session-726"><a href="#Twitter_Session-726"><span class="linenos">726</span></a>            <span class="n">engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sqlite:///data/</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">.db&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session-727"><a href="#Twitter_Session-727"><span class="linenos">727</span></a>
</span><span id="Twitter_Session-728"><a href="#Twitter_Session-728"><span class="linenos">728</span></a>            <span class="n">table_name</span> <span class="o">=</span> <span class="s2">&quot;profile&quot;</span>
</span><span id="Twitter_Session-729"><a href="#Twitter_Session-729"><span class="linenos">729</span></a>
</span><span id="Twitter_Session-730"><a href="#Twitter_Session-730"><span class="linenos">730</span></a>        <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;tweets&quot;</span><span class="p">:</span>
</span><span id="Twitter_Session-731"><a href="#Twitter_Session-731"><span class="linenos">731</span></a>
</span><span id="Twitter_Session-732"><a href="#Twitter_Session-732"><span class="linenos">732</span></a>            <span class="n">engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sqlite:///data/</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">.db&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session-733"><a href="#Twitter_Session-733"><span class="linenos">733</span></a>
</span><span id="Twitter_Session-734"><a href="#Twitter_Session-734"><span class="linenos">734</span></a>            <span class="n">table_name</span> <span class="o">=</span> <span class="s2">&quot;tweets&quot;</span>
</span><span id="Twitter_Session-735"><a href="#Twitter_Session-735"><span class="linenos">735</span></a>
</span><span id="Twitter_Session-736"><a href="#Twitter_Session-736"><span class="linenos">736</span></a>        <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;following&quot;</span><span class="p">:</span>
</span><span id="Twitter_Session-737"><a href="#Twitter_Session-737"><span class="linenos">737</span></a>
</span><span id="Twitter_Session-738"><a href="#Twitter_Session-738"><span class="linenos">738</span></a>            <span class="n">engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sqlite:///data/</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">.db&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session-739"><a href="#Twitter_Session-739"><span class="linenos">739</span></a>
</span><span id="Twitter_Session-740"><a href="#Twitter_Session-740"><span class="linenos">740</span></a>            <span class="n">table_name</span> <span class="o">=</span> <span class="s2">&quot;following&quot;</span>
</span><span id="Twitter_Session-741"><a href="#Twitter_Session-741"><span class="linenos">741</span></a>
</span><span id="Twitter_Session-742"><a href="#Twitter_Session-742"><span class="linenos">742</span></a>        <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;followers&quot;</span><span class="p">:</span>
</span><span id="Twitter_Session-743"><a href="#Twitter_Session-743"><span class="linenos">743</span></a>
</span><span id="Twitter_Session-744"><a href="#Twitter_Session-744"><span class="linenos">744</span></a>            <span class="n">engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sqlite:///data/</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">.db&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session-745"><a href="#Twitter_Session-745"><span class="linenos">745</span></a>
</span><span id="Twitter_Session-746"><a href="#Twitter_Session-746"><span class="linenos">746</span></a>            <span class="n">table_name</span> <span class="o">=</span> <span class="s2">&quot;followers&quot;</span>
</span><span id="Twitter_Session-747"><a href="#Twitter_Session-747"><span class="linenos">747</span></a>
</span><span id="Twitter_Session-748"><a href="#Twitter_Session-748"><span class="linenos">748</span></a>        <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;query&quot;</span><span class="p">:</span>
</span><span id="Twitter_Session-749"><a href="#Twitter_Session-749"><span class="linenos">749</span></a>
</span><span id="Twitter_Session-750"><a href="#Twitter_Session-750"><span class="linenos">750</span></a>            <span class="n">engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;sqlite:///data/twitter_queries.db&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session-751"><a href="#Twitter_Session-751"><span class="linenos">751</span></a>
</span><span id="Twitter_Session-752"><a href="#Twitter_Session-752"><span class="linenos">752</span></a>            <span class="n">table_name</span> <span class="o">=</span> <span class="nb">id</span>
</span><span id="Twitter_Session-753"><a href="#Twitter_Session-753"><span class="linenos">753</span></a>            <span class="sd">&quot;&quot;&quot;For queries, use self.response.headers[&#39;x-transaction-id&#39;]&quot;&quot;&quot;</span>
</span><span id="Twitter_Session-754"><a href="#Twitter_Session-754"><span class="linenos">754</span></a>
</span><span id="Twitter_Session-755"><a href="#Twitter_Session-755"><span class="linenos">755</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Twitter_Session-756"><a href="#Twitter_Session-756"><span class="linenos">756</span></a>
</span><span id="Twitter_Session-757"><a href="#Twitter_Session-757"><span class="linenos">757</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;type must be one of: profile, tweets, following, query&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session-758"><a href="#Twitter_Session-758"><span class="linenos">758</span></a>
</span><span id="Twitter_Session-759"><a href="#Twitter_Session-759"><span class="linenos">759</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_sql_table</span><span class="p">(</span><span class="n">table_name</span><span class="o">=</span><span class="n">table_name</span><span class="p">,</span> <span class="n">con</span><span class="o">=</span><span class="n">engine</span><span class="p">)</span>
</span><span id="Twitter_Session-760"><a href="#Twitter_Session-760"><span class="linenos">760</span></a>
</span><span id="Twitter_Session-761"><a href="#Twitter_Session-761"><span class="linenos">761</span></a>        <span class="n">engine</span><span class="o">.</span><span class="n">dispose</span><span class="p">()</span>
</span><span id="Twitter_Session-762"><a href="#Twitter_Session-762"><span class="linenos">762</span></a>
</span><span id="Twitter_Session-763"><a href="#Twitter_Session-763"><span class="linenos">763</span></a>        <span class="k">return</span> <span class="n">df</span>
</span><span id="Twitter_Session-764"><a href="#Twitter_Session-764"><span class="linenos">764</span></a>
</span><span id="Twitter_Session-765"><a href="#Twitter_Session-765"><span class="linenos">765</span></a>    <span class="k">def</span> <span class="nf">get_dbs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Twitter_Session-766"><a href="#Twitter_Session-766"><span class="linenos">766</span></a>
</span><span id="Twitter_Session-767"><a href="#Twitter_Session-767"><span class="linenos">767</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Twitter_Session-768"><a href="#Twitter_Session-768"><span class="linenos">768</span></a><span class="sd">        Retrieve Twitter databases. Uses regex to check file names for an expected convention.</span>
</span><span id="Twitter_Session-769"><a href="#Twitter_Session-769"><span class="linenos">769</span></a>
</span><span id="Twitter_Session-770"><a href="#Twitter_Session-770"><span class="linenos">770</span></a><span class="sd">        This will be deprecated by class Database_Functions.</span>
</span><span id="Twitter_Session-771"><a href="#Twitter_Session-771"><span class="linenos">771</span></a>
</span><span id="Twitter_Session-772"><a href="#Twitter_Session-772"><span class="linenos">772</span></a><span class="sd">        Returns</span>
</span><span id="Twitter_Session-773"><a href="#Twitter_Session-773"><span class="linenos">773</span></a>
</span><span id="Twitter_Session-774"><a href="#Twitter_Session-774"><span class="linenos">774</span></a><span class="sd">            A list of database files by user id.</span>
</span><span id="Twitter_Session-775"><a href="#Twitter_Session-775"><span class="linenos">775</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Twitter_Session-776"><a href="#Twitter_Session-776"><span class="linenos">776</span></a>
</span><span id="Twitter_Session-777"><a href="#Twitter_Session-777"><span class="linenos">777</span></a>        <span class="n">files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;data/*.db&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session-778"><a href="#Twitter_Session-778"><span class="linenos">778</span></a>
</span><span id="Twitter_Session-779"><a href="#Twitter_Session-779"><span class="linenos">779</span></a>        <span class="n">l</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="Twitter_Session-780"><a href="#Twitter_Session-780"><span class="linenos">780</span></a>            <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(\d+.db)&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">files</span>
</span><span id="Twitter_Session-781"><a href="#Twitter_Session-781"><span class="linenos">781</span></a>        <span class="p">]</span>  <span class="c1"># regex for any files consisting of [0-9].db</span>
</span><span id="Twitter_Session-782"><a href="#Twitter_Session-782"><span class="linenos">782</span></a>
</span><span id="Twitter_Session-783"><a href="#Twitter_Session-783"><span class="linenos">783</span></a>        <span class="n">processed_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">l</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
</span><span id="Twitter_Session-784"><a href="#Twitter_Session-784"><span class="linenos">784</span></a>
</span><span id="Twitter_Session-785"><a href="#Twitter_Session-785"><span class="linenos">785</span></a>        <span class="k">return</span> <span class="n">processed_list</span>
</span></pre></div>


            <div class="docstring"><p>A Twitter session object.</p>

<h4 id="parameters">Parameters</h4>

<pre><code>token : str - The bearer token for public metrics. Acquired via a Twitter developer account. Use the get_token_local() method to set.
</code></pre>

<h4 id="attributes">Attributes</h4>

<pre><code>token : str - The bearer token for this instance.

session : object - The requests.Session object for this instance.

history : list - History of URL calls made by this instance.

limit_log : dict - Metrics parsed from Twitter response headers. Used to set metrics trackers by the application.

query_log : dict - Log of queries made. Primarily used to find session query terms.
</code></pre>
</div>


                            <div id="Twitter_Session.__init__" class="classattr">
                                        <input id="Twitter_Session.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Twitter_Session</span><span class="signature pdoc-code condensed">()</span>

                <label class="view-source-button" for="Twitter_Session.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Twitter_Session.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Twitter_Session.__init__-48"><a href="#Twitter_Session.__init__-48"><span class="linenos">48</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Twitter_Session.__init__-49"><a href="#Twitter_Session.__init__-49"><span class="linenos">49</span></a>
</span><span id="Twitter_Session.__init__-50"><a href="#Twitter_Session.__init__-50"><span class="linenos">50</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Twitter_Session.__init__-51"><a href="#Twitter_Session.__init__-51"><span class="linenos">51</span></a><span class="sd">        Instantiate the session object. Requires no parameters.</span>
</span><span id="Twitter_Session.__init__-52"><a href="#Twitter_Session.__init__-52"><span class="linenos">52</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Twitter_Session.__init__-53"><a href="#Twitter_Session.__init__-53"><span class="linenos">53</span></a>
</span><span id="Twitter_Session.__init__-54"><a href="#Twitter_Session.__init__-54"><span class="linenos">54</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
</span><span id="Twitter_Session.__init__-55"><a href="#Twitter_Session.__init__-55"><span class="linenos">55</span></a>        <span class="sd">&quot;&quot;&quot;Creates a request.session object unique to the instance.&quot;&quot;&quot;</span>
</span><span id="Twitter_Session.__init__-56"><a href="#Twitter_Session.__init__-56"><span class="linenos">56</span></a>
</span><span id="Twitter_Session.__init__-57"><a href="#Twitter_Session.__init__-57"><span class="linenos">57</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">response</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="Twitter_Session.__init__-58"><a href="#Twitter_Session.__init__-58"><span class="linenos">58</span></a>        <span class="sd">&quot;&quot;&quot;The last requests.response object received.&quot;&quot;&quot;</span>
</span><span id="Twitter_Session.__init__-59"><a href="#Twitter_Session.__init__-59"><span class="linenos">59</span></a>
</span><span id="Twitter_Session.__init__-60"><a href="#Twitter_Session.__init__-60"><span class="linenos">60</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Twitter_Session.__init__-61"><a href="#Twitter_Session.__init__-61"><span class="linenos">61</span></a>        <span class="sd">&quot;&quot;&quot;The log of Twitter server rates and limits. Appended as the endpoint is accessed. Refer: https://developer.twitter.com/en/docs/twitter-api/rate-limits&quot;&quot;&quot;</span>
</span><span id="Twitter_Session.__init__-62"><a href="#Twitter_Session.__init__-62"><span class="linenos">62</span></a>
</span><span id="Twitter_Session.__init__-63"><a href="#Twitter_Session.__init__-63"><span class="linenos">63</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">query_log</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Twitter_Session.__init__-64"><a href="#Twitter_Session.__init__-64"><span class="linenos">64</span></a>        <span class="sd">&quot;&quot;&quot;The log of Twitter queries and responses. Use to reference the transaction id, search term, etc.&quot;&quot;&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Instantiate the session object. Requires no parameters.</p>
</div>


                            </div>
                            <div id="Twitter_Session.session" class="classattr">
                                <div class="attr variable">
            <span class="name">session</span>

        
    </div>
    <a class="headerlink" href="#Twitter_Session.session"></a>
    
            <div class="docstring"><p>Creates a request.session object unique to the instance.</p>
</div>


                            </div>
                            <div id="Twitter_Session.response" class="classattr">
                                <div class="attr variable">
            <span class="name">response</span>

        
    </div>
    <a class="headerlink" href="#Twitter_Session.response"></a>
    
            <div class="docstring"><p>The last requests.response object received.</p>
</div>


                            </div>
                            <div id="Twitter_Session.limit_log" class="classattr">
                                <div class="attr variable">
            <span class="name">limit_log</span>

        
    </div>
    <a class="headerlink" href="#Twitter_Session.limit_log"></a>
    
            <div class="docstring"><p>The log of Twitter server rates and limits. Appended as the endpoint is accessed. Refer: <a href="https://developer.twitter.com/en/docs/twitter-api/rate-limits">https://developer.twitter.com/en/docs/twitter-api/rate-limits</a></p>
</div>


                            </div>
                            <div id="Twitter_Session.query_log" class="classattr">
                                <div class="attr variable">
            <span class="name">query_log</span>

        
    </div>
    <a class="headerlink" href="#Twitter_Session.query_log"></a>
    
            <div class="docstring"><p>The log of Twitter queries and responses. Use to reference the transaction id, search term, etc.</p>
</div>


                            </div>
                            <div id="Twitter_Session.get_token_local" class="classattr">
                                        <input id="Twitter_Session.get_token_local-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_token_local</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">path</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Twitter_Session.get_token_local-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Twitter_Session.get_token_local"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Twitter_Session.get_token_local-66"><a href="#Twitter_Session.get_token_local-66"><span class="linenos">66</span></a>    <span class="k">def</span> <span class="nf">get_token_local</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Twitter_Session.get_token_local-67"><a href="#Twitter_Session.get_token_local-67"><span class="linenos">67</span></a>
</span><span id="Twitter_Session.get_token_local-68"><a href="#Twitter_Session.get_token_local-68"><span class="linenos">68</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Twitter_Session.get_token_local-69"><a href="#Twitter_Session.get_token_local-69"><span class="linenos">69</span></a><span class="sd">        Retreive a Twitter bearer token from a JSON with the following schema:</span>
</span><span id="Twitter_Session.get_token_local-70"><a href="#Twitter_Session.get_token_local-70"><span class="linenos">70</span></a>
</span><span id="Twitter_Session.get_token_local-71"><a href="#Twitter_Session.get_token_local-71"><span class="linenos">71</span></a><span class="sd">            {&#39;keys&#39;:</span>
</span><span id="Twitter_Session.get_token_local-72"><a href="#Twitter_Session.get_token_local-72"><span class="linenos">72</span></a>
</span><span id="Twitter_Session.get_token_local-73"><a href="#Twitter_Session.get_token_local-73"><span class="linenos">73</span></a><span class="sd">                &#39;Bearer Token&#39;: &#39;token&#39;</span>
</span><span id="Twitter_Session.get_token_local-74"><a href="#Twitter_Session.get_token_local-74"><span class="linenos">74</span></a>
</span><span id="Twitter_Session.get_token_local-75"><a href="#Twitter_Session.get_token_local-75"><span class="linenos">75</span></a><span class="sd">                }</span>
</span><span id="Twitter_Session.get_token_local-76"><a href="#Twitter_Session.get_token_local-76"><span class="linenos">76</span></a>
</span><span id="Twitter_Session.get_token_local-77"><a href="#Twitter_Session.get_token_local-77"><span class="linenos">77</span></a><span class="sd">        #### Parameters</span>
</span><span id="Twitter_Session.get_token_local-78"><a href="#Twitter_Session.get_token_local-78"><span class="linenos">78</span></a>
</span><span id="Twitter_Session.get_token_local-79"><a href="#Twitter_Session.get_token_local-79"><span class="linenos">79</span></a><span class="sd">            path : str - File path to the JSON. Must be accessible with open(), and readable by read().</span>
</span><span id="Twitter_Session.get_token_local-80"><a href="#Twitter_Session.get_token_local-80"><span class="linenos">80</span></a>
</span><span id="Twitter_Session.get_token_local-81"><a href="#Twitter_Session.get_token_local-81"><span class="linenos">81</span></a><span class="sd">        #### Attributes</span>
</span><span id="Twitter_Session.get_token_local-82"><a href="#Twitter_Session.get_token_local-82"><span class="linenos">82</span></a>
</span><span id="Twitter_Session.get_token_local-83"><a href="#Twitter_Session.get_token_local-83"><span class="linenos">83</span></a><span class="sd">            self.token : str - The bearer token string.</span>
</span><span id="Twitter_Session.get_token_local-84"><a href="#Twitter_Session.get_token_local-84"><span class="linenos">84</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Twitter_Session.get_token_local-85"><a href="#Twitter_Session.get_token_local-85"><span class="linenos">85</span></a>
</span><span id="Twitter_Session.get_token_local-86"><a href="#Twitter_Session.get_token_local-86"><span class="linenos">86</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="Twitter_Session.get_token_local-87"><a href="#Twitter_Session.get_token_local-87"><span class="linenos">87</span></a>
</span><span id="Twitter_Session.get_token_local-88"><a href="#Twitter_Session.get_token_local-88"><span class="linenos">88</span></a>            <span class="n">temp</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</span><span id="Twitter_Session.get_token_local-89"><a href="#Twitter_Session.get_token_local-89"><span class="linenos">89</span></a>
</span><span id="Twitter_Session.get_token_local-90"><a href="#Twitter_Session.get_token_local-90"><span class="linenos">90</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">token</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="s2">&quot;keys&quot;</span><span class="p">][</span><span class="s2">&quot;Bearer Token&quot;</span><span class="p">]</span>
</span><span id="Twitter_Session.get_token_local-91"><a href="#Twitter_Session.get_token_local-91"><span class="linenos">91</span></a>            <span class="sd">&quot;&quot;&quot;This session&#39;s bearer token. Acquired from a Twitter developer account. Refer: https://developer.twitter.com/en/docs/twitter-api/getting-started/getting-access-to-the-twitter-api&quot;&quot;&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Retreive a Twitter bearer token from a JSON with the following schema:</p>

<pre><code>{'keys':

    'Bearer Token': 'token'

    }
</code></pre>

<h4 id="parameters">Parameters</h4>

<pre><code>path : str - File path to the JSON. Must be accessible with open(), and readable by read().
</code></pre>

<h4 id="attributes">Attributes</h4>

<pre><code>self.token : str - The bearer token string.
</code></pre>
</div>


                            </div>
                            <div id="Twitter_Session.get_url" class="classattr">
                                        <input id="Twitter_Session.get_url-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_url</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">url</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Twitter_Session.get_url-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Twitter_Session.get_url"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Twitter_Session.get_url-93"><a href="#Twitter_Session.get_url-93"><span class="linenos"> 93</span></a>    <span class="k">def</span> <span class="nf">get_url</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Twitter_Session.get_url-94"><a href="#Twitter_Session.get_url-94"><span class="linenos"> 94</span></a>
</span><span id="Twitter_Session.get_url-95"><a href="#Twitter_Session.get_url-95"><span class="linenos"> 95</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Twitter_Session.get_url-96"><a href="#Twitter_Session.get_url-96"><span class="linenos"> 96</span></a><span class="sd">        Simple HTTP GET request.</span>
</span><span id="Twitter_Session.get_url-97"><a href="#Twitter_Session.get_url-97"><span class="linenos"> 97</span></a>
</span><span id="Twitter_Session.get_url-98"><a href="#Twitter_Session.get_url-98"><span class="linenos"> 98</span></a><span class="sd">        #### Parameters</span>
</span><span id="Twitter_Session.get_url-99"><a href="#Twitter_Session.get_url-99"><span class="linenos"> 99</span></a>
</span><span id="Twitter_Session.get_url-100"><a href="#Twitter_Session.get_url-100"><span class="linenos">100</span></a><span class="sd">            url : str - The complete URL, with or without a scheme. If no scheme is specified, defaults to &#39;https://&#39;.</span>
</span><span id="Twitter_Session.get_url-101"><a href="#Twitter_Session.get_url-101"><span class="linenos">101</span></a>
</span><span id="Twitter_Session.get_url-102"><a href="#Twitter_Session.get_url-102"><span class="linenos">102</span></a><span class="sd">        #### Attributes</span>
</span><span id="Twitter_Session.get_url-103"><a href="#Twitter_Session.get_url-103"><span class="linenos">103</span></a>
</span><span id="Twitter_Session.get_url-104"><a href="#Twitter_Session.get_url-104"><span class="linenos">104</span></a><span class="sd">            self.response : Response - The complete requests.response object, set to the class variable response.</span>
</span><span id="Twitter_Session.get_url-105"><a href="#Twitter_Session.get_url-105"><span class="linenos">105</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Twitter_Session.get_url-106"><a href="#Twitter_Session.get_url-106"><span class="linenos">106</span></a>
</span><span id="Twitter_Session.get_url-107"><a href="#Twitter_Session.get_url-107"><span class="linenos">107</span></a>        <span class="k">try</span><span class="p">:</span>  <span class="c1"># try the call</span>
</span><span id="Twitter_Session.get_url-108"><a href="#Twitter_Session.get_url-108"><span class="linenos">108</span></a>
</span><span id="Twitter_Session.get_url-109"><a href="#Twitter_Session.get_url-109"><span class="linenos">109</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="Twitter_Session.get_url-110"><a href="#Twitter_Session.get_url-110"><span class="linenos">110</span></a>                <span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Authorization&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Bearer </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">},</span> <span class="n">stream</span><span class="o">=</span><span class="kc">False</span>
</span><span id="Twitter_Session.get_url-111"><a href="#Twitter_Session.get_url-111"><span class="linenos">111</span></a>            <span class="p">)</span>
</span><span id="Twitter_Session.get_url-112"><a href="#Twitter_Session.get_url-112"><span class="linenos">112</span></a>
</span><span id="Twitter_Session.get_url-113"><a href="#Twitter_Session.get_url-113"><span class="linenos">113</span></a>        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">MissingSchema</span><span class="p">:</span>
</span><span id="Twitter_Session.get_url-114"><a href="#Twitter_Session.get_url-114"><span class="linenos">114</span></a>
</span><span id="Twitter_Session.get_url-115"><a href="#Twitter_Session.get_url-115"><span class="linenos">115</span></a>            <span class="c1"># print(sys.exc_info())</span>
</span><span id="Twitter_Session.get_url-116"><a href="#Twitter_Session.get_url-116"><span class="linenos">116</span></a>
</span><span id="Twitter_Session.get_url-117"><a href="#Twitter_Session.get_url-117"><span class="linenos">117</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="Twitter_Session.get_url-118"><a href="#Twitter_Session.get_url-118"><span class="linenos">118</span></a>                <span class="n">url</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;https://</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="Twitter_Session.get_url-119"><a href="#Twitter_Session.get_url-119"><span class="linenos">119</span></a>                <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Authorization&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Bearer </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">},</span>
</span><span id="Twitter_Session.get_url-120"><a href="#Twitter_Session.get_url-120"><span class="linenos">120</span></a>                <span class="n">stream</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Twitter_Session.get_url-121"><a href="#Twitter_Session.get_url-121"><span class="linenos">121</span></a>            <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Simple HTTP GET request.</p>

<h4 id="parameters">Parameters</h4>

<pre><code>url : str - The complete URL, with or without a scheme. If no scheme is specified, defaults to 'https://'.
</code></pre>

<h4 id="attributes">Attributes</h4>

<pre><code>self.response : Response - The complete requests.response object, set to the class variable response.
</code></pre>
</div>


                            </div>
                            <div id="Twitter_Session.get_user_profile" class="classattr">
                                        <input id="Twitter_Session.get_user_profile-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_user_profile</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">username</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span>:</span></span>

                <label class="view-source-button" for="Twitter_Session.get_user_profile-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Twitter_Session.get_user_profile"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Twitter_Session.get_user_profile-123"><a href="#Twitter_Session.get_user_profile-123"><span class="linenos">123</span></a>    <span class="k">def</span> <span class="nf">get_user_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="Twitter_Session.get_user_profile-124"><a href="#Twitter_Session.get_user_profile-124"><span class="linenos">124</span></a>
</span><span id="Twitter_Session.get_user_profile-125"><a href="#Twitter_Session.get_user_profile-125"><span class="linenos">125</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Twitter_Session.get_user_profile-126"><a href="#Twitter_Session.get_user_profile-126"><span class="linenos">126</span></a><span class="sd">        Request Twitter&#39;s users by username endpoint. Resets index.</span>
</span><span id="Twitter_Session.get_user_profile-127"><a href="#Twitter_Session.get_user_profile-127"><span class="linenos">127</span></a>
</span><span id="Twitter_Session.get_user_profile-128"><a href="#Twitter_Session.get_user_profile-128"><span class="linenos">128</span></a><span class="sd">        #### Parameters</span>
</span><span id="Twitter_Session.get_user_profile-129"><a href="#Twitter_Session.get_user_profile-129"><span class="linenos">129</span></a>
</span><span id="Twitter_Session.get_user_profile-130"><a href="#Twitter_Session.get_user_profile-130"><span class="linenos">130</span></a><span class="sd">            username : str - The @username. Can be passed with or without &#39;@&#39;.</span>
</span><span id="Twitter_Session.get_user_profile-131"><a href="#Twitter_Session.get_user_profile-131"><span class="linenos">131</span></a>
</span><span id="Twitter_Session.get_user_profile-132"><a href="#Twitter_Session.get_user_profile-132"><span class="linenos">132</span></a><span class="sd">            timer : bool</span>
</span><span id="Twitter_Session.get_user_profile-133"><a href="#Twitter_Session.get_user_profile-133"><span class="linenos">133</span></a>
</span><span id="Twitter_Session.get_user_profile-134"><a href="#Twitter_Session.get_user_profile-134"><span class="linenos">134</span></a><span class="sd">        #### Returns</span>
</span><span id="Twitter_Session.get_user_profile-135"><a href="#Twitter_Session.get_user_profile-135"><span class="linenos">135</span></a>
</span><span id="Twitter_Session.get_user_profile-136"><a href="#Twitter_Session.get_user_profile-136"><span class="linenos">136</span></a><span class="sd">            pandas.DataFrame - A parsed DataFrame generated from the response JSON.</span>
</span><span id="Twitter_Session.get_user_profile-137"><a href="#Twitter_Session.get_user_profile-137"><span class="linenos">137</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Twitter_Session.get_user_profile-138"><a href="#Twitter_Session.get_user_profile-138"><span class="linenos">138</span></a>
</span><span id="Twitter_Session.get_user_profile-139"><a href="#Twitter_Session.get_user_profile-139"><span class="linenos">139</span></a>        <span class="k">if</span> <span class="s2">&quot;timer&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="Twitter_Session.get_user_profile-140"><a href="#Twitter_Session.get_user_profile-140"><span class="linenos">140</span></a>
</span><span id="Twitter_Session.get_user_profile-141"><a href="#Twitter_Session.get_user_profile-141"><span class="linenos">141</span></a>            <span class="n">timer</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;timer&quot;</span><span class="p">]</span>
</span><span id="Twitter_Session.get_user_profile-142"><a href="#Twitter_Session.get_user_profile-142"><span class="linenos">142</span></a>
</span><span id="Twitter_Session.get_user_profile-143"><a href="#Twitter_Session.get_user_profile-143"><span class="linenos">143</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Twitter_Session.get_user_profile-144"><a href="#Twitter_Session.get_user_profile-144"><span class="linenos">144</span></a>
</span><span id="Twitter_Session.get_user_profile-145"><a href="#Twitter_Session.get_user_profile-145"><span class="linenos">145</span></a>            <span class="n">timer</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Twitter_Session.get_user_profile-146"><a href="#Twitter_Session.get_user_profile-146"><span class="linenos">146</span></a>
</span><span id="Twitter_Session.get_user_profile-147"><a href="#Twitter_Session.get_user_profile-147"><span class="linenos">147</span></a>        <span class="k">if</span> <span class="n">timer</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Twitter_Session.get_user_profile-148"><a href="#Twitter_Session.get_user_profile-148"><span class="linenos">148</span></a>
</span><span id="Twitter_Session.get_user_profile-149"><a href="#Twitter_Session.get_user_profile-149"><span class="linenos">149</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sleeping...-_-...&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session.get_user_profile-150"><a href="#Twitter_Session.get_user_profile-150"><span class="linenos">150</span></a>
</span><span id="Twitter_Session.get_user_profile-151"><a href="#Twitter_Session.get_user_profile-151"><span class="linenos">151</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">59</span><span class="p">)</span>
</span><span id="Twitter_Session.get_user_profile-152"><a href="#Twitter_Session.get_user_profile-152"><span class="linenos">152</span></a>
</span><span id="Twitter_Session.get_user_profile-153"><a href="#Twitter_Session.get_user_profile-153"><span class="linenos">153</span></a>        <span class="k">if</span> <span class="n">username</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;@&quot;</span><span class="p">:</span>
</span><span id="Twitter_Session.get_user_profile-154"><a href="#Twitter_Session.get_user_profile-154"><span class="linenos">154</span></a>
</span><span id="Twitter_Session.get_user_profile-155"><a href="#Twitter_Session.get_user_profile-155"><span class="linenos">155</span></a>            <span class="n">username</span> <span class="o">=</span> <span class="n">username</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="Twitter_Session.get_user_profile-156"><a href="#Twitter_Session.get_user_profile-156"><span class="linenos">156</span></a>
</span><span id="Twitter_Session.get_user_profile-157"><a href="#Twitter_Session.get_user_profile-157"><span class="linenos">157</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">get_url</span><span class="p">(</span>
</span><span id="Twitter_Session.get_user_profile-158"><a href="#Twitter_Session.get_user_profile-158"><span class="linenos">158</span></a>            <span class="n">url</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;https://api.twitter.com/2/users/by/username/</span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2">?user.fields=description,public_metrics,profile_image_url&quot;</span>
</span><span id="Twitter_Session.get_user_profile-159"><a href="#Twitter_Session.get_user_profile-159"><span class="linenos">159</span></a>        <span class="p">)</span>
</span><span id="Twitter_Session.get_user_profile-160"><a href="#Twitter_Session.get_user_profile-160"><span class="linenos">160</span></a>
</span><span id="Twitter_Session.get_user_profile-161"><a href="#Twitter_Session.get_user_profile-161"><span class="linenos">161</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Twitter_Session.get_user_profile-162"><a href="#Twitter_Session.get_user_profile-162"><span class="linenos">162</span></a>
</span><span id="Twitter_Session.get_user_profile-163"><a href="#Twitter_Session.get_user_profile-163"><span class="linenos">163</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;user_profile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_server_limits</span><span class="p">()</span>
</span><span id="Twitter_Session.get_user_profile-164"><a href="#Twitter_Session.get_user_profile-164"><span class="linenos">164</span></a>
</span><span id="Twitter_Session.get_user_profile-165"><a href="#Twitter_Session.get_user_profile-165"><span class="linenos">165</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;user_profile&quot;</span><span class="p">][</span><span class="s2">&quot;checked_at&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</span><span id="Twitter_Session.get_user_profile-166"><a href="#Twitter_Session.get_user_profile-166"><span class="linenos">166</span></a>
</span><span id="Twitter_Session.get_user_profile-167"><a href="#Twitter_Session.get_user_profile-167"><span class="linenos">167</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>
</span><span id="Twitter_Session.get_user_profile-168"><a href="#Twitter_Session.get_user_profile-168"><span class="linenos">168</span></a>
</span><span id="Twitter_Session.get_user_profile-169"><a href="#Twitter_Session.get_user_profile-169"><span class="linenos">169</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span><span id="Twitter_Session.get_user_profile-170"><a href="#Twitter_Session.get_user_profile-170"><span class="linenos">170</span></a>
</span><span id="Twitter_Session.get_user_profile-171"><a href="#Twitter_Session.get_user_profile-171"><span class="linenos">171</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="s2">&quot;metric&quot;</span><span class="p">})</span>
</span><span id="Twitter_Session.get_user_profile-172"><a href="#Twitter_Session.get_user_profile-172"><span class="linenos">172</span></a>
</span><span id="Twitter_Session.get_user_profile-173"><a href="#Twitter_Session.get_user_profile-173"><span class="linenos">173</span></a>            <span class="k">return</span> <span class="n">df</span>
</span><span id="Twitter_Session.get_user_profile-174"><a href="#Twitter_Session.get_user_profile-174"><span class="linenos">174</span></a>
</span><span id="Twitter_Session.get_user_profile-175"><a href="#Twitter_Session.get_user_profile-175"><span class="linenos">175</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="Twitter_Session.get_user_profile-176"><a href="#Twitter_Session.get_user_profile-176"><span class="linenos">176</span></a>
</span><span id="Twitter_Session.get_user_profile-177"><a href="#Twitter_Session.get_user_profile-177"><span class="linenos">177</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;user_profile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_server_limits</span><span class="p">()</span>
</span><span id="Twitter_Session.get_user_profile-178"><a href="#Twitter_Session.get_user_profile-178"><span class="linenos">178</span></a>
</span><span id="Twitter_Session.get_user_profile-179"><a href="#Twitter_Session.get_user_profile-179"><span class="linenos">179</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;user_profile&quot;</span><span class="p">][</span><span class="s2">&quot;checked_at&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</span><span id="Twitter_Session.get_user_profile-180"><a href="#Twitter_Session.get_user_profile-180"><span class="linenos">180</span></a>
</span><span id="Twitter_Session.get_user_profile-181"><a href="#Twitter_Session.get_user_profile-181"><span class="linenos">181</span></a>            <span class="k">return</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;errors&quot;</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Request Twitter's users by username endpoint. Resets index.</p>

<h4 id="parameters">Parameters</h4>

<pre><code>username : str - The @username. Can be passed with or without '@'.

timer : bool
</code></pre>

<h4 id="returns">Returns</h4>

<pre><code>pandas.DataFrame - A parsed DataFrame generated from the response JSON.
</code></pre>
</div>


                            </div>
                            <div id="Twitter_Session.get_user_tweets" class="classattr">
                                        <input id="Twitter_Session.get_user_tweets-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_user_tweets</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Twitter_Session.get_user_tweets-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Twitter_Session.get_user_tweets"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Twitter_Session.get_user_tweets-183"><a href="#Twitter_Session.get_user_tweets-183"><span class="linenos">183</span></a>    <span class="k">def</span> <span class="nf">get_user_tweets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Twitter_Session.get_user_tweets-184"><a href="#Twitter_Session.get_user_tweets-184"><span class="linenos">184</span></a>
</span><span id="Twitter_Session.get_user_tweets-185"><a href="#Twitter_Session.get_user_tweets-185"><span class="linenos">185</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Twitter_Session.get_user_tweets-186"><a href="#Twitter_Session.get_user_tweets-186"><span class="linenos">186</span></a><span class="sd">        Get all a user&#39;s tweets. This is a costly operation in that Twitter paginates tweets</span>
</span><span id="Twitter_Session.get_user_tweets-187"><a href="#Twitter_Session.get_user_tweets-187"><span class="linenos">187</span></a>
</span><span id="Twitter_Session.get_user_tweets-188"><a href="#Twitter_Session.get_user_tweets-188"><span class="linenos">188</span></a><span class="sd">        100 at a time. Due to rate limits, and depending on how many tweets a user has, this</span>
</span><span id="Twitter_Session.get_user_tweets-189"><a href="#Twitter_Session.get_user_tweets-189"><span class="linenos">189</span></a>
</span><span id="Twitter_Session.get_user_tweets-190"><a href="#Twitter_Session.get_user_tweets-190"><span class="linenos">190</span></a><span class="sd">        may take a while. Twitter rate epochs reset 15 minutes after the first call has been</span>
</span><span id="Twitter_Session.get_user_tweets-191"><a href="#Twitter_Session.get_user_tweets-191"><span class="linenos">191</span></a>
</span><span id="Twitter_Session.get_user_tweets-192"><a href="#Twitter_Session.get_user_tweets-192"><span class="linenos">192</span></a><span class="sd">        made. The rate limits vary. Refer to the rate limits returned in the headers of this</span>
</span><span id="Twitter_Session.get_user_tweets-193"><a href="#Twitter_Session.get_user_tweets-193"><span class="linenos">193</span></a>
</span><span id="Twitter_Session.get_user_tweets-194"><a href="#Twitter_Session.get_user_tweets-194"><span class="linenos">194</span></a><span class="sd">        class.</span>
</span><span id="Twitter_Session.get_user_tweets-195"><a href="#Twitter_Session.get_user_tweets-195"><span class="linenos">195</span></a>
</span><span id="Twitter_Session.get_user_tweets-196"><a href="#Twitter_Session.get_user_tweets-196"><span class="linenos">196</span></a><span class="sd">        #### Parameters</span>
</span><span id="Twitter_Session.get_user_tweets-197"><a href="#Twitter_Session.get_user_tweets-197"><span class="linenos">197</span></a>
</span><span id="Twitter_Session.get_user_tweets-198"><a href="#Twitter_Session.get_user_tweets-198"><span class="linenos">198</span></a><span class="sd">            user_id : str - The Twitter user&#39;s id. This is typically a 64-bit unsigned integer. Passed back to the server as a string to avoid accuracy loss. Read more: https://developer.twitter.com/en/docs/twitter-ids</span>
</span><span id="Twitter_Session.get_user_tweets-199"><a href="#Twitter_Session.get_user_tweets-199"><span class="linenos">199</span></a>
</span><span id="Twitter_Session.get_user_tweets-200"><a href="#Twitter_Session.get_user_tweets-200"><span class="linenos">200</span></a><span class="sd">            pages : int - Number of pages to request. Pages are 100 tweets. To get a user&#39;s entire profile, check their tweet count, divide by 100, and round up. If pages is not specified, the function will run recursively until all available pages have been retrieved or the rate limit has been reached.</span>
</span><span id="Twitter_Session.get_user_tweets-201"><a href="#Twitter_Session.get_user_tweets-201"><span class="linenos">201</span></a>
</span><span id="Twitter_Session.get_user_tweets-202"><a href="#Twitter_Session.get_user_tweets-202"><span class="linenos">202</span></a><span class="sd">            timer : bool</span>
</span><span id="Twitter_Session.get_user_tweets-203"><a href="#Twitter_Session.get_user_tweets-203"><span class="linenos">203</span></a>
</span><span id="Twitter_Session.get_user_tweets-204"><a href="#Twitter_Session.get_user_tweets-204"><span class="linenos">204</span></a><span class="sd">        #### Returns</span>
</span><span id="Twitter_Session.get_user_tweets-205"><a href="#Twitter_Session.get_user_tweets-205"><span class="linenos">205</span></a>
</span><span id="Twitter_Session.get_user_tweets-206"><a href="#Twitter_Session.get_user_tweets-206"><span class="linenos">206</span></a><span class="sd">            pandas.DataFrame - The DataFrame with a user&#39;s tweets.</span>
</span><span id="Twitter_Session.get_user_tweets-207"><a href="#Twitter_Session.get_user_tweets-207"><span class="linenos">207</span></a>
</span><span id="Twitter_Session.get_user_tweets-208"><a href="#Twitter_Session.get_user_tweets-208"><span class="linenos">208</span></a><span class="sd">        #### Example</span>
</span><span id="Twitter_Session.get_user_tweets-209"><a href="#Twitter_Session.get_user_tweets-209"><span class="linenos">209</span></a>
</span><span id="Twitter_Session.get_user_tweets-210"><a href="#Twitter_Session.get_user_tweets-210"><span class="linenos">210</span></a><span class="sd">            Getting all available user tweets</span>
</span><span id="Twitter_Session.get_user_tweets-211"><a href="#Twitter_Session.get_user_tweets-211"><span class="linenos">211</span></a>
</span><span id="Twitter_Session.get_user_tweets-212"><a href="#Twitter_Session.get_user_tweets-212"><span class="linenos">212</span></a><span class="sd">            `df = t1.get_user_profile(&#39;elonmusk&#39;)`</span>
</span><span id="Twitter_Session.get_user_tweets-213"><a href="#Twitter_Session.get_user_tweets-213"><span class="linenos">213</span></a><span class="sd">            `df = t1.get_user_tweets(df[&#39;id&#39;][0], round(df[&#39;tweet_count&#39;][0] / 100))`</span>
</span><span id="Twitter_Session.get_user_tweets-214"><a href="#Twitter_Session.get_user_tweets-214"><span class="linenos">214</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Twitter_Session.get_user_tweets-215"><a href="#Twitter_Session.get_user_tweets-215"><span class="linenos">215</span></a>
</span><span id="Twitter_Session.get_user_tweets-216"><a href="#Twitter_Session.get_user_tweets-216"><span class="linenos">216</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="Twitter_Session.get_user_tweets-217"><a href="#Twitter_Session.get_user_tweets-217"><span class="linenos">217</span></a>
</span><span id="Twitter_Session.get_user_tweets-218"><a href="#Twitter_Session.get_user_tweets-218"><span class="linenos">218</span></a>        <span class="k">if</span> <span class="s2">&quot;pages&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="Twitter_Session.get_user_tweets-219"><a href="#Twitter_Session.get_user_tweets-219"><span class="linenos">219</span></a>
</span><span id="Twitter_Session.get_user_tweets-220"><a href="#Twitter_Session.get_user_tweets-220"><span class="linenos">220</span></a>            <span class="n">pages</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;pages&quot;</span><span class="p">]</span>
</span><span id="Twitter_Session.get_user_tweets-221"><a href="#Twitter_Session.get_user_tweets-221"><span class="linenos">221</span></a>
</span><span id="Twitter_Session.get_user_tweets-222"><a href="#Twitter_Session.get_user_tweets-222"><span class="linenos">222</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Twitter_Session.get_user_tweets-223"><a href="#Twitter_Session.get_user_tweets-223"><span class="linenos">223</span></a>
</span><span id="Twitter_Session.get_user_tweets-224"><a href="#Twitter_Session.get_user_tweets-224"><span class="linenos">224</span></a>            <span class="n">pages</span> <span class="o">=</span> <span class="mi">1500</span>
</span><span id="Twitter_Session.get_user_tweets-225"><a href="#Twitter_Session.get_user_tweets-225"><span class="linenos">225</span></a>
</span><span id="Twitter_Session.get_user_tweets-226"><a href="#Twitter_Session.get_user_tweets-226"><span class="linenos">226</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pages</span><span class="p">):</span>
</span><span id="Twitter_Session.get_user_tweets-227"><a href="#Twitter_Session.get_user_tweets-227"><span class="linenos">227</span></a>
</span><span id="Twitter_Session.get_user_tweets-228"><a href="#Twitter_Session.get_user_tweets-228"><span class="linenos">228</span></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Twitter_Session.get_user_tweets-229"><a href="#Twitter_Session.get_user_tweets-229"><span class="linenos">229</span></a>
</span><span id="Twitter_Session.get_user_tweets-230"><a href="#Twitter_Session.get_user_tweets-230"><span class="linenos">230</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">get_url</span><span class="p">(</span>
</span><span id="Twitter_Session.get_user_tweets-231"><a href="#Twitter_Session.get_user_tweets-231"><span class="linenos">231</span></a>                    <span class="sa">f</span><span class="s2">&quot;https://api.twitter.com/2/users/</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">/tweets?tweet.fields=created_at,text,public_metrics&amp;max_results=100&quot;</span>
</span><span id="Twitter_Session.get_user_tweets-232"><a href="#Twitter_Session.get_user_tweets-232"><span class="linenos">232</span></a>                <span class="p">)</span>
</span><span id="Twitter_Session.get_user_tweets-233"><a href="#Twitter_Session.get_user_tweets-233"><span class="linenos">233</span></a>
</span><span id="Twitter_Session.get_user_tweets-234"><a href="#Twitter_Session.get_user_tweets-234"><span class="linenos">234</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">):</span>
</span><span id="Twitter_Session.get_user_tweets-235"><a href="#Twitter_Session.get_user_tweets-235"><span class="linenos">235</span></a>
</span><span id="Twitter_Session.get_user_tweets-236"><a href="#Twitter_Session.get_user_tweets-236"><span class="linenos">236</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;UsageCapExceeded&quot;</span><span class="p">:</span>
</span><span id="Twitter_Session.get_user_tweets-237"><a href="#Twitter_Session.get_user_tweets-237"><span class="linenos">237</span></a>
</span><span id="Twitter_Session.get_user_tweets-238"><a href="#Twitter_Session.get_user_tweets-238"><span class="linenos">238</span></a>                        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Usage cap exceeded for Tweets.&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session.get_user_tweets-239"><a href="#Twitter_Session.get_user_tweets-239"><span class="linenos">239</span></a>
</span><span id="Twitter_Session.get_user_tweets-240"><a href="#Twitter_Session.get_user_tweets-240"><span class="linenos">240</span></a>                        <span class="k">break</span>
</span><span id="Twitter_Session.get_user_tweets-241"><a href="#Twitter_Session.get_user_tweets-241"><span class="linenos">241</span></a>
</span><span id="Twitter_Session.get_user_tweets-242"><a href="#Twitter_Session.get_user_tweets-242"><span class="linenos">242</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">):</span>
</span><span id="Twitter_Session.get_user_tweets-243"><a href="#Twitter_Session.get_user_tweets-243"><span class="linenos">243</span></a>
</span><span id="Twitter_Session.get_user_tweets-244"><a href="#Twitter_Session.get_user_tweets-244"><span class="linenos">244</span></a>                    <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>
</span><span id="Twitter_Session.get_user_tweets-245"><a href="#Twitter_Session.get_user_tweets-245"><span class="linenos">245</span></a>
</span><span id="Twitter_Session.get_user_tweets-246"><a href="#Twitter_Session.get_user_tweets-246"><span class="linenos">246</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Twitter_Session.get_user_tweets-247"><a href="#Twitter_Session.get_user_tweets-247"><span class="linenos">247</span></a>
</span><span id="Twitter_Session.get_user_tweets-248"><a href="#Twitter_Session.get_user_tweets-248"><span class="linenos">248</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="Twitter_Session.get_user_tweets-249"><a href="#Twitter_Session.get_user_tweets-249"><span class="linenos">249</span></a>
</span><span id="Twitter_Session.get_user_tweets-250"><a href="#Twitter_Session.get_user_tweets-250"><span class="linenos">250</span></a>                    <span class="n">next_token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;meta&quot;</span><span class="p">][</span><span class="s2">&quot;next_token&quot;</span><span class="p">]</span>
</span><span id="Twitter_Session.get_user_tweets-251"><a href="#Twitter_Session.get_user_tweets-251"><span class="linenos">251</span></a>
</span><span id="Twitter_Session.get_user_tweets-252"><a href="#Twitter_Session.get_user_tweets-252"><span class="linenos">252</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">get_url</span><span class="p">(</span>
</span><span id="Twitter_Session.get_user_tweets-253"><a href="#Twitter_Session.get_user_tweets-253"><span class="linenos">253</span></a>                        <span class="sa">f</span><span class="s2">&quot;https://api.twitter.com/2/users/</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">/tweets?tweet.fields=created_at,text,public_metrics&amp;max_results=100&amp;pagination_token=</span><span class="si">{</span><span class="n">next_token</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="Twitter_Session.get_user_tweets-254"><a href="#Twitter_Session.get_user_tweets-254"><span class="linenos">254</span></a>                    <span class="p">)</span>
</span><span id="Twitter_Session.get_user_tweets-255"><a href="#Twitter_Session.get_user_tweets-255"><span class="linenos">255</span></a>
</span><span id="Twitter_Session.get_user_tweets-256"><a href="#Twitter_Session.get_user_tweets-256"><span class="linenos">256</span></a>                    <span class="n">df2</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>
</span><span id="Twitter_Session.get_user_tweets-257"><a href="#Twitter_Session.get_user_tweets-257"><span class="linenos">257</span></a>
</span><span id="Twitter_Session.get_user_tweets-258"><a href="#Twitter_Session.get_user_tweets-258"><span class="linenos">258</span></a>                    <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Twitter_Session.get_user_tweets-259"><a href="#Twitter_Session.get_user_tweets-259"><span class="linenos">259</span></a>
</span><span id="Twitter_Session.get_user_tweets-260"><a href="#Twitter_Session.get_user_tweets-260"><span class="linenos">260</span></a>                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="Twitter_Session.get_user_tweets-261"><a href="#Twitter_Session.get_user_tweets-261"><span class="linenos">261</span></a>
</span><span id="Twitter_Session.get_user_tweets-262"><a href="#Twitter_Session.get_user_tweets-262"><span class="linenos">262</span></a>                    <span class="k">break</span>
</span><span id="Twitter_Session.get_user_tweets-263"><a href="#Twitter_Session.get_user_tweets-263"><span class="linenos">263</span></a>
</span><span id="Twitter_Session.get_user_tweets-264"><a href="#Twitter_Session.get_user_tweets-264"><span class="linenos">264</span></a>            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;timer&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="Twitter_Session.get_user_tweets-265"><a href="#Twitter_Session.get_user_tweets-265"><span class="linenos">265</span></a>
</span><span id="Twitter_Session.get_user_tweets-266"><a href="#Twitter_Session.get_user_tweets-266"><span class="linenos">266</span></a>                <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;timer&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Twitter_Session.get_user_tweets-267"><a href="#Twitter_Session.get_user_tweets-267"><span class="linenos">267</span></a>
</span><span id="Twitter_Session.get_user_tweets-268"><a href="#Twitter_Session.get_user_tweets-268"><span class="linenos">268</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sleeping...-_-...&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session.get_user_tweets-269"><a href="#Twitter_Session.get_user_tweets-269"><span class="linenos">269</span></a>
</span><span id="Twitter_Session.get_user_tweets-270"><a href="#Twitter_Session.get_user_tweets-270"><span class="linenos">270</span></a>                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">59</span><span class="p">)</span>
</span><span id="Twitter_Session.get_user_tweets-271"><a href="#Twitter_Session.get_user_tweets-271"><span class="linenos">271</span></a>
</span><span id="Twitter_Session.get_user_tweets-272"><a href="#Twitter_Session.get_user_tweets-272"><span class="linenos">272</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Twitter_Session.get_user_tweets-273"><a href="#Twitter_Session.get_user_tweets-273"><span class="linenos">273</span></a>
</span><span id="Twitter_Session.get_user_tweets-274"><a href="#Twitter_Session.get_user_tweets-274"><span class="linenos">274</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span><span id="Twitter_Session.get_user_tweets-275"><a href="#Twitter_Session.get_user_tweets-275"><span class="linenos">275</span></a>
</span><span id="Twitter_Session.get_user_tweets-276"><a href="#Twitter_Session.get_user_tweets-276"><span class="linenos">276</span></a>            <span class="n">df2</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;public_metrics&quot;</span><span class="p">])</span>
</span><span id="Twitter_Session.get_user_tweets-277"><a href="#Twitter_Session.get_user_tweets-277"><span class="linenos">277</span></a>
</span><span id="Twitter_Session.get_user_tweets-278"><a href="#Twitter_Session.get_user_tweets-278"><span class="linenos">278</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;user_tweets&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_server_limits</span><span class="p">()</span>
</span><span id="Twitter_Session.get_user_tweets-279"><a href="#Twitter_Session.get_user_tweets-279"><span class="linenos">279</span></a>
</span><span id="Twitter_Session.get_user_tweets-280"><a href="#Twitter_Session.get_user_tweets-280"><span class="linenos">280</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;user_tweets&quot;</span><span class="p">][</span><span class="s2">&quot;checked_at&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</span><span id="Twitter_Session.get_user_tweets-281"><a href="#Twitter_Session.get_user_tweets-281"><span class="linenos">281</span></a>
</span><span id="Twitter_Session.get_user_tweets-282"><a href="#Twitter_Session.get_user_tweets-282"><span class="linenos">282</span></a>            <span class="k">return</span> <span class="n">pandas</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span>
</span><span id="Twitter_Session.get_user_tweets-283"><a href="#Twitter_Session.get_user_tweets-283"><span class="linenos">283</span></a>                <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;public_metrics&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
</span><span id="Twitter_Session.get_user_tweets-284"><a href="#Twitter_Session.get_user_tweets-284"><span class="linenos">284</span></a>            <span class="p">)</span>
</span><span id="Twitter_Session.get_user_tweets-285"><a href="#Twitter_Session.get_user_tweets-285"><span class="linenos">285</span></a>
</span><span id="Twitter_Session.get_user_tweets-286"><a href="#Twitter_Session.get_user_tweets-286"><span class="linenos">286</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="Twitter_Session.get_user_tweets-287"><a href="#Twitter_Session.get_user_tweets-287"><span class="linenos">287</span></a>
</span><span id="Twitter_Session.get_user_tweets-288"><a href="#Twitter_Session.get_user_tweets-288"><span class="linenos">288</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;user_tweets&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_server_limits</span><span class="p">()</span>
</span><span id="Twitter_Session.get_user_tweets-289"><a href="#Twitter_Session.get_user_tweets-289"><span class="linenos">289</span></a>
</span><span id="Twitter_Session.get_user_tweets-290"><a href="#Twitter_Session.get_user_tweets-290"><span class="linenos">290</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;user_tweets&quot;</span><span class="p">][</span><span class="s2">&quot;checked_at&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</span><span id="Twitter_Session.get_user_tweets-291"><a href="#Twitter_Session.get_user_tweets-291"><span class="linenos">291</span></a>
</span><span id="Twitter_Session.get_user_tweets-292"><a href="#Twitter_Session.get_user_tweets-292"><span class="linenos">292</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;errors&quot;</span><span class="p">):</span>
</span><span id="Twitter_Session.get_user_tweets-293"><a href="#Twitter_Session.get_user_tweets-293"><span class="linenos">293</span></a>
</span><span id="Twitter_Session.get_user_tweets-294"><a href="#Twitter_Session.get_user_tweets-294"><span class="linenos">294</span></a>                <span class="k">return</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;errors&quot;</span><span class="p">])</span>
</span><span id="Twitter_Session.get_user_tweets-295"><a href="#Twitter_Session.get_user_tweets-295"><span class="linenos">295</span></a>
</span><span id="Twitter_Session.get_user_tweets-296"><a href="#Twitter_Session.get_user_tweets-296"><span class="linenos">296</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Twitter_Session.get_user_tweets-297"><a href="#Twitter_Session.get_user_tweets-297"><span class="linenos">297</span></a>
</span><span id="Twitter_Session.get_user_tweets-298"><a href="#Twitter_Session.get_user_tweets-298"><span class="linenos">298</span></a>                <span class="k">return</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()])</span>
</span></pre></div>


            <div class="docstring"><p>Get all a user's tweets. This is a costly operation in that Twitter paginates tweets</p>

<p>100 at a time. Due to rate limits, and depending on how many tweets a user has, this</p>

<p>may take a while. Twitter rate epochs reset 15 minutes after the first call has been</p>

<p>made. The rate limits vary. Refer to the rate limits returned in the headers of this</p>

<p>class.</p>

<h4 id="parameters">Parameters</h4>

<pre><code>user_id : str - The Twitter user's id. This is typically a 64-bit unsigned integer. Passed back to the server as a string to avoid accuracy loss. Read more: https://developer.twitter.com/en/docs/twitter-ids

pages : int - Number of pages to request. Pages are 100 tweets. To get a user's entire profile, check their tweet count, divide by 100, and round up. If pages is not specified, the function will run recursively until all available pages have been retrieved or the rate limit has been reached.

timer : bool
</code></pre>

<h4 id="returns">Returns</h4>

<pre><code>pandas.DataFrame - The DataFrame with a user's tweets.
</code></pre>

<h4 id="example">Example</h4>

<pre><code>Getting all available user tweets

`df = t1.get_user_profile('elonmusk')`
`df = t1.get_user_tweets(df['id'][0], round(df['tweet_count'][0] / 100))`
</code></pre>
</div>


                            </div>
                            <div id="Twitter_Session.get_user_following" class="classattr">
                                        <input id="Twitter_Session.get_user_following-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_user_following</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Twitter_Session.get_user_following-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Twitter_Session.get_user_following"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Twitter_Session.get_user_following-300"><a href="#Twitter_Session.get_user_following-300"><span class="linenos">300</span></a>    <span class="k">def</span> <span class="nf">get_user_following</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Twitter_Session.get_user_following-301"><a href="#Twitter_Session.get_user_following-301"><span class="linenos">301</span></a>
</span><span id="Twitter_Session.get_user_following-302"><a href="#Twitter_Session.get_user_following-302"><span class="linenos">302</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Twitter_Session.get_user_following-303"><a href="#Twitter_Session.get_user_following-303"><span class="linenos">303</span></a><span class="sd">        Get all the users the requested account follows. If `pages` is not specified the function will run recursively.</span>
</span><span id="Twitter_Session.get_user_following-304"><a href="#Twitter_Session.get_user_following-304"><span class="linenos">304</span></a>
</span><span id="Twitter_Session.get_user_following-305"><a href="#Twitter_Session.get_user_following-305"><span class="linenos">305</span></a><span class="sd">        Endpoint: Users &gt; Follows lookup &gt; Limit: 15</span>
</span><span id="Twitter_Session.get_user_following-306"><a href="#Twitter_Session.get_user_following-306"><span class="linenos">306</span></a>
</span><span id="Twitter_Session.get_user_following-307"><a href="#Twitter_Session.get_user_following-307"><span class="linenos">307</span></a><span class="sd">        #### Parameters</span>
</span><span id="Twitter_Session.get_user_following-308"><a href="#Twitter_Session.get_user_following-308"><span class="linenos">308</span></a>
</span><span id="Twitter_Session.get_user_following-309"><a href="#Twitter_Session.get_user_following-309"><span class="linenos">309</span></a><span class="sd">            user_id : str - The Twitter user&#39;s id. This is typically a 64-bit unsigned integer. Passed back to the server as a string to avoid accuracy loss. Read more: https://developer.twitter.com/en/docs/twitter-ids</span>
</span><span id="Twitter_Session.get_user_following-310"><a href="#Twitter_Session.get_user_following-310"><span class="linenos">310</span></a>
</span><span id="Twitter_Session.get_user_following-311"><a href="#Twitter_Session.get_user_following-311"><span class="linenos">311</span></a><span class="sd">            pages : int - Number of pages to request. Pages are 100 tweets. To get a user&#39;s entire profile, check their tweet count, divide by 100, and round up. If pages is not specified, the function will run recursively until all available pages have been retrieved or the rate limit has been reached.</span>
</span><span id="Twitter_Session.get_user_following-312"><a href="#Twitter_Session.get_user_following-312"><span class="linenos">312</span></a>
</span><span id="Twitter_Session.get_user_following-313"><a href="#Twitter_Session.get_user_following-313"><span class="linenos">313</span></a><span class="sd">            timer : bool - Default `False`. If `True`, the script will use a sleep timer to prevent running over the rate limit. This means one page is collected per minute, until the end of pagination.</span>
</span><span id="Twitter_Session.get_user_following-314"><a href="#Twitter_Session.get_user_following-314"><span class="linenos">314</span></a>
</span><span id="Twitter_Session.get_user_following-315"><a href="#Twitter_Session.get_user_following-315"><span class="linenos">315</span></a><span class="sd">        #### Returns</span>
</span><span id="Twitter_Session.get_user_following-316"><a href="#Twitter_Session.get_user_following-316"><span class="linenos">316</span></a>
</span><span id="Twitter_Session.get_user_following-317"><a href="#Twitter_Session.get_user_following-317"><span class="linenos">317</span></a><span class="sd">            pandas.DataFrame - The DataFrame with a user&#39;s tweets.</span>
</span><span id="Twitter_Session.get_user_following-318"><a href="#Twitter_Session.get_user_following-318"><span class="linenos">318</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Twitter_Session.get_user_following-319"><a href="#Twitter_Session.get_user_following-319"><span class="linenos">319</span></a>
</span><span id="Twitter_Session.get_user_following-320"><a href="#Twitter_Session.get_user_following-320"><span class="linenos">320</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="Twitter_Session.get_user_following-321"><a href="#Twitter_Session.get_user_following-321"><span class="linenos">321</span></a>
</span><span id="Twitter_Session.get_user_following-322"><a href="#Twitter_Session.get_user_following-322"><span class="linenos">322</span></a>        <span class="k">if</span> <span class="s2">&quot;pages&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="Twitter_Session.get_user_following-323"><a href="#Twitter_Session.get_user_following-323"><span class="linenos">323</span></a>
</span><span id="Twitter_Session.get_user_following-324"><a href="#Twitter_Session.get_user_following-324"><span class="linenos">324</span></a>            <span class="n">pages</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;pages&quot;</span><span class="p">]</span>
</span><span id="Twitter_Session.get_user_following-325"><a href="#Twitter_Session.get_user_following-325"><span class="linenos">325</span></a>
</span><span id="Twitter_Session.get_user_following-326"><a href="#Twitter_Session.get_user_following-326"><span class="linenos">326</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Twitter_Session.get_user_following-327"><a href="#Twitter_Session.get_user_following-327"><span class="linenos">327</span></a>
</span><span id="Twitter_Session.get_user_following-328"><a href="#Twitter_Session.get_user_following-328"><span class="linenos">328</span></a>            <span class="n">pages</span> <span class="o">=</span> <span class="mi">15</span>
</span><span id="Twitter_Session.get_user_following-329"><a href="#Twitter_Session.get_user_following-329"><span class="linenos">329</span></a>
</span><span id="Twitter_Session.get_user_following-330"><a href="#Twitter_Session.get_user_following-330"><span class="linenos">330</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pages</span><span class="p">):</span>
</span><span id="Twitter_Session.get_user_following-331"><a href="#Twitter_Session.get_user_following-331"><span class="linenos">331</span></a>
</span><span id="Twitter_Session.get_user_following-332"><a href="#Twitter_Session.get_user_following-332"><span class="linenos">332</span></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Twitter_Session.get_user_following-333"><a href="#Twitter_Session.get_user_following-333"><span class="linenos">333</span></a>
</span><span id="Twitter_Session.get_user_following-334"><a href="#Twitter_Session.get_user_following-334"><span class="linenos">334</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">get_url</span><span class="p">(</span>
</span><span id="Twitter_Session.get_user_following-335"><a href="#Twitter_Session.get_user_following-335"><span class="linenos">335</span></a>                    <span class="sa">f</span><span class="s2">&quot;https://api.twitter.com/2/users/</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">/following?user.fields=id,name,username,public_metrics&amp;max_results=1000&quot;</span>
</span><span id="Twitter_Session.get_user_following-336"><a href="#Twitter_Session.get_user_following-336"><span class="linenos">336</span></a>                <span class="p">)</span>
</span><span id="Twitter_Session.get_user_following-337"><a href="#Twitter_Session.get_user_following-337"><span class="linenos">337</span></a>
</span><span id="Twitter_Session.get_user_following-338"><a href="#Twitter_Session.get_user_following-338"><span class="linenos">338</span></a>                <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>
</span><span id="Twitter_Session.get_user_following-339"><a href="#Twitter_Session.get_user_following-339"><span class="linenos">339</span></a>
</span><span id="Twitter_Session.get_user_following-340"><a href="#Twitter_Session.get_user_following-340"><span class="linenos">340</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Twitter_Session.get_user_following-341"><a href="#Twitter_Session.get_user_following-341"><span class="linenos">341</span></a>
</span><span id="Twitter_Session.get_user_following-342"><a href="#Twitter_Session.get_user_following-342"><span class="linenos">342</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="Twitter_Session.get_user_following-343"><a href="#Twitter_Session.get_user_following-343"><span class="linenos">343</span></a>
</span><span id="Twitter_Session.get_user_following-344"><a href="#Twitter_Session.get_user_following-344"><span class="linenos">344</span></a>                    <span class="n">next_token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;meta&quot;</span><span class="p">][</span><span class="s2">&quot;next_token&quot;</span><span class="p">]</span>
</span><span id="Twitter_Session.get_user_following-345"><a href="#Twitter_Session.get_user_following-345"><span class="linenos">345</span></a>
</span><span id="Twitter_Session.get_user_following-346"><a href="#Twitter_Session.get_user_following-346"><span class="linenos">346</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">get_url</span><span class="p">(</span>
</span><span id="Twitter_Session.get_user_following-347"><a href="#Twitter_Session.get_user_following-347"><span class="linenos">347</span></a>                        <span class="sa">f</span><span class="s2">&quot;https://api.twitter.com/2/users/</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">/following?user.fields=id,name,username,public_metrics&amp;max_results=1000&amp;pagination_token=</span><span class="si">{</span><span class="n">next_token</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="Twitter_Session.get_user_following-348"><a href="#Twitter_Session.get_user_following-348"><span class="linenos">348</span></a>                    <span class="p">)</span>
</span><span id="Twitter_Session.get_user_following-349"><a href="#Twitter_Session.get_user_following-349"><span class="linenos">349</span></a>
</span><span id="Twitter_Session.get_user_following-350"><a href="#Twitter_Session.get_user_following-350"><span class="linenos">350</span></a>                    <span class="n">df2</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>
</span><span id="Twitter_Session.get_user_following-351"><a href="#Twitter_Session.get_user_following-351"><span class="linenos">351</span></a>
</span><span id="Twitter_Session.get_user_following-352"><a href="#Twitter_Session.get_user_following-352"><span class="linenos">352</span></a>                    <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Twitter_Session.get_user_following-353"><a href="#Twitter_Session.get_user_following-353"><span class="linenos">353</span></a>
</span><span id="Twitter_Session.get_user_following-354"><a href="#Twitter_Session.get_user_following-354"><span class="linenos">354</span></a>                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="Twitter_Session.get_user_following-355"><a href="#Twitter_Session.get_user_following-355"><span class="linenos">355</span></a>
</span><span id="Twitter_Session.get_user_following-356"><a href="#Twitter_Session.get_user_following-356"><span class="linenos">356</span></a>                    <span class="k">break</span>
</span><span id="Twitter_Session.get_user_following-357"><a href="#Twitter_Session.get_user_following-357"><span class="linenos">357</span></a>
</span><span id="Twitter_Session.get_user_following-358"><a href="#Twitter_Session.get_user_following-358"><span class="linenos">358</span></a>            <span class="k">if</span> <span class="s2">&quot;timer&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="Twitter_Session.get_user_following-359"><a href="#Twitter_Session.get_user_following-359"><span class="linenos">359</span></a>
</span><span id="Twitter_Session.get_user_following-360"><a href="#Twitter_Session.get_user_following-360"><span class="linenos">360</span></a>                <span class="n">timer</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;timer&quot;</span><span class="p">]</span>
</span><span id="Twitter_Session.get_user_following-361"><a href="#Twitter_Session.get_user_following-361"><span class="linenos">361</span></a>
</span><span id="Twitter_Session.get_user_following-362"><a href="#Twitter_Session.get_user_following-362"><span class="linenos">362</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Twitter_Session.get_user_following-363"><a href="#Twitter_Session.get_user_following-363"><span class="linenos">363</span></a>
</span><span id="Twitter_Session.get_user_following-364"><a href="#Twitter_Session.get_user_following-364"><span class="linenos">364</span></a>                <span class="n">timer</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Twitter_Session.get_user_following-365"><a href="#Twitter_Session.get_user_following-365"><span class="linenos">365</span></a>
</span><span id="Twitter_Session.get_user_following-366"><a href="#Twitter_Session.get_user_following-366"><span class="linenos">366</span></a>            <span class="k">if</span> <span class="n">timer</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Twitter_Session.get_user_following-367"><a href="#Twitter_Session.get_user_following-367"><span class="linenos">367</span></a>
</span><span id="Twitter_Session.get_user_following-368"><a href="#Twitter_Session.get_user_following-368"><span class="linenos">368</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sleeping...-_-...&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session.get_user_following-369"><a href="#Twitter_Session.get_user_following-369"><span class="linenos">369</span></a>
</span><span id="Twitter_Session.get_user_following-370"><a href="#Twitter_Session.get_user_following-370"><span class="linenos">370</span></a>                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">59</span><span class="p">)</span>
</span><span id="Twitter_Session.get_user_following-371"><a href="#Twitter_Session.get_user_following-371"><span class="linenos">371</span></a>
</span><span id="Twitter_Session.get_user_following-372"><a href="#Twitter_Session.get_user_following-372"><span class="linenos">372</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;user_following&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_server_limits</span><span class="p">()</span>
</span><span id="Twitter_Session.get_user_following-373"><a href="#Twitter_Session.get_user_following-373"><span class="linenos">373</span></a>
</span><span id="Twitter_Session.get_user_following-374"><a href="#Twitter_Session.get_user_following-374"><span class="linenos">374</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;user_following&quot;</span><span class="p">][</span><span class="s2">&quot;checked_at&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</span><span id="Twitter_Session.get_user_following-375"><a href="#Twitter_Session.get_user_following-375"><span class="linenos">375</span></a>
</span><span id="Twitter_Session.get_user_following-376"><a href="#Twitter_Session.get_user_following-376"><span class="linenos">376</span></a>        <span class="k">return</span> <span class="n">df</span>
</span></pre></div>


            <div class="docstring"><p>Get all the users the requested account follows. If <code>pages</code> is not specified the function will run recursively.</p>

<p>Endpoint: Users &gt; Follows lookup &gt; Limit: 15</p>

<h4 id="parameters">Parameters</h4>

<pre><code>user_id : str - The Twitter user's id. This is typically a 64-bit unsigned integer. Passed back to the server as a string to avoid accuracy loss. Read more: https://developer.twitter.com/en/docs/twitter-ids

pages : int - Number of pages to request. Pages are 100 tweets. To get a user's entire profile, check their tweet count, divide by 100, and round up. If pages is not specified, the function will run recursively until all available pages have been retrieved or the rate limit has been reached.

timer : bool - Default `False`. If `True`, the script will use a sleep timer to prevent running over the rate limit. This means one page is collected per minute, until the end of pagination.
</code></pre>

<h4 id="returns">Returns</h4>

<pre><code>pandas.DataFrame - The DataFrame with a user's tweets.
</code></pre>
</div>


                            </div>
                            <div id="Twitter_Session.get_user_followers" class="classattr">
                                        <input id="Twitter_Session.get_user_followers-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_user_followers</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Twitter_Session.get_user_followers-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Twitter_Session.get_user_followers"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Twitter_Session.get_user_followers-378"><a href="#Twitter_Session.get_user_followers-378"><span class="linenos">378</span></a>    <span class="k">def</span> <span class="nf">get_user_followers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Twitter_Session.get_user_followers-379"><a href="#Twitter_Session.get_user_followers-379"><span class="linenos">379</span></a>
</span><span id="Twitter_Session.get_user_followers-380"><a href="#Twitter_Session.get_user_followers-380"><span class="linenos">380</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Twitter_Session.get_user_followers-381"><a href="#Twitter_Session.get_user_followers-381"><span class="linenos">381</span></a><span class="sd">        Get a user&#39;s followers.</span>
</span><span id="Twitter_Session.get_user_followers-382"><a href="#Twitter_Session.get_user_followers-382"><span class="linenos">382</span></a>
</span><span id="Twitter_Session.get_user_followers-383"><a href="#Twitter_Session.get_user_followers-383"><span class="linenos">383</span></a><span class="sd">        Attributes</span>
</span><span id="Twitter_Session.get_user_followers-384"><a href="#Twitter_Session.get_user_followers-384"><span class="linenos">384</span></a>
</span><span id="Twitter_Session.get_user_followers-385"><a href="#Twitter_Session.get_user_followers-385"><span class="linenos">385</span></a><span class="sd">            pages : int</span>
</span><span id="Twitter_Session.get_user_followers-386"><a href="#Twitter_Session.get_user_followers-386"><span class="linenos">386</span></a>
</span><span id="Twitter_Session.get_user_followers-387"><a href="#Twitter_Session.get_user_followers-387"><span class="linenos">387</span></a><span class="sd">            timer : bool</span>
</span><span id="Twitter_Session.get_user_followers-388"><a href="#Twitter_Session.get_user_followers-388"><span class="linenos">388</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Twitter_Session.get_user_followers-389"><a href="#Twitter_Session.get_user_followers-389"><span class="linenos">389</span></a>
</span><span id="Twitter_Session.get_user_followers-390"><a href="#Twitter_Session.get_user_followers-390"><span class="linenos">390</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="Twitter_Session.get_user_followers-391"><a href="#Twitter_Session.get_user_followers-391"><span class="linenos">391</span></a>
</span><span id="Twitter_Session.get_user_followers-392"><a href="#Twitter_Session.get_user_followers-392"><span class="linenos">392</span></a>        <span class="k">if</span> <span class="s2">&quot;pages&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="Twitter_Session.get_user_followers-393"><a href="#Twitter_Session.get_user_followers-393"><span class="linenos">393</span></a>
</span><span id="Twitter_Session.get_user_followers-394"><a href="#Twitter_Session.get_user_followers-394"><span class="linenos">394</span></a>            <span class="n">pages</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;pages&quot;</span><span class="p">]</span>
</span><span id="Twitter_Session.get_user_followers-395"><a href="#Twitter_Session.get_user_followers-395"><span class="linenos">395</span></a>
</span><span id="Twitter_Session.get_user_followers-396"><a href="#Twitter_Session.get_user_followers-396"><span class="linenos">396</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Twitter_Session.get_user_followers-397"><a href="#Twitter_Session.get_user_followers-397"><span class="linenos">397</span></a>
</span><span id="Twitter_Session.get_user_followers-398"><a href="#Twitter_Session.get_user_followers-398"><span class="linenos">398</span></a>            <span class="n">pages</span> <span class="o">=</span> <span class="mi">15</span>
</span><span id="Twitter_Session.get_user_followers-399"><a href="#Twitter_Session.get_user_followers-399"><span class="linenos">399</span></a>
</span><span id="Twitter_Session.get_user_followers-400"><a href="#Twitter_Session.get_user_followers-400"><span class="linenos">400</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pages</span><span class="p">):</span>
</span><span id="Twitter_Session.get_user_followers-401"><a href="#Twitter_Session.get_user_followers-401"><span class="linenos">401</span></a>
</span><span id="Twitter_Session.get_user_followers-402"><a href="#Twitter_Session.get_user_followers-402"><span class="linenos">402</span></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Twitter_Session.get_user_followers-403"><a href="#Twitter_Session.get_user_followers-403"><span class="linenos">403</span></a>
</span><span id="Twitter_Session.get_user_followers-404"><a href="#Twitter_Session.get_user_followers-404"><span class="linenos">404</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">get_url</span><span class="p">(</span>
</span><span id="Twitter_Session.get_user_followers-405"><a href="#Twitter_Session.get_user_followers-405"><span class="linenos">405</span></a>                    <span class="sa">f</span><span class="s2">&quot;https://api.twitter.com/2/users/</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">/followers?user.fields=id,name,username,public_metrics&amp;max_results=1000&quot;</span>
</span><span id="Twitter_Session.get_user_followers-406"><a href="#Twitter_Session.get_user_followers-406"><span class="linenos">406</span></a>                <span class="p">)</span>
</span><span id="Twitter_Session.get_user_followers-407"><a href="#Twitter_Session.get_user_followers-407"><span class="linenos">407</span></a>
</span><span id="Twitter_Session.get_user_followers-408"><a href="#Twitter_Session.get_user_followers-408"><span class="linenos">408</span></a>                <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>
</span><span id="Twitter_Session.get_user_followers-409"><a href="#Twitter_Session.get_user_followers-409"><span class="linenos">409</span></a>
</span><span id="Twitter_Session.get_user_followers-410"><a href="#Twitter_Session.get_user_followers-410"><span class="linenos">410</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Twitter_Session.get_user_followers-411"><a href="#Twitter_Session.get_user_followers-411"><span class="linenos">411</span></a>
</span><span id="Twitter_Session.get_user_followers-412"><a href="#Twitter_Session.get_user_followers-412"><span class="linenos">412</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="Twitter_Session.get_user_followers-413"><a href="#Twitter_Session.get_user_followers-413"><span class="linenos">413</span></a>
</span><span id="Twitter_Session.get_user_followers-414"><a href="#Twitter_Session.get_user_followers-414"><span class="linenos">414</span></a>                    <span class="n">next_token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;meta&quot;</span><span class="p">][</span><span class="s2">&quot;next_token&quot;</span><span class="p">]</span>
</span><span id="Twitter_Session.get_user_followers-415"><a href="#Twitter_Session.get_user_followers-415"><span class="linenos">415</span></a>
</span><span id="Twitter_Session.get_user_followers-416"><a href="#Twitter_Session.get_user_followers-416"><span class="linenos">416</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">get_url</span><span class="p">(</span>
</span><span id="Twitter_Session.get_user_followers-417"><a href="#Twitter_Session.get_user_followers-417"><span class="linenos">417</span></a>                        <span class="sa">f</span><span class="s2">&quot;https://api.twitter.com/2/users/</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">/followers?user.fields=id,name,username,public_metrics&amp;max_results=1000&amp;pagination_token=</span><span class="si">{</span><span class="n">next_token</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="Twitter_Session.get_user_followers-418"><a href="#Twitter_Session.get_user_followers-418"><span class="linenos">418</span></a>                    <span class="p">)</span>
</span><span id="Twitter_Session.get_user_followers-419"><a href="#Twitter_Session.get_user_followers-419"><span class="linenos">419</span></a>
</span><span id="Twitter_Session.get_user_followers-420"><a href="#Twitter_Session.get_user_followers-420"><span class="linenos">420</span></a>                    <span class="n">df2</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>
</span><span id="Twitter_Session.get_user_followers-421"><a href="#Twitter_Session.get_user_followers-421"><span class="linenos">421</span></a>
</span><span id="Twitter_Session.get_user_followers-422"><a href="#Twitter_Session.get_user_followers-422"><span class="linenos">422</span></a>                    <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Twitter_Session.get_user_followers-423"><a href="#Twitter_Session.get_user_followers-423"><span class="linenos">423</span></a>
</span><span id="Twitter_Session.get_user_followers-424"><a href="#Twitter_Session.get_user_followers-424"><span class="linenos">424</span></a>                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="Twitter_Session.get_user_followers-425"><a href="#Twitter_Session.get_user_followers-425"><span class="linenos">425</span></a>
</span><span id="Twitter_Session.get_user_followers-426"><a href="#Twitter_Session.get_user_followers-426"><span class="linenos">426</span></a>                    <span class="k">break</span>
</span><span id="Twitter_Session.get_user_followers-427"><a href="#Twitter_Session.get_user_followers-427"><span class="linenos">427</span></a>
</span><span id="Twitter_Session.get_user_followers-428"><a href="#Twitter_Session.get_user_followers-428"><span class="linenos">428</span></a>            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;timer&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="Twitter_Session.get_user_followers-429"><a href="#Twitter_Session.get_user_followers-429"><span class="linenos">429</span></a>
</span><span id="Twitter_Session.get_user_followers-430"><a href="#Twitter_Session.get_user_followers-430"><span class="linenos">430</span></a>                <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;timer&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Twitter_Session.get_user_followers-431"><a href="#Twitter_Session.get_user_followers-431"><span class="linenos">431</span></a>
</span><span id="Twitter_Session.get_user_followers-432"><a href="#Twitter_Session.get_user_followers-432"><span class="linenos">432</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sleeping...-_-...&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session.get_user_followers-433"><a href="#Twitter_Session.get_user_followers-433"><span class="linenos">433</span></a>
</span><span id="Twitter_Session.get_user_followers-434"><a href="#Twitter_Session.get_user_followers-434"><span class="linenos">434</span></a>                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">59</span><span class="p">)</span>
</span><span id="Twitter_Session.get_user_followers-435"><a href="#Twitter_Session.get_user_followers-435"><span class="linenos">435</span></a>
</span><span id="Twitter_Session.get_user_followers-436"><a href="#Twitter_Session.get_user_followers-436"><span class="linenos">436</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;user_followers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_server_limits</span><span class="p">()</span>
</span><span id="Twitter_Session.get_user_followers-437"><a href="#Twitter_Session.get_user_followers-437"><span class="linenos">437</span></a>
</span><span id="Twitter_Session.get_user_followers-438"><a href="#Twitter_Session.get_user_followers-438"><span class="linenos">438</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;user_followers&quot;</span><span class="p">][</span><span class="s2">&quot;checked_at&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</span><span id="Twitter_Session.get_user_followers-439"><a href="#Twitter_Session.get_user_followers-439"><span class="linenos">439</span></a>
</span><span id="Twitter_Session.get_user_followers-440"><a href="#Twitter_Session.get_user_followers-440"><span class="linenos">440</span></a>        <span class="k">return</span> <span class="n">df</span>
</span></pre></div>


            <div class="docstring"><p>Get a user's followers.</p>

<p>Attributes</p>

<pre><code>pages : int

timer : bool
</code></pre>
</div>


                            </div>
                            <div id="Twitter_Session.get_user_snapshot" class="classattr">
                                        <input id="Twitter_Session.get_user_snapshot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_user_snapshot</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">username</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Twitter_Session.get_user_snapshot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Twitter_Session.get_user_snapshot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Twitter_Session.get_user_snapshot-442"><a href="#Twitter_Session.get_user_snapshot-442"><span class="linenos">442</span></a>    <span class="k">def</span> <span class="nf">get_user_snapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Twitter_Session.get_user_snapshot-443"><a href="#Twitter_Session.get_user_snapshot-443"><span class="linenos">443</span></a>
</span><span id="Twitter_Session.get_user_snapshot-444"><a href="#Twitter_Session.get_user_snapshot-444"><span class="linenos">444</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Twitter_Session.get_user_snapshot-445"><a href="#Twitter_Session.get_user_snapshot-445"><span class="linenos">445</span></a><span class="sd">        Get profile, tweets, following, and followers of user</span>
</span><span id="Twitter_Session.get_user_snapshot-446"><a href="#Twitter_Session.get_user_snapshot-446"><span class="linenos">446</span></a><span class="sd">        with no page limits, and write to db.</span>
</span><span id="Twitter_Session.get_user_snapshot-447"><a href="#Twitter_Session.get_user_snapshot-447"><span class="linenos">447</span></a>
</span><span id="Twitter_Session.get_user_snapshot-448"><a href="#Twitter_Session.get_user_snapshot-448"><span class="linenos">448</span></a><span class="sd">        Must already have instantiated a Twitter_Session class</span>
</span><span id="Twitter_Session.get_user_snapshot-449"><a href="#Twitter_Session.get_user_snapshot-449"><span class="linenos">449</span></a><span class="sd">        object, and passed it a bearer token using get_token_local().</span>
</span><span id="Twitter_Session.get_user_snapshot-450"><a href="#Twitter_Session.get_user_snapshot-450"><span class="linenos">450</span></a>
</span><span id="Twitter_Session.get_user_snapshot-451"><a href="#Twitter_Session.get_user_snapshot-451"><span class="linenos">451</span></a><span class="sd">        Parameters</span>
</span><span id="Twitter_Session.get_user_snapshot-452"><a href="#Twitter_Session.get_user_snapshot-452"><span class="linenos">452</span></a>
</span><span id="Twitter_Session.get_user_snapshot-453"><a href="#Twitter_Session.get_user_snapshot-453"><span class="linenos">453</span></a><span class="sd">            username : str - The @username. Can be passed with or without &#39;@&#39;.</span>
</span><span id="Twitter_Session.get_user_snapshot-454"><a href="#Twitter_Session.get_user_snapshot-454"><span class="linenos">454</span></a>
</span><span id="Twitter_Session.get_user_snapshot-455"><a href="#Twitter_Session.get_user_snapshot-455"><span class="linenos">455</span></a><span class="sd">            followers : bool - Gather followers. Default == `False`.</span>
</span><span id="Twitter_Session.get_user_snapshot-456"><a href="#Twitter_Session.get_user_snapshot-456"><span class="linenos">456</span></a>
</span><span id="Twitter_Session.get_user_snapshot-457"><a href="#Twitter_Session.get_user_snapshot-457"><span class="linenos">457</span></a><span class="sd">            following : bool - Gather following. Default == `False`.</span>
</span><span id="Twitter_Session.get_user_snapshot-458"><a href="#Twitter_Session.get_user_snapshot-458"><span class="linenos">458</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Twitter_Session.get_user_snapshot-459"><a href="#Twitter_Session.get_user_snapshot-459"><span class="linenos">459</span></a>
</span><span id="Twitter_Session.get_user_snapshot-460"><a href="#Twitter_Session.get_user_snapshot-460"><span class="linenos">460</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_user_profile</span><span class="p">(</span><span class="n">username</span><span class="p">)</span>
</span><span id="Twitter_Session.get_user_snapshot-461"><a href="#Twitter_Session.get_user_snapshot-461"><span class="linenos">461</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">df_to_db</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">df</span><span class="p">,</span> <span class="s2">&quot;profile&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session.get_user_snapshot-462"><a href="#Twitter_Session.get_user_snapshot-462"><span class="linenos">462</span></a>
</span><span id="Twitter_Session.get_user_snapshot-463"><a href="#Twitter_Session.get_user_snapshot-463"><span class="linenos">463</span></a>        <span class="n">df2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_user_tweets</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Twitter_Session.get_user_snapshot-464"><a href="#Twitter_Session.get_user_snapshot-464"><span class="linenos">464</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">df_to_db</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">df2</span><span class="p">,</span> <span class="s2">&quot;tweets&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session.get_user_snapshot-465"><a href="#Twitter_Session.get_user_snapshot-465"><span class="linenos">465</span></a>
</span><span id="Twitter_Session.get_user_snapshot-466"><a href="#Twitter_Session.get_user_snapshot-466"><span class="linenos">466</span></a>        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;followers&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="Twitter_Session.get_user_snapshot-467"><a href="#Twitter_Session.get_user_snapshot-467"><span class="linenos">467</span></a>
</span><span id="Twitter_Session.get_user_snapshot-468"><a href="#Twitter_Session.get_user_snapshot-468"><span class="linenos">468</span></a>            <span class="n">df3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_user_following</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Twitter_Session.get_user_snapshot-469"><a href="#Twitter_Session.get_user_snapshot-469"><span class="linenos">469</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">df_to_db</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">df3</span><span class="p">,</span> <span class="s2">&quot;following&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session.get_user_snapshot-470"><a href="#Twitter_Session.get_user_snapshot-470"><span class="linenos">470</span></a>
</span><span id="Twitter_Session.get_user_snapshot-471"><a href="#Twitter_Session.get_user_snapshot-471"><span class="linenos">471</span></a>        <span class="k">elif</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;following&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="Twitter_Session.get_user_snapshot-472"><a href="#Twitter_Session.get_user_snapshot-472"><span class="linenos">472</span></a>
</span><span id="Twitter_Session.get_user_snapshot-473"><a href="#Twitter_Session.get_user_snapshot-473"><span class="linenos">473</span></a>            <span class="n">df4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_user_followers</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Twitter_Session.get_user_snapshot-474"><a href="#Twitter_Session.get_user_snapshot-474"><span class="linenos">474</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">df_to_db</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">df4</span><span class="p">,</span> <span class="s2">&quot;followers&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get profile, tweets, following, and followers of user
with no page limits, and write to db.</p>

<p>Must already have instantiated a Twitter_Session class
object, and passed it a bearer token using get_token_local().</p>

<p>Parameters</p>

<pre><code>username : str - The @username. Can be passed with or without '@'.

followers : bool - Gather followers. Default == `False`.

following : bool - Gather following. Default == `False`.
</code></pre>
</div>


                            </div>
                            <div id="Twitter_Session.get_string_query" class="classattr">
                                        <input id="Twitter_Session.get_string_query-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_string_query</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">query</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Twitter_Session.get_string_query-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Twitter_Session.get_string_query"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Twitter_Session.get_string_query-476"><a href="#Twitter_Session.get_string_query-476"><span class="linenos">476</span></a>    <span class="k">def</span> <span class="nf">get_string_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Twitter_Session.get_string_query-477"><a href="#Twitter_Session.get_string_query-477"><span class="linenos">477</span></a>
</span><span id="Twitter_Session.get_string_query-478"><a href="#Twitter_Session.get_string_query-478"><span class="linenos">478</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Twitter_Session.get_string_query-479"><a href="#Twitter_Session.get_string_query-479"><span class="linenos">479</span></a><span class="sd">        Query Twitter. Returns the last n pages of tweets containing the query string.</span>
</span><span id="Twitter_Session.get_string_query-480"><a href="#Twitter_Session.get_string_query-480"><span class="linenos">480</span></a>
</span><span id="Twitter_Session.get_string_query-481"><a href="#Twitter_Session.get_string_query-481"><span class="linenos">481</span></a><span class="sd">        #### Parameters</span>
</span><span id="Twitter_Session.get_string_query-482"><a href="#Twitter_Session.get_string_query-482"><span class="linenos">482</span></a>
</span><span id="Twitter_Session.get_string_query-483"><a href="#Twitter_Session.get_string_query-483"><span class="linenos">483</span></a><span class="sd">            query : str - The string to be searched for. Can include hashtags.</span>
</span><span id="Twitter_Session.get_string_query-484"><a href="#Twitter_Session.get_string_query-484"><span class="linenos">484</span></a>
</span><span id="Twitter_Session.get_string_query-485"><a href="#Twitter_Session.get_string_query-485"><span class="linenos">485</span></a><span class="sd">            pages : int - The number of pages to return. A page is 100 tweets. Default = 0.</span>
</span><span id="Twitter_Session.get_string_query-486"><a href="#Twitter_Session.get_string_query-486"><span class="linenos">486</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Twitter_Session.get_string_query-487"><a href="#Twitter_Session.get_string_query-487"><span class="linenos">487</span></a>
</span><span id="Twitter_Session.get_string_query-488"><a href="#Twitter_Session.get_string_query-488"><span class="linenos">488</span></a>        <span class="k">if</span> <span class="s2">&quot;pages&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="Twitter_Session.get_string_query-489"><a href="#Twitter_Session.get_string_query-489"><span class="linenos">489</span></a>
</span><span id="Twitter_Session.get_string_query-490"><a href="#Twitter_Session.get_string_query-490"><span class="linenos">490</span></a>            <span class="n">pages</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;pages&quot;</span><span class="p">]</span>
</span><span id="Twitter_Session.get_string_query-491"><a href="#Twitter_Session.get_string_query-491"><span class="linenos">491</span></a>
</span><span id="Twitter_Session.get_string_query-492"><a href="#Twitter_Session.get_string_query-492"><span class="linenos">492</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Twitter_Session.get_string_query-493"><a href="#Twitter_Session.get_string_query-493"><span class="linenos">493</span></a>
</span><span id="Twitter_Session.get_string_query-494"><a href="#Twitter_Session.get_string_query-494"><span class="linenos">494</span></a>            <span class="n">pages</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Twitter_Session.get_string_query-495"><a href="#Twitter_Session.get_string_query-495"><span class="linenos">495</span></a>
</span><span id="Twitter_Session.get_string_query-496"><a href="#Twitter_Session.get_string_query-496"><span class="linenos">496</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="Twitter_Session.get_string_query-497"><a href="#Twitter_Session.get_string_query-497"><span class="linenos">497</span></a>
</span><span id="Twitter_Session.get_string_query-498"><a href="#Twitter_Session.get_string_query-498"><span class="linenos">498</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pages</span><span class="p">):</span>
</span><span id="Twitter_Session.get_string_query-499"><a href="#Twitter_Session.get_string_query-499"><span class="linenos">499</span></a>
</span><span id="Twitter_Session.get_string_query-500"><a href="#Twitter_Session.get_string_query-500"><span class="linenos">500</span></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Twitter_Session.get_string_query-501"><a href="#Twitter_Session.get_string_query-501"><span class="linenos">501</span></a>
</span><span id="Twitter_Session.get_string_query-502"><a href="#Twitter_Session.get_string_query-502"><span class="linenos">502</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">get_url</span><span class="p">(</span>
</span><span id="Twitter_Session.get_string_query-503"><a href="#Twitter_Session.get_string_query-503"><span class="linenos">503</span></a>                    <span class="sa">f</span><span class="s2">&quot;https://api.twitter.com/2/tweets/search/recent?query=</span><span class="si">{</span><span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">query</span><span class="p">)</span><span class="si">}</span><span class="s2">&amp;max_results=100&quot;</span>
</span><span id="Twitter_Session.get_string_query-504"><a href="#Twitter_Session.get_string_query-504"><span class="linenos">504</span></a>                <span class="p">)</span>
</span><span id="Twitter_Session.get_string_query-505"><a href="#Twitter_Session.get_string_query-505"><span class="linenos">505</span></a>
</span><span id="Twitter_Session.get_string_query-506"><a href="#Twitter_Session.get_string_query-506"><span class="linenos">506</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;query&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_server_limits</span><span class="p">()</span>
</span><span id="Twitter_Session.get_string_query-507"><a href="#Twitter_Session.get_string_query-507"><span class="linenos">507</span></a>
</span><span id="Twitter_Session.get_string_query-508"><a href="#Twitter_Session.get_string_query-508"><span class="linenos">508</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;query&quot;</span><span class="p">][</span><span class="s2">&quot;checked_at&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</span><span id="Twitter_Session.get_string_query-509"><a href="#Twitter_Session.get_string_query-509"><span class="linenos">509</span></a>
</span><span id="Twitter_Session.get_string_query-510"><a href="#Twitter_Session.get_string_query-510"><span class="linenos">510</span></a>                <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>
</span><span id="Twitter_Session.get_string_query-511"><a href="#Twitter_Session.get_string_query-511"><span class="linenos">511</span></a>
</span><span id="Twitter_Session.get_string_query-512"><a href="#Twitter_Session.get_string_query-512"><span class="linenos">512</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Twitter_Session.get_string_query-513"><a href="#Twitter_Session.get_string_query-513"><span class="linenos">513</span></a>
</span><span id="Twitter_Session.get_string_query-514"><a href="#Twitter_Session.get_string_query-514"><span class="linenos">514</span></a>                <span class="n">next_token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;meta&quot;</span><span class="p">][</span><span class="s2">&quot;next_token&quot;</span><span class="p">]</span>
</span><span id="Twitter_Session.get_string_query-515"><a href="#Twitter_Session.get_string_query-515"><span class="linenos">515</span></a>
</span><span id="Twitter_Session.get_string_query-516"><a href="#Twitter_Session.get_string_query-516"><span class="linenos">516</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">get_url</span><span class="p">(</span>
</span><span id="Twitter_Session.get_string_query-517"><a href="#Twitter_Session.get_string_query-517"><span class="linenos">517</span></a>                    <span class="sa">f</span><span class="s2">&quot;https://api.twitter.com/2/tweets/search/recent?query=</span><span class="si">{</span><span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">query</span><span class="p">)</span><span class="si">}</span><span class="s2">&amp;max_results=100&amp;pagination_token=</span><span class="si">{</span><span class="n">next_token</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="Twitter_Session.get_string_query-518"><a href="#Twitter_Session.get_string_query-518"><span class="linenos">518</span></a>                <span class="p">)</span>
</span><span id="Twitter_Session.get_string_query-519"><a href="#Twitter_Session.get_string_query-519"><span class="linenos">519</span></a>
</span><span id="Twitter_Session.get_string_query-520"><a href="#Twitter_Session.get_string_query-520"><span class="linenos">520</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;query&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_server_limits</span><span class="p">()</span>
</span><span id="Twitter_Session.get_string_query-521"><a href="#Twitter_Session.get_string_query-521"><span class="linenos">521</span></a>
</span><span id="Twitter_Session.get_string_query-522"><a href="#Twitter_Session.get_string_query-522"><span class="linenos">522</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">limit_log</span><span class="p">[</span><span class="s2">&quot;query&quot;</span><span class="p">][</span><span class="s2">&quot;checked_at&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</span><span id="Twitter_Session.get_string_query-523"><a href="#Twitter_Session.get_string_query-523"><span class="linenos">523</span></a>
</span><span id="Twitter_Session.get_string_query-524"><a href="#Twitter_Session.get_string_query-524"><span class="linenos">524</span></a>                <span class="n">df2</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>
</span><span id="Twitter_Session.get_string_query-525"><a href="#Twitter_Session.get_string_query-525"><span class="linenos">525</span></a>
</span><span id="Twitter_Session.get_string_query-526"><a href="#Twitter_Session.get_string_query-526"><span class="linenos">526</span></a>                <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Twitter_Session.get_string_query-527"><a href="#Twitter_Session.get_string_query-527"><span class="linenos">527</span></a>
</span><span id="Twitter_Session.get_string_query-528"><a href="#Twitter_Session.get_string_query-528"><span class="linenos">528</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">query_log</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">query_log</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="Twitter_Session.get_string_query-529"><a href="#Twitter_Session.get_string_query-529"><span class="linenos">529</span></a>            <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span>
</span><span id="Twitter_Session.get_string_query-530"><a href="#Twitter_Session.get_string_query-530"><span class="linenos">530</span></a>            <span class="s2">&quot;x-transaction-id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;x-transaction-id&quot;</span><span class="p">],</span>
</span><span id="Twitter_Session.get_string_query-531"><a href="#Twitter_Session.get_string_query-531"><span class="linenos">531</span></a>            <span class="s2">&quot;query_term&quot;</span><span class="p">:</span> <span class="n">query</span><span class="p">,</span>
</span><span id="Twitter_Session.get_string_query-532"><a href="#Twitter_Session.get_string_query-532"><span class="linenos">532</span></a>            <span class="s2">&quot;parsed_query_term&quot;</span><span class="p">:</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">query</span><span class="p">),</span>
</span><span id="Twitter_Session.get_string_query-533"><a href="#Twitter_Session.get_string_query-533"><span class="linenos">533</span></a>        <span class="p">}</span>
</span><span id="Twitter_Session.get_string_query-534"><a href="#Twitter_Session.get_string_query-534"><span class="linenos">534</span></a>
</span><span id="Twitter_Session.get_string_query-535"><a href="#Twitter_Session.get_string_query-535"><span class="linenos">535</span></a>        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Query Twitter. Returns the last n pages of tweets containing the query string.</p>

<h4 id="parameters">Parameters</h4>

<pre><code>query : str - The string to be searched for. Can include hashtags.

pages : int - The number of pages to return. A page is 100 tweets. Default = 0.
</code></pre>
</div>


                            </div>
                            <div id="Twitter_Session.return_server_limits" class="classattr">
                                        <input id="Twitter_Session.return_server_limits-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">return_server_limits</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="Twitter_Session.return_server_limits-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Twitter_Session.return_server_limits"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Twitter_Session.return_server_limits-537"><a href="#Twitter_Session.return_server_limits-537"><span class="linenos">537</span></a>    <span class="k">def</span> <span class="nf">return_server_limits</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="Twitter_Session.return_server_limits-538"><a href="#Twitter_Session.return_server_limits-538"><span class="linenos">538</span></a>
</span><span id="Twitter_Session.return_server_limits-539"><a href="#Twitter_Session.return_server_limits-539"><span class="linenos">539</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Twitter_Session.return_server_limits-540"><a href="#Twitter_Session.return_server_limits-540"><span class="linenos">540</span></a><span class="sd">        Return Twitter server rate limits and timers from the response in memory. Used to update the limit log internally.</span>
</span><span id="Twitter_Session.return_server_limits-541"><a href="#Twitter_Session.return_server_limits-541"><span class="linenos">541</span></a>
</span><span id="Twitter_Session.return_server_limits-542"><a href="#Twitter_Session.return_server_limits-542"><span class="linenos">542</span></a><span class="sd">        #### Returns</span>
</span><span id="Twitter_Session.return_server_limits-543"><a href="#Twitter_Session.return_server_limits-543"><span class="linenos">543</span></a>
</span><span id="Twitter_Session.return_server_limits-544"><a href="#Twitter_Session.return_server_limits-544"><span class="linenos">544</span></a><span class="sd">            A dictionary with the following schema:</span>
</span><span id="Twitter_Session.return_server_limits-545"><a href="#Twitter_Session.return_server_limits-545"><span class="linenos">545</span></a>
</span><span id="Twitter_Session.return_server_limits-546"><a href="#Twitter_Session.return_server_limits-546"><span class="linenos">546</span></a><span class="sd">                {</span>
</span><span id="Twitter_Session.return_server_limits-547"><a href="#Twitter_Session.return_server_limits-547"><span class="linenos">547</span></a><span class="sd">                    &#39;remaining&#39;: float,</span>
</span><span id="Twitter_Session.return_server_limits-548"><a href="#Twitter_Session.return_server_limits-548"><span class="linenos">548</span></a><span class="sd">                    &#39;limit&#39;: float,</span>
</span><span id="Twitter_Session.return_server_limits-549"><a href="#Twitter_Session.return_server_limits-549"><span class="linenos">549</span></a><span class="sd">                    &#39;limit_reset&#39;: str,</span>
</span><span id="Twitter_Session.return_server_limits-550"><a href="#Twitter_Session.return_server_limits-550"><span class="linenos">550</span></a><span class="sd">                    &#39;percent_remaining&#39;: int,</span>
</span><span id="Twitter_Session.return_server_limits-551"><a href="#Twitter_Session.return_server_limits-551"><span class="linenos">551</span></a><span class="sd">                    &#39;limit_delta&#39;: str</span>
</span><span id="Twitter_Session.return_server_limits-552"><a href="#Twitter_Session.return_server_limits-552"><span class="linenos">552</span></a><span class="sd">                    }</span>
</span><span id="Twitter_Session.return_server_limits-553"><a href="#Twitter_Session.return_server_limits-553"><span class="linenos">553</span></a>
</span><span id="Twitter_Session.return_server_limits-554"><a href="#Twitter_Session.return_server_limits-554"><span class="linenos">554</span></a><span class="sd">            ##### Attributes</span>
</span><span id="Twitter_Session.return_server_limits-555"><a href="#Twitter_Session.return_server_limits-555"><span class="linenos">555</span></a>
</span><span id="Twitter_Session.return_server_limits-556"><a href="#Twitter_Session.return_server_limits-556"><span class="linenos">556</span></a><span class="sd">                remaining : float - Transmission-rate limit remaining in epoch for this endpoint.</span>
</span><span id="Twitter_Session.return_server_limits-557"><a href="#Twitter_Session.return_server_limits-557"><span class="linenos">557</span></a>
</span><span id="Twitter_Session.return_server_limits-558"><a href="#Twitter_Session.return_server_limits-558"><span class="linenos">558</span></a><span class="sd">                limit : float - Total call limit for the endpoint, per epoch.</span>
</span><span id="Twitter_Session.return_server_limits-559"><a href="#Twitter_Session.return_server_limits-559"><span class="linenos">559</span></a>
</span><span id="Twitter_Session.return_server_limits-560"><a href="#Twitter_Session.return_server_limits-560"><span class="linenos">560</span></a><span class="sd">                limit_reset : str - The time when the limit epoch resets. Converted from unix time stamp to a string with `%H:%M:%S` format.</span>
</span><span id="Twitter_Session.return_server_limits-561"><a href="#Twitter_Session.return_server_limits-561"><span class="linenos">561</span></a>
</span><span id="Twitter_Session.return_server_limits-562"><a href="#Twitter_Session.return_server_limits-562"><span class="linenos">562</span></a><span class="sd">                percent_remaining : int - Percentage remaining in the call limit, for this epoch.</span>
</span><span id="Twitter_Session.return_server_limits-563"><a href="#Twitter_Session.return_server_limits-563"><span class="linenos">563</span></a>
</span><span id="Twitter_Session.return_server_limits-564"><a href="#Twitter_Session.return_server_limits-564"><span class="linenos">564</span></a><span class="sd">                limit_delta : str - Difference between when the limit resets and now, in `%H:%M:%S` format.</span>
</span><span id="Twitter_Session.return_server_limits-565"><a href="#Twitter_Session.return_server_limits-565"><span class="linenos">565</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Twitter_Session.return_server_limits-566"><a href="#Twitter_Session.return_server_limits-566"><span class="linenos">566</span></a>
</span><span id="Twitter_Session.return_server_limits-567"><a href="#Twitter_Session.return_server_limits-567"><span class="linenos">567</span></a>        <span class="n">return_headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">headers</span>
</span><span id="Twitter_Session.return_server_limits-568"><a href="#Twitter_Session.return_server_limits-568"><span class="linenos">568</span></a>
</span><span id="Twitter_Session.return_server_limits-569"><a href="#Twitter_Session.return_server_limits-569"><span class="linenos">569</span></a>        <span class="n">remaining</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">return_headers</span><span class="p">[</span><span class="s2">&quot;x-rate-limit-remaining&quot;</span><span class="p">])</span>
</span><span id="Twitter_Session.return_server_limits-570"><a href="#Twitter_Session.return_server_limits-570"><span class="linenos">570</span></a>
</span><span id="Twitter_Session.return_server_limits-571"><a href="#Twitter_Session.return_server_limits-571"><span class="linenos">571</span></a>        <span class="n">limit</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">return_headers</span><span class="p">[</span><span class="s2">&quot;x-rate-limit-limit&quot;</span><span class="p">])</span>
</span><span id="Twitter_Session.return_server_limits-572"><a href="#Twitter_Session.return_server_limits-572"><span class="linenos">572</span></a>
</span><span id="Twitter_Session.return_server_limits-573"><a href="#Twitter_Session.return_server_limits-573"><span class="linenos">573</span></a>        <span class="n">percent_remaining</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">remaining</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">limit</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
</span><span id="Twitter_Session.return_server_limits-574"><a href="#Twitter_Session.return_server_limits-574"><span class="linenos">574</span></a>
</span><span id="Twitter_Session.return_server_limits-575"><a href="#Twitter_Session.return_server_limits-575"><span class="linenos">575</span></a>        <span class="c1"># TODO rename this variable</span>
</span><span id="Twitter_Session.return_server_limits-576"><a href="#Twitter_Session.return_server_limits-576"><span class="linenos">576</span></a>        <span class="c1"># NOTE this is used as the delta in a streamlit.metric object</span>
</span><span id="Twitter_Session.return_server_limits-577"><a href="#Twitter_Session.return_server_limits-577"><span class="linenos">577</span></a>        <span class="n">remaining_math</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span> <span class="o">-</span> <span class="n">percent_remaining</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="Twitter_Session.return_server_limits-578"><a href="#Twitter_Session.return_server_limits-578"><span class="linenos">578</span></a>
</span><span id="Twitter_Session.return_server_limits-579"><a href="#Twitter_Session.return_server_limits-579"><span class="linenos">579</span></a>        <span class="c1"># TODO there has to be a better way than the following:</span>
</span><span id="Twitter_Session.return_server_limits-580"><a href="#Twitter_Session.return_server_limits-580"><span class="linenos">580</span></a>        <span class="n">limit_reset</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span>
</span><span id="Twitter_Session.return_server_limits-581"><a href="#Twitter_Session.return_server_limits-581"><span class="linenos">581</span></a>            <span class="s2">&quot;%H:%M:%S&quot;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">localtime</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">return_headers</span><span class="p">[</span><span class="s2">&quot;x-rate-limit-reset&quot;</span><span class="p">]))</span>
</span><span id="Twitter_Session.return_server_limits-582"><a href="#Twitter_Session.return_server_limits-582"><span class="linenos">582</span></a>        <span class="p">)</span>
</span><span id="Twitter_Session.return_server_limits-583"><a href="#Twitter_Session.return_server_limits-583"><span class="linenos">583</span></a>
</span><span id="Twitter_Session.return_server_limits-584"><a href="#Twitter_Session.return_server_limits-584"><span class="linenos">584</span></a>        <span class="n">limit_reset</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">limit_reset</span><span class="p">,</span> <span class="s2">&quot;%H:%M:%S&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session.return_server_limits-585"><a href="#Twitter_Session.return_server_limits-585"><span class="linenos">585</span></a>
</span><span id="Twitter_Session.return_server_limits-586"><a href="#Twitter_Session.return_server_limits-586"><span class="linenos">586</span></a>        <span class="n">limit_reset</span> <span class="o">=</span> <span class="n">limit_reset</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="Twitter_Session.return_server_limits-587"><a href="#Twitter_Session.return_server_limits-587"><span class="linenos">587</span></a>
</span><span id="Twitter_Session.return_server_limits-588"><a href="#Twitter_Session.return_server_limits-588"><span class="linenos">588</span></a>        <span class="n">time_now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</span><span id="Twitter_Session.return_server_limits-589"><a href="#Twitter_Session.return_server_limits-589"><span class="linenos">589</span></a>
</span><span id="Twitter_Session.return_server_limits-590"><a href="#Twitter_Session.return_server_limits-590"><span class="linenos">590</span></a>        <span class="n">time_now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span>
</span><span id="Twitter_Session.return_server_limits-591"><a href="#Twitter_Session.return_server_limits-591"><span class="linenos">591</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">time_now</span><span class="o">.</span><span class="n">hour</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">time_now</span><span class="o">.</span><span class="n">minute</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">time_now</span><span class="o">.</span><span class="n">second</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;%H:%M:%S&quot;</span>
</span><span id="Twitter_Session.return_server_limits-592"><a href="#Twitter_Session.return_server_limits-592"><span class="linenos">592</span></a>        <span class="p">)</span>
</span><span id="Twitter_Session.return_server_limits-593"><a href="#Twitter_Session.return_server_limits-593"><span class="linenos">593</span></a>
</span><span id="Twitter_Session.return_server_limits-594"><a href="#Twitter_Session.return_server_limits-594"><span class="linenos">594</span></a>        <span class="n">time_now</span> <span class="o">=</span> <span class="n">time_now</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="Twitter_Session.return_server_limits-595"><a href="#Twitter_Session.return_server_limits-595"><span class="linenos">595</span></a>
</span><span id="Twitter_Session.return_server_limits-596"><a href="#Twitter_Session.return_server_limits-596"><span class="linenos">596</span></a>        <span class="n">limit_reset</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">(),</span> <span class="n">limit_reset</span><span class="p">)</span>
</span><span id="Twitter_Session.return_server_limits-597"><a href="#Twitter_Session.return_server_limits-597"><span class="linenos">597</span></a>
</span><span id="Twitter_Session.return_server_limits-598"><a href="#Twitter_Session.return_server_limits-598"><span class="linenos">598</span></a>        <span class="n">time_now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">(),</span> <span class="n">time_now</span><span class="p">)</span>
</span><span id="Twitter_Session.return_server_limits-599"><a href="#Twitter_Session.return_server_limits-599"><span class="linenos">599</span></a>
</span><span id="Twitter_Session.return_server_limits-600"><a href="#Twitter_Session.return_server_limits-600"><span class="linenos">600</span></a>        <span class="n">limit_delta</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">limit_reset</span> <span class="o">-</span> <span class="n">time_now</span><span class="p">)</span>
</span><span id="Twitter_Session.return_server_limits-601"><a href="#Twitter_Session.return_server_limits-601"><span class="linenos">601</span></a>
</span><span id="Twitter_Session.return_server_limits-602"><a href="#Twitter_Session.return_server_limits-602"><span class="linenos">602</span></a>        <span class="n">limit_reset</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">limit_reset</span><span class="p">,</span> <span class="s2">&quot;%H:%M:%S&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session.return_server_limits-603"><a href="#Twitter_Session.return_server_limits-603"><span class="linenos">603</span></a>
</span><span id="Twitter_Session.return_server_limits-604"><a href="#Twitter_Session.return_server_limits-604"><span class="linenos">604</span></a>        <span class="nb">dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="Twitter_Session.return_server_limits-605"><a href="#Twitter_Session.return_server_limits-605"><span class="linenos">605</span></a>            <span class="s2">&quot;remaining&quot;</span><span class="p">:</span> <span class="n">remaining</span><span class="p">,</span>
</span><span id="Twitter_Session.return_server_limits-606"><a href="#Twitter_Session.return_server_limits-606"><span class="linenos">606</span></a>            <span class="s2">&quot;limit&quot;</span><span class="p">:</span> <span class="n">limit</span><span class="p">,</span>
</span><span id="Twitter_Session.return_server_limits-607"><a href="#Twitter_Session.return_server_limits-607"><span class="linenos">607</span></a>            <span class="s2">&quot;limit_reset&quot;</span><span class="p">:</span> <span class="n">limit_reset</span><span class="p">,</span>
</span><span id="Twitter_Session.return_server_limits-608"><a href="#Twitter_Session.return_server_limits-608"><span class="linenos">608</span></a>            <span class="s2">&quot;percent_remaining&quot;</span><span class="p">:</span> <span class="n">percent_remaining</span><span class="p">,</span>
</span><span id="Twitter_Session.return_server_limits-609"><a href="#Twitter_Session.return_server_limits-609"><span class="linenos">609</span></a>            <span class="s2">&quot;limit_delta&quot;</span><span class="p">:</span> <span class="n">limit_delta</span><span class="p">,</span>
</span><span id="Twitter_Session.return_server_limits-610"><a href="#Twitter_Session.return_server_limits-610"><span class="linenos">610</span></a>        <span class="p">}</span>
</span><span id="Twitter_Session.return_server_limits-611"><a href="#Twitter_Session.return_server_limits-611"><span class="linenos">611</span></a>
</span><span id="Twitter_Session.return_server_limits-612"><a href="#Twitter_Session.return_server_limits-612"><span class="linenos">612</span></a>        <span class="k">return</span> <span class="nb">dict</span>
</span></pre></div>


            <div class="docstring"><p>Return Twitter server rate limits and timers from the response in memory. Used to update the limit log internally.</p>

<h4 id="returns">Returns</h4>

<pre><code>A dictionary with the following schema:

    {
        'remaining': float,
        'limit': float,
        'limit_reset': str,
        'percent_remaining': int,
        'limit_delta': str
        }

##### Attributes

    remaining : float - Transmission-rate limit remaining in epoch for this endpoint.

    limit : float - Total call limit for the endpoint, per epoch.

    limit_reset : str - The time when the limit epoch resets. Converted from unix time stamp to a string with `%H:%M:%S` format.

    percent_remaining : int - Percentage remaining in the call limit, for this epoch.

    limit_delta : str - Difference between when the limit resets and now, in `%H:%M:%S` format.
</code></pre>
</div>


                            </div>
                            <div id="Twitter_Session.df_to_db" class="classattr">
                                        <input id="Twitter_Session.df_to_db-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">df_to_db</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="nb">id</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">data</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span>,</span><span class="param">	<span class="nb">type</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Twitter_Session.df_to_db-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Twitter_Session.df_to_db"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Twitter_Session.df_to_db-614"><a href="#Twitter_Session.df_to_db-614"><span class="linenos">614</span></a>    <span class="k">def</span> <span class="nf">df_to_db</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Twitter_Session.df_to_db-615"><a href="#Twitter_Session.df_to_db-615"><span class="linenos">615</span></a>
</span><span id="Twitter_Session.df_to_db-616"><a href="#Twitter_Session.df_to_db-616"><span class="linenos">616</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Twitter_Session.df_to_db-617"><a href="#Twitter_Session.df_to_db-617"><span class="linenos">617</span></a><span class="sd">        Write user&#39;s twitter data to a SQLite3 database using an SQLAlchemy engine.</span>
</span><span id="Twitter_Session.df_to_db-618"><a href="#Twitter_Session.df_to_db-618"><span class="linenos">618</span></a>
</span><span id="Twitter_Session.df_to_db-619"><a href="#Twitter_Session.df_to_db-619"><span class="linenos">619</span></a><span class="sd">        #### Parameters</span>
</span><span id="Twitter_Session.df_to_db-620"><a href="#Twitter_Session.df_to_db-620"><span class="linenos">620</span></a>
</span><span id="Twitter_Session.df_to_db-621"><a href="#Twitter_Session.df_to_db-621"><span class="linenos">621</span></a><span class="sd">            data : pandas.DataFrame - The DataFrame with user profile data, as formatted by get_user_profile().</span>
</span><span id="Twitter_Session.df_to_db-622"><a href="#Twitter_Session.df_to_db-622"><span class="linenos">622</span></a>
</span><span id="Twitter_Session.df_to_db-623"><a href="#Twitter_Session.df_to_db-623"><span class="linenos">623</span></a><span class="sd">            type : str - profile, tweets, following, query</span>
</span><span id="Twitter_Session.df_to_db-624"><a href="#Twitter_Session.df_to_db-624"><span class="linenos">624</span></a>
</span><span id="Twitter_Session.df_to_db-625"><a href="#Twitter_Session.df_to_db-625"><span class="linenos">625</span></a><span class="sd">            query_term : str - The term used in a get_string_query().</span>
</span><span id="Twitter_Session.df_to_db-626"><a href="#Twitter_Session.df_to_db-626"><span class="linenos">626</span></a>
</span><span id="Twitter_Session.df_to_db-627"><a href="#Twitter_Session.df_to_db-627"><span class="linenos">627</span></a><span class="sd">        #### Attributes</span>
</span><span id="Twitter_Session.df_to_db-628"><a href="#Twitter_Session.df_to_db-628"><span class="linenos">628</span></a>
</span><span id="Twitter_Session.df_to_db-629"><a href="#Twitter_Session.df_to_db-629"><span class="linenos">629</span></a><span class="sd">            id : str - The table id to be stored under. If type is profile, tweets, or following the id will be the user id of the profile. If a query, use &#39;x-transaction-id&#39; from the query response header.</span>
</span><span id="Twitter_Session.df_to_db-630"><a href="#Twitter_Session.df_to_db-630"><span class="linenos">630</span></a>
</span><span id="Twitter_Session.df_to_db-631"><a href="#Twitter_Session.df_to_db-631"><span class="linenos">631</span></a><span class="sd">        #### Example</span>
</span><span id="Twitter_Session.df_to_db-632"><a href="#Twitter_Session.df_to_db-632"><span class="linenos">632</span></a>
</span><span id="Twitter_Session.df_to_db-633"><a href="#Twitter_Session.df_to_db-633"><span class="linenos">633</span></a><span class="sd">            `t1 = Twitter_Session()`</span>
</span><span id="Twitter_Session.df_to_db-634"><a href="#Twitter_Session.df_to_db-634"><span class="linenos">634</span></a><span class="sd">            `t1.get_token_local(&#39;/home/user/keys.json&#39;)`</span>
</span><span id="Twitter_Session.df_to_db-635"><a href="#Twitter_Session.df_to_db-635"><span class="linenos">635</span></a><span class="sd">            `df = t1.get_user_profile(&#39;elonmusk&#39;)`</span>
</span><span id="Twitter_Session.df_to_db-636"><a href="#Twitter_Session.df_to_db-636"><span class="linenos">636</span></a><span class="sd">            `t1.df_to_db(user_id = df[&#39;id&#39;][0], data = df, type=&#39;profile&#39;)`</span>
</span><span id="Twitter_Session.df_to_db-637"><a href="#Twitter_Session.df_to_db-637"><span class="linenos">637</span></a><span class="sd">            `df2 = t1.get_user_tweets(user_id = df[&#39;id&#39;][0])`</span>
</span><span id="Twitter_Session.df_to_db-638"><a href="#Twitter_Session.df_to_db-638"><span class="linenos">638</span></a><span class="sd">            `t1.df_to_db(user_id = df[&#39;id&#39;][0], data = df2, type=&#39;tweets&#39;)`</span>
</span><span id="Twitter_Session.df_to_db-639"><a href="#Twitter_Session.df_to_db-639"><span class="linenos">639</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Twitter_Session.df_to_db-640"><a href="#Twitter_Session.df_to_db-640"><span class="linenos">640</span></a>
</span><span id="Twitter_Session.df_to_db-641"><a href="#Twitter_Session.df_to_db-641"><span class="linenos">641</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Twitter_Session.df_to_db-642"><a href="#Twitter_Session.df_to_db-642"><span class="linenos">642</span></a>
</span><span id="Twitter_Session.df_to_db-643"><a href="#Twitter_Session.df_to_db-643"><span class="linenos">643</span></a>            <span class="n">query_term</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;query_term&quot;</span><span class="p">]</span>
</span><span id="Twitter_Session.df_to_db-644"><a href="#Twitter_Session.df_to_db-644"><span class="linenos">644</span></a>
</span><span id="Twitter_Session.df_to_db-645"><a href="#Twitter_Session.df_to_db-645"><span class="linenos">645</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="Twitter_Session.df_to_db-646"><a href="#Twitter_Session.df_to_db-646"><span class="linenos">646</span></a>
</span><span id="Twitter_Session.df_to_db-647"><a href="#Twitter_Session.df_to_db-647"><span class="linenos">647</span></a>            <span class="n">query_term</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="Twitter_Session.df_to_db-648"><a href="#Twitter_Session.df_to_db-648"><span class="linenos">648</span></a>
</span><span id="Twitter_Session.df_to_db-649"><a href="#Twitter_Session.df_to_db-649"><span class="linenos">649</span></a>        <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;profile&quot;</span><span class="p">:</span>
</span><span id="Twitter_Session.df_to_db-650"><a href="#Twitter_Session.df_to_db-650"><span class="linenos">650</span></a>
</span><span id="Twitter_Session.df_to_db-651"><a href="#Twitter_Session.df_to_db-651"><span class="linenos">651</span></a>            <span class="n">engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sqlite:///data/</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">.db&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session.df_to_db-652"><a href="#Twitter_Session.df_to_db-652"><span class="linenos">652</span></a>
</span><span id="Twitter_Session.df_to_db-653"><a href="#Twitter_Session.df_to_db-653"><span class="linenos">653</span></a>            <span class="n">table_name</span> <span class="o">=</span> <span class="s2">&quot;profile&quot;</span>
</span><span id="Twitter_Session.df_to_db-654"><a href="#Twitter_Session.df_to_db-654"><span class="linenos">654</span></a>
</span><span id="Twitter_Session.df_to_db-655"><a href="#Twitter_Session.df_to_db-655"><span class="linenos">655</span></a>        <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;tweets&quot;</span><span class="p">:</span>
</span><span id="Twitter_Session.df_to_db-656"><a href="#Twitter_Session.df_to_db-656"><span class="linenos">656</span></a>
</span><span id="Twitter_Session.df_to_db-657"><a href="#Twitter_Session.df_to_db-657"><span class="linenos">657</span></a>            <span class="n">engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sqlite:///data/</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">.db&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session.df_to_db-658"><a href="#Twitter_Session.df_to_db-658"><span class="linenos">658</span></a>
</span><span id="Twitter_Session.df_to_db-659"><a href="#Twitter_Session.df_to_db-659"><span class="linenos">659</span></a>            <span class="n">table_name</span> <span class="o">=</span> <span class="s2">&quot;tweets&quot;</span>
</span><span id="Twitter_Session.df_to_db-660"><a href="#Twitter_Session.df_to_db-660"><span class="linenos">660</span></a>
</span><span id="Twitter_Session.df_to_db-661"><a href="#Twitter_Session.df_to_db-661"><span class="linenos">661</span></a>        <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;following&quot;</span><span class="p">:</span>
</span><span id="Twitter_Session.df_to_db-662"><a href="#Twitter_Session.df_to_db-662"><span class="linenos">662</span></a>
</span><span id="Twitter_Session.df_to_db-663"><a href="#Twitter_Session.df_to_db-663"><span class="linenos">663</span></a>            <span class="n">engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sqlite:///data/</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">.db&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session.df_to_db-664"><a href="#Twitter_Session.df_to_db-664"><span class="linenos">664</span></a>
</span><span id="Twitter_Session.df_to_db-665"><a href="#Twitter_Session.df_to_db-665"><span class="linenos">665</span></a>            <span class="n">table_name</span> <span class="o">=</span> <span class="s2">&quot;following&quot;</span>
</span><span id="Twitter_Session.df_to_db-666"><a href="#Twitter_Session.df_to_db-666"><span class="linenos">666</span></a>
</span><span id="Twitter_Session.df_to_db-667"><a href="#Twitter_Session.df_to_db-667"><span class="linenos">667</span></a>        <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;followers&quot;</span><span class="p">:</span>
</span><span id="Twitter_Session.df_to_db-668"><a href="#Twitter_Session.df_to_db-668"><span class="linenos">668</span></a>
</span><span id="Twitter_Session.df_to_db-669"><a href="#Twitter_Session.df_to_db-669"><span class="linenos">669</span></a>            <span class="n">engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sqlite:///data/</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">.db&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session.df_to_db-670"><a href="#Twitter_Session.df_to_db-670"><span class="linenos">670</span></a>
</span><span id="Twitter_Session.df_to_db-671"><a href="#Twitter_Session.df_to_db-671"><span class="linenos">671</span></a>            <span class="n">table_name</span> <span class="o">=</span> <span class="s2">&quot;followers&quot;</span>
</span><span id="Twitter_Session.df_to_db-672"><a href="#Twitter_Session.df_to_db-672"><span class="linenos">672</span></a>
</span><span id="Twitter_Session.df_to_db-673"><a href="#Twitter_Session.df_to_db-673"><span class="linenos">673</span></a>        <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;query&quot;</span><span class="p">:</span>
</span><span id="Twitter_Session.df_to_db-674"><a href="#Twitter_Session.df_to_db-674"><span class="linenos">674</span></a>
</span><span id="Twitter_Session.df_to_db-675"><a href="#Twitter_Session.df_to_db-675"><span class="linenos">675</span></a>            <span class="n">engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;sqlite:///data/twitter_queries.db&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session.df_to_db-676"><a href="#Twitter_Session.df_to_db-676"><span class="linenos">676</span></a>
</span><span id="Twitter_Session.df_to_db-677"><a href="#Twitter_Session.df_to_db-677"><span class="linenos">677</span></a>            <span class="n">table_name</span> <span class="o">=</span> <span class="nb">id</span>
</span><span id="Twitter_Session.df_to_db-678"><a href="#Twitter_Session.df_to_db-678"><span class="linenos">678</span></a>            <span class="sd">&quot;&quot;&quot;For queries, use self.response.headers[&#39;x-transaction-id&#39;]&quot;&quot;&quot;</span>
</span><span id="Twitter_Session.df_to_db-679"><a href="#Twitter_Session.df_to_db-679"><span class="linenos">679</span></a>
</span><span id="Twitter_Session.df_to_db-680"><a href="#Twitter_Session.df_to_db-680"><span class="linenos">680</span></a>            <span class="n">data</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;query_term&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">query_term</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))])</span>
</span><span id="Twitter_Session.df_to_db-681"><a href="#Twitter_Session.df_to_db-681"><span class="linenos">681</span></a>
</span><span id="Twitter_Session.df_to_db-682"><a href="#Twitter_Session.df_to_db-682"><span class="linenos">682</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Twitter_Session.df_to_db-683"><a href="#Twitter_Session.df_to_db-683"><span class="linenos">683</span></a>
</span><span id="Twitter_Session.df_to_db-684"><a href="#Twitter_Session.df_to_db-684"><span class="linenos">684</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;type must be one of: profile, tweets, following, query&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session.df_to_db-685"><a href="#Twitter_Session.df_to_db-685"><span class="linenos">685</span></a>
</span><span id="Twitter_Session.df_to_db-686"><a href="#Twitter_Session.df_to_db-686"><span class="linenos">686</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Twitter_Session.df_to_db-687"><a href="#Twitter_Session.df_to_db-687"><span class="linenos">687</span></a>
</span><span id="Twitter_Session.df_to_db-688"><a href="#Twitter_Session.df_to_db-688"><span class="linenos">688</span></a>            <span class="n">data</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span>
</span><span id="Twitter_Session.df_to_db-689"><a href="#Twitter_Session.df_to_db-689"><span class="linenos">689</span></a>                <span class="mi">0</span><span class="p">,</span>
</span><span id="Twitter_Session.df_to_db-690"><a href="#Twitter_Session.df_to_db-690"><span class="linenos">690</span></a>                <span class="s2">&quot;capture_timestamp&quot;</span><span class="p">,</span>
</span><span id="Twitter_Session.df_to_db-691"><a href="#Twitter_Session.df_to_db-691"><span class="linenos">691</span></a>                <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))],</span>
</span><span id="Twitter_Session.df_to_db-692"><a href="#Twitter_Session.df_to_db-692"><span class="linenos">692</span></a>            <span class="p">)</span>
</span><span id="Twitter_Session.df_to_db-693"><a href="#Twitter_Session.df_to_db-693"><span class="linenos">693</span></a>
</span><span id="Twitter_Session.df_to_db-694"><a href="#Twitter_Session.df_to_db-694"><span class="linenos">694</span></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>  <span class="c1"># work-around to avoid producing a Nonetype DataFrame</span>
</span><span id="Twitter_Session.df_to_db-695"><a href="#Twitter_Session.df_to_db-695"><span class="linenos">695</span></a>
</span><span id="Twitter_Session.df_to_db-696"><a href="#Twitter_Session.df_to_db-696"><span class="linenos">696</span></a>            <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="s2">&quot;capture_timestamp&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Twitter_Session.df_to_db-697"><a href="#Twitter_Session.df_to_db-697"><span class="linenos">697</span></a>
</span><span id="Twitter_Session.df_to_db-698"><a href="#Twitter_Session.df_to_db-698"><span class="linenos">698</span></a>            <span class="n">data</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span>
</span><span id="Twitter_Session.df_to_db-699"><a href="#Twitter_Session.df_to_db-699"><span class="linenos">699</span></a>                <span class="mi">0</span><span class="p">,</span>
</span><span id="Twitter_Session.df_to_db-700"><a href="#Twitter_Session.df_to_db-700"><span class="linenos">700</span></a>                <span class="s2">&quot;capture_timestamp&quot;</span><span class="p">,</span>
</span><span id="Twitter_Session.df_to_db-701"><a href="#Twitter_Session.df_to_db-701"><span class="linenos">701</span></a>                <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))],</span>
</span><span id="Twitter_Session.df_to_db-702"><a href="#Twitter_Session.df_to_db-702"><span class="linenos">702</span></a>            <span class="p">)</span>
</span><span id="Twitter_Session.df_to_db-703"><a href="#Twitter_Session.df_to_db-703"><span class="linenos">703</span></a>
</span><span id="Twitter_Session.df_to_db-704"><a href="#Twitter_Session.df_to_db-704"><span class="linenos">704</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;str&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session.df_to_db-705"><a href="#Twitter_Session.df_to_db-705"><span class="linenos">705</span></a>
</span><span id="Twitter_Session.df_to_db-706"><a href="#Twitter_Session.df_to_db-706"><span class="linenos">706</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
</span><span id="Twitter_Session.df_to_db-707"><a href="#Twitter_Session.df_to_db-707"><span class="linenos">707</span></a>
</span><span id="Twitter_Session.df_to_db-708"><a href="#Twitter_Session.df_to_db-708"><span class="linenos">708</span></a>        <span class="n">data</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">table_name</span><span class="p">),</span> <span class="n">con</span><span class="o">=</span><span class="n">engine</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s2">&quot;append&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Twitter_Session.df_to_db-709"><a href="#Twitter_Session.df_to_db-709"><span class="linenos">709</span></a>
</span><span id="Twitter_Session.df_to_db-710"><a href="#Twitter_Session.df_to_db-710"><span class="linenos">710</span></a>        <span class="n">engine</span><span class="o">.</span><span class="n">dispose</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Write user's twitter data to a SQLite3 database using an SQLAlchemy engine.</p>

<h4 id="parameters">Parameters</h4>

<pre><code>data : pandas.DataFrame - The DataFrame with user profile data, as formatted by get_user_profile().

type : str - profile, tweets, following, query

query_term : str - The term used in a get_string_query().
</code></pre>

<h4 id="attributes">Attributes</h4>

<pre><code>id : str - The table id to be stored under. If type is profile, tweets, or following the id will be the user id of the profile. If a query, use 'x-transaction-id' from the query response header.
</code></pre>

<h4 id="example">Example</h4>

<pre><code>`t1 = Twitter_Session()`
`t1.get_token_local('/home/user/keys.json')`
`df = t1.get_user_profile('elonmusk')`
`t1.df_to_db(user_id = df['id'][0], data = df, type='profile')`
`df2 = t1.get_user_tweets(user_id = df['id'][0])`
`t1.df_to_db(user_id = df['id'][0], data = df2, type='tweets')`
</code></pre>
</div>


                            </div>
                            <div id="Twitter_Session.db_to_df" class="classattr">
                                        <input id="Twitter_Session.db_to_df-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">db_to_df</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="nb">id</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="nb">type</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span>:</span></span>

                <label class="view-source-button" for="Twitter_Session.db_to_df-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Twitter_Session.db_to_df"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Twitter_Session.db_to_df-712"><a href="#Twitter_Session.db_to_df-712"><span class="linenos">712</span></a>    <span class="k">def</span> <span class="nf">db_to_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="Twitter_Session.db_to_df-713"><a href="#Twitter_Session.db_to_df-713"><span class="linenos">713</span></a>
</span><span id="Twitter_Session.db_to_df-714"><a href="#Twitter_Session.db_to_df-714"><span class="linenos">714</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Twitter_Session.db_to_df-715"><a href="#Twitter_Session.db_to_df-715"><span class="linenos">715</span></a><span class="sd">        Read a user&#39;s data from a specified database into a pandas DataFrame.</span>
</span><span id="Twitter_Session.db_to_df-716"><a href="#Twitter_Session.db_to_df-716"><span class="linenos">716</span></a>
</span><span id="Twitter_Session.db_to_df-717"><a href="#Twitter_Session.db_to_df-717"><span class="linenos">717</span></a><span class="sd">        #### Paramters</span>
</span><span id="Twitter_Session.db_to_df-718"><a href="#Twitter_Session.db_to_df-718"><span class="linenos">718</span></a>
</span><span id="Twitter_Session.db_to_df-719"><a href="#Twitter_Session.db_to_df-719"><span class="linenos">719</span></a><span class="sd">            id : str - The user id of the profile. Can be referenced from the dataframe, or passed as string.</span>
</span><span id="Twitter_Session.db_to_df-720"><a href="#Twitter_Session.db_to_df-720"><span class="linenos">720</span></a>
</span><span id="Twitter_Session.db_to_df-721"><a href="#Twitter_Session.db_to_df-721"><span class="linenos">721</span></a><span class="sd">            type : str - profile, tweets, following</span>
</span><span id="Twitter_Session.db_to_df-722"><a href="#Twitter_Session.db_to_df-722"><span class="linenos">722</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Twitter_Session.db_to_df-723"><a href="#Twitter_Session.db_to_df-723"><span class="linenos">723</span></a>
</span><span id="Twitter_Session.db_to_df-724"><a href="#Twitter_Session.db_to_df-724"><span class="linenos">724</span></a>        <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;profile&quot;</span><span class="p">:</span>
</span><span id="Twitter_Session.db_to_df-725"><a href="#Twitter_Session.db_to_df-725"><span class="linenos">725</span></a>
</span><span id="Twitter_Session.db_to_df-726"><a href="#Twitter_Session.db_to_df-726"><span class="linenos">726</span></a>            <span class="n">engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sqlite:///data/</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">.db&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session.db_to_df-727"><a href="#Twitter_Session.db_to_df-727"><span class="linenos">727</span></a>
</span><span id="Twitter_Session.db_to_df-728"><a href="#Twitter_Session.db_to_df-728"><span class="linenos">728</span></a>            <span class="n">table_name</span> <span class="o">=</span> <span class="s2">&quot;profile&quot;</span>
</span><span id="Twitter_Session.db_to_df-729"><a href="#Twitter_Session.db_to_df-729"><span class="linenos">729</span></a>
</span><span id="Twitter_Session.db_to_df-730"><a href="#Twitter_Session.db_to_df-730"><span class="linenos">730</span></a>        <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;tweets&quot;</span><span class="p">:</span>
</span><span id="Twitter_Session.db_to_df-731"><a href="#Twitter_Session.db_to_df-731"><span class="linenos">731</span></a>
</span><span id="Twitter_Session.db_to_df-732"><a href="#Twitter_Session.db_to_df-732"><span class="linenos">732</span></a>            <span class="n">engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sqlite:///data/</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">.db&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session.db_to_df-733"><a href="#Twitter_Session.db_to_df-733"><span class="linenos">733</span></a>
</span><span id="Twitter_Session.db_to_df-734"><a href="#Twitter_Session.db_to_df-734"><span class="linenos">734</span></a>            <span class="n">table_name</span> <span class="o">=</span> <span class="s2">&quot;tweets&quot;</span>
</span><span id="Twitter_Session.db_to_df-735"><a href="#Twitter_Session.db_to_df-735"><span class="linenos">735</span></a>
</span><span id="Twitter_Session.db_to_df-736"><a href="#Twitter_Session.db_to_df-736"><span class="linenos">736</span></a>        <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;following&quot;</span><span class="p">:</span>
</span><span id="Twitter_Session.db_to_df-737"><a href="#Twitter_Session.db_to_df-737"><span class="linenos">737</span></a>
</span><span id="Twitter_Session.db_to_df-738"><a href="#Twitter_Session.db_to_df-738"><span class="linenos">738</span></a>            <span class="n">engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sqlite:///data/</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">.db&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session.db_to_df-739"><a href="#Twitter_Session.db_to_df-739"><span class="linenos">739</span></a>
</span><span id="Twitter_Session.db_to_df-740"><a href="#Twitter_Session.db_to_df-740"><span class="linenos">740</span></a>            <span class="n">table_name</span> <span class="o">=</span> <span class="s2">&quot;following&quot;</span>
</span><span id="Twitter_Session.db_to_df-741"><a href="#Twitter_Session.db_to_df-741"><span class="linenos">741</span></a>
</span><span id="Twitter_Session.db_to_df-742"><a href="#Twitter_Session.db_to_df-742"><span class="linenos">742</span></a>        <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;followers&quot;</span><span class="p">:</span>
</span><span id="Twitter_Session.db_to_df-743"><a href="#Twitter_Session.db_to_df-743"><span class="linenos">743</span></a>
</span><span id="Twitter_Session.db_to_df-744"><a href="#Twitter_Session.db_to_df-744"><span class="linenos">744</span></a>            <span class="n">engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sqlite:///data/</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">.db&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session.db_to_df-745"><a href="#Twitter_Session.db_to_df-745"><span class="linenos">745</span></a>
</span><span id="Twitter_Session.db_to_df-746"><a href="#Twitter_Session.db_to_df-746"><span class="linenos">746</span></a>            <span class="n">table_name</span> <span class="o">=</span> <span class="s2">&quot;followers&quot;</span>
</span><span id="Twitter_Session.db_to_df-747"><a href="#Twitter_Session.db_to_df-747"><span class="linenos">747</span></a>
</span><span id="Twitter_Session.db_to_df-748"><a href="#Twitter_Session.db_to_df-748"><span class="linenos">748</span></a>        <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;query&quot;</span><span class="p">:</span>
</span><span id="Twitter_Session.db_to_df-749"><a href="#Twitter_Session.db_to_df-749"><span class="linenos">749</span></a>
</span><span id="Twitter_Session.db_to_df-750"><a href="#Twitter_Session.db_to_df-750"><span class="linenos">750</span></a>            <span class="n">engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;sqlite:///data/twitter_queries.db&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session.db_to_df-751"><a href="#Twitter_Session.db_to_df-751"><span class="linenos">751</span></a>
</span><span id="Twitter_Session.db_to_df-752"><a href="#Twitter_Session.db_to_df-752"><span class="linenos">752</span></a>            <span class="n">table_name</span> <span class="o">=</span> <span class="nb">id</span>
</span><span id="Twitter_Session.db_to_df-753"><a href="#Twitter_Session.db_to_df-753"><span class="linenos">753</span></a>            <span class="sd">&quot;&quot;&quot;For queries, use self.response.headers[&#39;x-transaction-id&#39;]&quot;&quot;&quot;</span>
</span><span id="Twitter_Session.db_to_df-754"><a href="#Twitter_Session.db_to_df-754"><span class="linenos">754</span></a>
</span><span id="Twitter_Session.db_to_df-755"><a href="#Twitter_Session.db_to_df-755"><span class="linenos">755</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Twitter_Session.db_to_df-756"><a href="#Twitter_Session.db_to_df-756"><span class="linenos">756</span></a>
</span><span id="Twitter_Session.db_to_df-757"><a href="#Twitter_Session.db_to_df-757"><span class="linenos">757</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;type must be one of: profile, tweets, following, query&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session.db_to_df-758"><a href="#Twitter_Session.db_to_df-758"><span class="linenos">758</span></a>
</span><span id="Twitter_Session.db_to_df-759"><a href="#Twitter_Session.db_to_df-759"><span class="linenos">759</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_sql_table</span><span class="p">(</span><span class="n">table_name</span><span class="o">=</span><span class="n">table_name</span><span class="p">,</span> <span class="n">con</span><span class="o">=</span><span class="n">engine</span><span class="p">)</span>
</span><span id="Twitter_Session.db_to_df-760"><a href="#Twitter_Session.db_to_df-760"><span class="linenos">760</span></a>
</span><span id="Twitter_Session.db_to_df-761"><a href="#Twitter_Session.db_to_df-761"><span class="linenos">761</span></a>        <span class="n">engine</span><span class="o">.</span><span class="n">dispose</span><span class="p">()</span>
</span><span id="Twitter_Session.db_to_df-762"><a href="#Twitter_Session.db_to_df-762"><span class="linenos">762</span></a>
</span><span id="Twitter_Session.db_to_df-763"><a href="#Twitter_Session.db_to_df-763"><span class="linenos">763</span></a>        <span class="k">return</span> <span class="n">df</span>
</span></pre></div>


            <div class="docstring"><p>Read a user's data from a specified database into a pandas DataFrame.</p>

<h4 id="paramters">Paramters</h4>

<pre><code>id : str - The user id of the profile. Can be referenced from the dataframe, or passed as string.

type : str - profile, tweets, following
</code></pre>
</div>


                            </div>
                            <div id="Twitter_Session.get_dbs" class="classattr">
                                        <input id="Twitter_Session.get_dbs-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_dbs</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Twitter_Session.get_dbs-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Twitter_Session.get_dbs"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Twitter_Session.get_dbs-765"><a href="#Twitter_Session.get_dbs-765"><span class="linenos">765</span></a>    <span class="k">def</span> <span class="nf">get_dbs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Twitter_Session.get_dbs-766"><a href="#Twitter_Session.get_dbs-766"><span class="linenos">766</span></a>
</span><span id="Twitter_Session.get_dbs-767"><a href="#Twitter_Session.get_dbs-767"><span class="linenos">767</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Twitter_Session.get_dbs-768"><a href="#Twitter_Session.get_dbs-768"><span class="linenos">768</span></a><span class="sd">        Retrieve Twitter databases. Uses regex to check file names for an expected convention.</span>
</span><span id="Twitter_Session.get_dbs-769"><a href="#Twitter_Session.get_dbs-769"><span class="linenos">769</span></a>
</span><span id="Twitter_Session.get_dbs-770"><a href="#Twitter_Session.get_dbs-770"><span class="linenos">770</span></a><span class="sd">        This will be deprecated by class Database_Functions.</span>
</span><span id="Twitter_Session.get_dbs-771"><a href="#Twitter_Session.get_dbs-771"><span class="linenos">771</span></a>
</span><span id="Twitter_Session.get_dbs-772"><a href="#Twitter_Session.get_dbs-772"><span class="linenos">772</span></a><span class="sd">        Returns</span>
</span><span id="Twitter_Session.get_dbs-773"><a href="#Twitter_Session.get_dbs-773"><span class="linenos">773</span></a>
</span><span id="Twitter_Session.get_dbs-774"><a href="#Twitter_Session.get_dbs-774"><span class="linenos">774</span></a><span class="sd">            A list of database files by user id.</span>
</span><span id="Twitter_Session.get_dbs-775"><a href="#Twitter_Session.get_dbs-775"><span class="linenos">775</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Twitter_Session.get_dbs-776"><a href="#Twitter_Session.get_dbs-776"><span class="linenos">776</span></a>
</span><span id="Twitter_Session.get_dbs-777"><a href="#Twitter_Session.get_dbs-777"><span class="linenos">777</span></a>        <span class="n">files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;data/*.db&quot;</span><span class="p">)</span>
</span><span id="Twitter_Session.get_dbs-778"><a href="#Twitter_Session.get_dbs-778"><span class="linenos">778</span></a>
</span><span id="Twitter_Session.get_dbs-779"><a href="#Twitter_Session.get_dbs-779"><span class="linenos">779</span></a>        <span class="n">l</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="Twitter_Session.get_dbs-780"><a href="#Twitter_Session.get_dbs-780"><span class="linenos">780</span></a>            <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(\d+.db)&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">files</span>
</span><span id="Twitter_Session.get_dbs-781"><a href="#Twitter_Session.get_dbs-781"><span class="linenos">781</span></a>        <span class="p">]</span>  <span class="c1"># regex for any files consisting of [0-9].db</span>
</span><span id="Twitter_Session.get_dbs-782"><a href="#Twitter_Session.get_dbs-782"><span class="linenos">782</span></a>
</span><span id="Twitter_Session.get_dbs-783"><a href="#Twitter_Session.get_dbs-783"><span class="linenos">783</span></a>        <span class="n">processed_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">l</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
</span><span id="Twitter_Session.get_dbs-784"><a href="#Twitter_Session.get_dbs-784"><span class="linenos">784</span></a>
</span><span id="Twitter_Session.get_dbs-785"><a href="#Twitter_Session.get_dbs-785"><span class="linenos">785</span></a>        <span class="k">return</span> <span class="n">processed_list</span>
</span></pre></div>


            <div class="docstring"><p>Retrieve Twitter databases. Uses regex to check file names for an expected convention.</p>

<p>This will be deprecated by class Database_Functions.</p>

<p>Returns</p>

<pre><code>A list of database files by user id.
</code></pre>
</div>


                            </div>
                </section>
                <section id="Database_Functions">
                            <input id="Database_Functions-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@dataclass</div>

    <span class="def">class</span>
    <span class="name">Database_Functions</span>:

                <label class="view-source-button" for="Database_Functions-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Database_Functions"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Database_Functions-788"><a href="#Database_Functions-788"><span class="linenos">788</span></a><span class="nd">@dataclass</span>
</span><span id="Database_Functions-789"><a href="#Database_Functions-789"><span class="linenos">789</span></a><span class="k">class</span> <span class="nc">Database_Functions</span><span class="p">:</span>
</span><span id="Database_Functions-790"><a href="#Database_Functions-790"><span class="linenos">790</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Database_Functions-791"><a href="#Database_Functions-791"><span class="linenos">791</span></a>
</span><span id="Database_Functions-792"><a href="#Database_Functions-792"><span class="linenos">792</span></a>        <span class="sd">&quot;&quot;&quot;Database functions.&quot;&quot;&quot;</span>
</span><span id="Database_Functions-793"><a href="#Database_Functions-793"><span class="linenos">793</span></a>
</span><span id="Database_Functions-794"><a href="#Database_Functions-794"><span class="linenos">794</span></a>    <span class="k">def</span> <span class="nf">list_db_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Database_Functions-795"><a href="#Database_Functions-795"><span class="linenos">795</span></a>
</span><span id="Database_Functions-796"><a href="#Database_Functions-796"><span class="linenos">796</span></a>        <span class="n">files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;data/*.db&quot;</span><span class="p">)</span>
</span><span id="Database_Functions-797"><a href="#Database_Functions-797"><span class="linenos">797</span></a>
</span><span id="Database_Functions-798"><a href="#Database_Functions-798"><span class="linenos">798</span></a>        <span class="n">list_keys</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Database_Functions-799"><a href="#Database_Functions-799"><span class="linenos">799</span></a>
</span><span id="Database_Functions-800"><a href="#Database_Functions-800"><span class="linenos">800</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
</span><span id="Database_Functions-801"><a href="#Database_Functions-801"><span class="linenos">801</span></a>
</span><span id="Database_Functions-802"><a href="#Database_Functions-802"><span class="linenos">802</span></a>            <span class="n">engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span>
</span><span id="Database_Functions-803"><a href="#Database_Functions-803"><span class="linenos">803</span></a>                <span class="sa">f</span><span class="s2">&quot;sqlite+pysqlite:///</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">future</span><span class="o">=</span><span class="kc">True</span>
</span><span id="Database_Functions-804"><a href="#Database_Functions-804"><span class="linenos">804</span></a>            <span class="p">)</span>
</span><span id="Database_Functions-805"><a href="#Database_Functions-805"><span class="linenos">805</span></a>
</span><span id="Database_Functions-806"><a href="#Database_Functions-806"><span class="linenos">806</span></a>            <span class="n">s</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">MetaData</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="n">engine</span><span class="p">)</span>
</span><span id="Database_Functions-807"><a href="#Database_Functions-807"><span class="linenos">807</span></a>
</span><span id="Database_Functions-808"><a href="#Database_Functions-808"><span class="linenos">808</span></a>            <span class="n">s</span><span class="o">.</span><span class="n">reflect</span><span class="p">()</span>
</span><span id="Database_Functions-809"><a href="#Database_Functions-809"><span class="linenos">809</span></a>
</span><span id="Database_Functions-810"><a href="#Database_Functions-810"><span class="linenos">810</span></a>            <span class="n">list_keys</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">s</span><span class="o">.</span><span class="n">tables</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">i</span><span class="p">))</span>
</span><span id="Database_Functions-811"><a href="#Database_Functions-811"><span class="linenos">811</span></a>
</span><span id="Database_Functions-812"><a href="#Database_Functions-812"><span class="linenos">812</span></a>        <span class="k">return</span> <span class="n">list_keys</span>
</span><span id="Database_Functions-813"><a href="#Database_Functions-813"><span class="linenos">813</span></a>
</span><span id="Database_Functions-814"><a href="#Database_Functions-814"><span class="linenos">814</span></a>    <span class="k">def</span> <span class="nf">list_db_tables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db</span><span class="p">):</span>
</span><span id="Database_Functions-815"><a href="#Database_Functions-815"><span class="linenos">815</span></a>
</span><span id="Database_Functions-816"><a href="#Database_Functions-816"><span class="linenos">816</span></a>        <span class="n">engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span>
</span><span id="Database_Functions-817"><a href="#Database_Functions-817"><span class="linenos">817</span></a>            <span class="sa">f</span><span class="s2">&quot;sqlite+pysqlite:///</span><span class="si">{</span><span class="n">db</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">future</span><span class="o">=</span><span class="kc">True</span>
</span><span id="Database_Functions-818"><a href="#Database_Functions-818"><span class="linenos">818</span></a>        <span class="p">)</span>
</span><span id="Database_Functions-819"><a href="#Database_Functions-819"><span class="linenos">819</span></a>
</span><span id="Database_Functions-820"><a href="#Database_Functions-820"><span class="linenos">820</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">MetaData</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="n">engine</span><span class="p">)</span>
</span><span id="Database_Functions-821"><a href="#Database_Functions-821"><span class="linenos">821</span></a>
</span><span id="Database_Functions-822"><a href="#Database_Functions-822"><span class="linenos">822</span></a>        <span class="n">s</span><span class="o">.</span><span class="n">reflect</span><span class="p">()</span>
</span><span id="Database_Functions-823"><a href="#Database_Functions-823"><span class="linenos">823</span></a>
</span><span id="Database_Functions-824"><a href="#Database_Functions-824"><span class="linenos">824</span></a>        <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">tables</span>
</span></pre></div>


    

                            <div id="Database_Functions.__init__" class="classattr">
                                        <input id="Database_Functions.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Database_Functions</span><span class="signature pdoc-code condensed">()</span>

                <label class="view-source-button" for="Database_Functions.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Database_Functions.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Database_Functions.__init__-790"><a href="#Database_Functions.__init__-790"><span class="linenos">790</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Database_Functions.__init__-791"><a href="#Database_Functions.__init__-791"><span class="linenos">791</span></a>
</span><span id="Database_Functions.__init__-792"><a href="#Database_Functions.__init__-792"><span class="linenos">792</span></a>        <span class="sd">&quot;&quot;&quot;Database functions.&quot;&quot;&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Database functions.</p>
</div>


                            </div>
                            <div id="Database_Functions.list_db_keys" class="classattr">
                                        <input id="Database_Functions.list_db_keys-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">list_db_keys</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Database_Functions.list_db_keys-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Database_Functions.list_db_keys"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Database_Functions.list_db_keys-794"><a href="#Database_Functions.list_db_keys-794"><span class="linenos">794</span></a>    <span class="k">def</span> <span class="nf">list_db_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Database_Functions.list_db_keys-795"><a href="#Database_Functions.list_db_keys-795"><span class="linenos">795</span></a>
</span><span id="Database_Functions.list_db_keys-796"><a href="#Database_Functions.list_db_keys-796"><span class="linenos">796</span></a>        <span class="n">files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;data/*.db&quot;</span><span class="p">)</span>
</span><span id="Database_Functions.list_db_keys-797"><a href="#Database_Functions.list_db_keys-797"><span class="linenos">797</span></a>
</span><span id="Database_Functions.list_db_keys-798"><a href="#Database_Functions.list_db_keys-798"><span class="linenos">798</span></a>        <span class="n">list_keys</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Database_Functions.list_db_keys-799"><a href="#Database_Functions.list_db_keys-799"><span class="linenos">799</span></a>
</span><span id="Database_Functions.list_db_keys-800"><a href="#Database_Functions.list_db_keys-800"><span class="linenos">800</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
</span><span id="Database_Functions.list_db_keys-801"><a href="#Database_Functions.list_db_keys-801"><span class="linenos">801</span></a>
</span><span id="Database_Functions.list_db_keys-802"><a href="#Database_Functions.list_db_keys-802"><span class="linenos">802</span></a>            <span class="n">engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span>
</span><span id="Database_Functions.list_db_keys-803"><a href="#Database_Functions.list_db_keys-803"><span class="linenos">803</span></a>                <span class="sa">f</span><span class="s2">&quot;sqlite+pysqlite:///</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">future</span><span class="o">=</span><span class="kc">True</span>
</span><span id="Database_Functions.list_db_keys-804"><a href="#Database_Functions.list_db_keys-804"><span class="linenos">804</span></a>            <span class="p">)</span>
</span><span id="Database_Functions.list_db_keys-805"><a href="#Database_Functions.list_db_keys-805"><span class="linenos">805</span></a>
</span><span id="Database_Functions.list_db_keys-806"><a href="#Database_Functions.list_db_keys-806"><span class="linenos">806</span></a>            <span class="n">s</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">MetaData</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="n">engine</span><span class="p">)</span>
</span><span id="Database_Functions.list_db_keys-807"><a href="#Database_Functions.list_db_keys-807"><span class="linenos">807</span></a>
</span><span id="Database_Functions.list_db_keys-808"><a href="#Database_Functions.list_db_keys-808"><span class="linenos">808</span></a>            <span class="n">s</span><span class="o">.</span><span class="n">reflect</span><span class="p">()</span>
</span><span id="Database_Functions.list_db_keys-809"><a href="#Database_Functions.list_db_keys-809"><span class="linenos">809</span></a>
</span><span id="Database_Functions.list_db_keys-810"><a href="#Database_Functions.list_db_keys-810"><span class="linenos">810</span></a>            <span class="n">list_keys</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">s</span><span class="o">.</span><span class="n">tables</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">i</span><span class="p">))</span>
</span><span id="Database_Functions.list_db_keys-811"><a href="#Database_Functions.list_db_keys-811"><span class="linenos">811</span></a>
</span><span id="Database_Functions.list_db_keys-812"><a href="#Database_Functions.list_db_keys-812"><span class="linenos">812</span></a>        <span class="k">return</span> <span class="n">list_keys</span>
</span></pre></div>


    

                            </div>
                            <div id="Database_Functions.list_db_tables" class="classattr">
                                        <input id="Database_Functions.list_db_tables-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">list_db_tables</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">db</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Database_Functions.list_db_tables-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Database_Functions.list_db_tables"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Database_Functions.list_db_tables-814"><a href="#Database_Functions.list_db_tables-814"><span class="linenos">814</span></a>    <span class="k">def</span> <span class="nf">list_db_tables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db</span><span class="p">):</span>
</span><span id="Database_Functions.list_db_tables-815"><a href="#Database_Functions.list_db_tables-815"><span class="linenos">815</span></a>
</span><span id="Database_Functions.list_db_tables-816"><a href="#Database_Functions.list_db_tables-816"><span class="linenos">816</span></a>        <span class="n">engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span>
</span><span id="Database_Functions.list_db_tables-817"><a href="#Database_Functions.list_db_tables-817"><span class="linenos">817</span></a>            <span class="sa">f</span><span class="s2">&quot;sqlite+pysqlite:///</span><span class="si">{</span><span class="n">db</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">future</span><span class="o">=</span><span class="kc">True</span>
</span><span id="Database_Functions.list_db_tables-818"><a href="#Database_Functions.list_db_tables-818"><span class="linenos">818</span></a>        <span class="p">)</span>
</span><span id="Database_Functions.list_db_tables-819"><a href="#Database_Functions.list_db_tables-819"><span class="linenos">819</span></a>
</span><span id="Database_Functions.list_db_tables-820"><a href="#Database_Functions.list_db_tables-820"><span class="linenos">820</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">MetaData</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="n">engine</span><span class="p">)</span>
</span><span id="Database_Functions.list_db_tables-821"><a href="#Database_Functions.list_db_tables-821"><span class="linenos">821</span></a>
</span><span id="Database_Functions.list_db_tables-822"><a href="#Database_Functions.list_db_tables-822"><span class="linenos">822</span></a>        <span class="n">s</span><span class="o">.</span><span class="n">reflect</span><span class="p">()</span>
</span><span id="Database_Functions.list_db_tables-823"><a href="#Database_Functions.list_db_tables-823"><span class="linenos">823</span></a>
</span><span id="Database_Functions.list_db_tables-824"><a href="#Database_Functions.list_db_tables-824"><span class="linenos">824</span></a>        <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">tables</span>
</span></pre></div>


    

                            </div>
                </section>
                <section id="Streamlit_Functions">
                            <input id="Streamlit_Functions-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Streamlit_Functions</span>:

                <label class="view-source-button" for="Streamlit_Functions-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Streamlit_Functions"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Streamlit_Functions-827"><a href="#Streamlit_Functions-827"><span class="linenos">827</span></a><span class="k">class</span> <span class="nc">Streamlit_Functions</span><span class="p">:</span>
</span><span id="Streamlit_Functions-828"><a href="#Streamlit_Functions-828"><span class="linenos">828</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Streamlit_Functions-829"><a href="#Streamlit_Functions-829"><span class="linenos">829</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Streamlit_Functions-830"><a href="#Streamlit_Functions-830"><span class="linenos">830</span></a><span class="sd">        A class for Streamlit utilities.</span>
</span><span id="Streamlit_Functions-831"><a href="#Streamlit_Functions-831"><span class="linenos">831</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Streamlit_Functions-832"><a href="#Streamlit_Functions-832"><span class="linenos">832</span></a>
</span><span id="Streamlit_Functions-833"><a href="#Streamlit_Functions-833"><span class="linenos">833</span></a>    <span class="k">def</span> <span class="nf">set_boilerplate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Streamlit_Functions-834"><a href="#Streamlit_Functions-834"><span class="linenos">834</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Streamlit_Functions-835"><a href="#Streamlit_Functions-835"><span class="linenos">835</span></a><span class="sd">        Boilerplate setup for a Streamlit page.</span>
</span><span id="Streamlit_Functions-836"><a href="#Streamlit_Functions-836"><span class="linenos">836</span></a>
</span><span id="Streamlit_Functions-837"><a href="#Streamlit_Functions-837"><span class="linenos">837</span></a><span class="sd">        Parameters</span>
</span><span id="Streamlit_Functions-838"><a href="#Streamlit_Functions-838"><span class="linenos">838</span></a>
</span><span id="Streamlit_Functions-839"><a href="#Streamlit_Functions-839"><span class="linenos">839</span></a><span class="sd">            page_title : str - The title bar page name.</span>
</span><span id="Streamlit_Functions-840"><a href="#Streamlit_Functions-840"><span class="linenos">840</span></a>
</span><span id="Streamlit_Functions-841"><a href="#Streamlit_Functions-841"><span class="linenos">841</span></a><span class="sd">            scroll_text : str - The text to scroll when the page loads.</span>
</span><span id="Streamlit_Functions-842"><a href="#Streamlit_Functions-842"><span class="linenos">842</span></a>
</span><span id="Streamlit_Functions-843"><a href="#Streamlit_Functions-843"><span class="linenos">843</span></a><span class="sd">            metrics : bool - Show the metrics during operations, in expanders.</span>
</span><span id="Streamlit_Functions-844"><a href="#Streamlit_Functions-844"><span class="linenos">844</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Streamlit_Functions-845"><a href="#Streamlit_Functions-845"><span class="linenos">845</span></a>
</span><span id="Streamlit_Functions-846"><a href="#Streamlit_Functions-846"><span class="linenos">846</span></a>        <span class="k">if</span> <span class="s2">&quot;page_title&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="Streamlit_Functions-847"><a href="#Streamlit_Functions-847"><span class="linenos">847</span></a>
</span><span id="Streamlit_Functions-848"><a href="#Streamlit_Functions-848"><span class="linenos">848</span></a>            <span class="n">page_title</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;page_title&quot;</span><span class="p">])</span>
</span><span id="Streamlit_Functions-849"><a href="#Streamlit_Functions-849"><span class="linenos">849</span></a>
</span><span id="Streamlit_Functions-850"><a href="#Streamlit_Functions-850"><span class="linenos">850</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Streamlit_Functions-851"><a href="#Streamlit_Functions-851"><span class="linenos">851</span></a>
</span><span id="Streamlit_Functions-852"><a href="#Streamlit_Functions-852"><span class="linenos">852</span></a>            <span class="n">page_title</span> <span class="o">=</span> <span class="s2">&quot;solarcho3/Web Tools&quot;</span>
</span><span id="Streamlit_Functions-853"><a href="#Streamlit_Functions-853"><span class="linenos">853</span></a>
</span><span id="Streamlit_Functions-854"><a href="#Streamlit_Functions-854"><span class="linenos">854</span></a>        <span class="n">scroll_text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="Streamlit_Functions-855"><a href="#Streamlit_Functions-855"><span class="linenos">855</span></a>
</span><span id="Streamlit_Functions-856"><a href="#Streamlit_Functions-856"><span class="linenos">856</span></a>        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;scroll_text&quot;</span><span class="p">):</span>
</span><span id="Streamlit_Functions-857"><a href="#Streamlit_Functions-857"><span class="linenos">857</span></a>
</span><span id="Streamlit_Functions-858"><a href="#Streamlit_Functions-858"><span class="linenos">858</span></a>            <span class="n">scroll_text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;scroll_text&quot;</span><span class="p">])</span>
</span><span id="Streamlit_Functions-859"><a href="#Streamlit_Functions-859"><span class="linenos">859</span></a>
</span><span id="Streamlit_Functions-860"><a href="#Streamlit_Functions-860"><span class="linenos">860</span></a>        <span class="kn">import</span> <span class="nn">streamlit</span> <span class="k">as</span> <span class="nn">st</span>
</span><span id="Streamlit_Functions-861"><a href="#Streamlit_Functions-861"><span class="linenos">861</span></a>
</span><span id="Streamlit_Functions-862"><a href="#Streamlit_Functions-862"><span class="linenos">862</span></a>        <span class="n">st</span><span class="o">.</span><span class="n">set_page_config</span><span class="p">(</span><span class="n">page_title</span><span class="o">=</span><span class="n">page_title</span><span class="p">,</span> <span class="n">page_icon</span><span class="o">=</span><span class="s2">&quot;:wrench:&quot;</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;wide&quot;</span><span class="p">)</span>
</span><span id="Streamlit_Functions-863"><a href="#Streamlit_Functions-863"><span class="linenos">863</span></a>
</span><span id="Streamlit_Functions-864"><a href="#Streamlit_Functions-864"><span class="linenos">864</span></a>        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;metrics&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="Streamlit_Functions-865"><a href="#Streamlit_Functions-865"><span class="linenos">865</span></a>
</span><span id="Streamlit_Functions-866"><a href="#Streamlit_Functions-866"><span class="linenos">866</span></a>            <span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">expander</span><span class="p">(</span><span class="s2">&quot;🌡️ Twitter API-server rate limit metrics&quot;</span><span class="p">):</span>
</span><span id="Streamlit_Functions-867"><a href="#Streamlit_Functions-867"><span class="linenos">867</span></a>
</span><span id="Streamlit_Functions-868"><a href="#Streamlit_Functions-868"><span class="linenos">868</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">metrics_col1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">metrics_col2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">metrics_col3</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">columns</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="Streamlit_Functions-869"><a href="#Streamlit_Functions-869"><span class="linenos">869</span></a>
</span><span id="Streamlit_Functions-870"><a href="#Streamlit_Functions-870"><span class="linenos">870</span></a>            <span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">expander</span><span class="p">(</span><span class="s2">&quot;📻 Traffic log&quot;</span><span class="p">):</span>
</span><span id="Streamlit_Functions-871"><a href="#Streamlit_Functions-871"><span class="linenos">871</span></a>
</span><span id="Streamlit_Functions-872"><a href="#Streamlit_Functions-872"><span class="linenos">872</span></a>                <span class="n">traffic</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">columns</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Streamlit_Functions-873"><a href="#Streamlit_Functions-873"><span class="linenos">873</span></a>
</span><span id="Streamlit_Functions-874"><a href="#Streamlit_Functions-874"><span class="linenos">874</span></a>        <span class="n">scroll_container</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">empty</span><span class="p">()</span>
</span><span id="Streamlit_Functions-875"><a href="#Streamlit_Functions-875"><span class="linenos">875</span></a>
</span><span id="Streamlit_Functions-876"><a href="#Streamlit_Functions-876"><span class="linenos">876</span></a>        <span class="n">store</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="Streamlit_Functions-877"><a href="#Streamlit_Functions-877"><span class="linenos">877</span></a>
</span><span id="Streamlit_Functions-878"><a href="#Streamlit_Functions-878"><span class="linenos">878</span></a>        <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">scroll_text</span><span class="p">:</span>
</span><span id="Streamlit_Functions-879"><a href="#Streamlit_Functions-879"><span class="linenos">879</span></a>
</span><span id="Streamlit_Functions-880"><a href="#Streamlit_Functions-880"><span class="linenos">880</span></a>            <span class="n">store</span> <span class="o">=</span> <span class="n">store</span> <span class="o">+</span> <span class="n">char</span>
</span><span id="Streamlit_Functions-881"><a href="#Streamlit_Functions-881"><span class="linenos">881</span></a>
</span><span id="Streamlit_Functions-882"><a href="#Streamlit_Functions-882"><span class="linenos">882</span></a>            <span class="n">scroll_container</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">store</span><span class="p">)</span>
</span><span id="Streamlit_Functions-883"><a href="#Streamlit_Functions-883"><span class="linenos">883</span></a>
</span><span id="Streamlit_Functions-884"><a href="#Streamlit_Functions-884"><span class="linenos">884</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.005</span><span class="p">)</span>
</span><span id="Streamlit_Functions-885"><a href="#Streamlit_Functions-885"><span class="linenos">885</span></a>
</span><span id="Streamlit_Functions-886"><a href="#Streamlit_Functions-886"><span class="linenos">886</span></a>    <span class="k">def</span> <span class="nf">update_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span id="Streamlit_Functions-887"><a href="#Streamlit_Functions-887"><span class="linenos">887</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Streamlit_Functions-888"><a href="#Streamlit_Functions-888"><span class="linenos">888</span></a><span class="sd">        Update the boilerplate metrics.</span>
</span><span id="Streamlit_Functions-889"><a href="#Streamlit_Functions-889"><span class="linenos">889</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Streamlit_Functions-890"><a href="#Streamlit_Functions-890"><span class="linenos">890</span></a>
</span><span id="Streamlit_Functions-891"><a href="#Streamlit_Functions-891"><span class="linenos">891</span></a>        <span class="n">keys_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="Streamlit_Functions-892"><a href="#Streamlit_Functions-892"><span class="linenos">892</span></a>
</span><span id="Streamlit_Functions-893"><a href="#Streamlit_Functions-893"><span class="linenos">893</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metrics_col1</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span>
</span><span id="Streamlit_Functions-894"><a href="#Streamlit_Functions-894"><span class="linenos">894</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">keys_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> % remaining&quot;</span><span class="p">,</span>
</span><span id="Streamlit_Functions-895"><a href="#Streamlit_Functions-895"><span class="linenos">895</span></a>            <span class="n">data</span><span class="p">[</span><span class="n">keys_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s2">&quot;percent_remaining&quot;</span><span class="p">],</span>
</span><span id="Streamlit_Functions-896"><a href="#Streamlit_Functions-896"><span class="linenos">896</span></a>            <span class="nb">round</span><span class="p">((</span><span class="mi">1000</span> <span class="o">/</span> <span class="n">data</span><span class="p">[</span><span class="n">keys_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s2">&quot;remaining&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
</span><span id="Streamlit_Functions-897"><a href="#Streamlit_Functions-897"><span class="linenos">897</span></a>        <span class="p">)</span>
</span><span id="Streamlit_Functions-898"><a href="#Streamlit_Functions-898"><span class="linenos">898</span></a>
</span><span id="Streamlit_Functions-899"><a href="#Streamlit_Functions-899"><span class="linenos">899</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metrics_col2</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span>
</span><span id="Streamlit_Functions-900"><a href="#Streamlit_Functions-900"><span class="linenos">900</span></a>            <span class="n">keys_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">keys_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s2">&quot;limit&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">keys_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s2">&quot;remaining&quot;</span><span class="p">]</span>
</span><span id="Streamlit_Functions-901"><a href="#Streamlit_Functions-901"><span class="linenos">901</span></a>        <span class="p">)</span>
</span></pre></div>


    

                            <div id="Streamlit_Functions.__init__" class="classattr">
                                        <input id="Streamlit_Functions.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Streamlit_Functions</span><span class="signature pdoc-code condensed">()</span>

                <label class="view-source-button" for="Streamlit_Functions.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Streamlit_Functions.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Streamlit_Functions.__init__-828"><a href="#Streamlit_Functions.__init__-828"><span class="linenos">828</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Streamlit_Functions.__init__-829"><a href="#Streamlit_Functions.__init__-829"><span class="linenos">829</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Streamlit_Functions.__init__-830"><a href="#Streamlit_Functions.__init__-830"><span class="linenos">830</span></a><span class="sd">        A class for Streamlit utilities.</span>
</span><span id="Streamlit_Functions.__init__-831"><a href="#Streamlit_Functions.__init__-831"><span class="linenos">831</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span></pre></div>


            <div class="docstring"><p>A class for Streamlit utilities.</p>
</div>


                            </div>
                            <div id="Streamlit_Functions.set_boilerplate" class="classattr">
                                        <input id="Streamlit_Functions.set_boilerplate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_boilerplate</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Streamlit_Functions.set_boilerplate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Streamlit_Functions.set_boilerplate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Streamlit_Functions.set_boilerplate-833"><a href="#Streamlit_Functions.set_boilerplate-833"><span class="linenos">833</span></a>    <span class="k">def</span> <span class="nf">set_boilerplate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Streamlit_Functions.set_boilerplate-834"><a href="#Streamlit_Functions.set_boilerplate-834"><span class="linenos">834</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Streamlit_Functions.set_boilerplate-835"><a href="#Streamlit_Functions.set_boilerplate-835"><span class="linenos">835</span></a><span class="sd">        Boilerplate setup for a Streamlit page.</span>
</span><span id="Streamlit_Functions.set_boilerplate-836"><a href="#Streamlit_Functions.set_boilerplate-836"><span class="linenos">836</span></a>
</span><span id="Streamlit_Functions.set_boilerplate-837"><a href="#Streamlit_Functions.set_boilerplate-837"><span class="linenos">837</span></a><span class="sd">        Parameters</span>
</span><span id="Streamlit_Functions.set_boilerplate-838"><a href="#Streamlit_Functions.set_boilerplate-838"><span class="linenos">838</span></a>
</span><span id="Streamlit_Functions.set_boilerplate-839"><a href="#Streamlit_Functions.set_boilerplate-839"><span class="linenos">839</span></a><span class="sd">            page_title : str - The title bar page name.</span>
</span><span id="Streamlit_Functions.set_boilerplate-840"><a href="#Streamlit_Functions.set_boilerplate-840"><span class="linenos">840</span></a>
</span><span id="Streamlit_Functions.set_boilerplate-841"><a href="#Streamlit_Functions.set_boilerplate-841"><span class="linenos">841</span></a><span class="sd">            scroll_text : str - The text to scroll when the page loads.</span>
</span><span id="Streamlit_Functions.set_boilerplate-842"><a href="#Streamlit_Functions.set_boilerplate-842"><span class="linenos">842</span></a>
</span><span id="Streamlit_Functions.set_boilerplate-843"><a href="#Streamlit_Functions.set_boilerplate-843"><span class="linenos">843</span></a><span class="sd">            metrics : bool - Show the metrics during operations, in expanders.</span>
</span><span id="Streamlit_Functions.set_boilerplate-844"><a href="#Streamlit_Functions.set_boilerplate-844"><span class="linenos">844</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Streamlit_Functions.set_boilerplate-845"><a href="#Streamlit_Functions.set_boilerplate-845"><span class="linenos">845</span></a>
</span><span id="Streamlit_Functions.set_boilerplate-846"><a href="#Streamlit_Functions.set_boilerplate-846"><span class="linenos">846</span></a>        <span class="k">if</span> <span class="s2">&quot;page_title&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="Streamlit_Functions.set_boilerplate-847"><a href="#Streamlit_Functions.set_boilerplate-847"><span class="linenos">847</span></a>
</span><span id="Streamlit_Functions.set_boilerplate-848"><a href="#Streamlit_Functions.set_boilerplate-848"><span class="linenos">848</span></a>            <span class="n">page_title</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;page_title&quot;</span><span class="p">])</span>
</span><span id="Streamlit_Functions.set_boilerplate-849"><a href="#Streamlit_Functions.set_boilerplate-849"><span class="linenos">849</span></a>
</span><span id="Streamlit_Functions.set_boilerplate-850"><a href="#Streamlit_Functions.set_boilerplate-850"><span class="linenos">850</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Streamlit_Functions.set_boilerplate-851"><a href="#Streamlit_Functions.set_boilerplate-851"><span class="linenos">851</span></a>
</span><span id="Streamlit_Functions.set_boilerplate-852"><a href="#Streamlit_Functions.set_boilerplate-852"><span class="linenos">852</span></a>            <span class="n">page_title</span> <span class="o">=</span> <span class="s2">&quot;solarcho3/Web Tools&quot;</span>
</span><span id="Streamlit_Functions.set_boilerplate-853"><a href="#Streamlit_Functions.set_boilerplate-853"><span class="linenos">853</span></a>
</span><span id="Streamlit_Functions.set_boilerplate-854"><a href="#Streamlit_Functions.set_boilerplate-854"><span class="linenos">854</span></a>        <span class="n">scroll_text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="Streamlit_Functions.set_boilerplate-855"><a href="#Streamlit_Functions.set_boilerplate-855"><span class="linenos">855</span></a>
</span><span id="Streamlit_Functions.set_boilerplate-856"><a href="#Streamlit_Functions.set_boilerplate-856"><span class="linenos">856</span></a>        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;scroll_text&quot;</span><span class="p">):</span>
</span><span id="Streamlit_Functions.set_boilerplate-857"><a href="#Streamlit_Functions.set_boilerplate-857"><span class="linenos">857</span></a>
</span><span id="Streamlit_Functions.set_boilerplate-858"><a href="#Streamlit_Functions.set_boilerplate-858"><span class="linenos">858</span></a>            <span class="n">scroll_text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;scroll_text&quot;</span><span class="p">])</span>
</span><span id="Streamlit_Functions.set_boilerplate-859"><a href="#Streamlit_Functions.set_boilerplate-859"><span class="linenos">859</span></a>
</span><span id="Streamlit_Functions.set_boilerplate-860"><a href="#Streamlit_Functions.set_boilerplate-860"><span class="linenos">860</span></a>        <span class="kn">import</span> <span class="nn">streamlit</span> <span class="k">as</span> <span class="nn">st</span>
</span><span id="Streamlit_Functions.set_boilerplate-861"><a href="#Streamlit_Functions.set_boilerplate-861"><span class="linenos">861</span></a>
</span><span id="Streamlit_Functions.set_boilerplate-862"><a href="#Streamlit_Functions.set_boilerplate-862"><span class="linenos">862</span></a>        <span class="n">st</span><span class="o">.</span><span class="n">set_page_config</span><span class="p">(</span><span class="n">page_title</span><span class="o">=</span><span class="n">page_title</span><span class="p">,</span> <span class="n">page_icon</span><span class="o">=</span><span class="s2">&quot;:wrench:&quot;</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;wide&quot;</span><span class="p">)</span>
</span><span id="Streamlit_Functions.set_boilerplate-863"><a href="#Streamlit_Functions.set_boilerplate-863"><span class="linenos">863</span></a>
</span><span id="Streamlit_Functions.set_boilerplate-864"><a href="#Streamlit_Functions.set_boilerplate-864"><span class="linenos">864</span></a>        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;metrics&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="Streamlit_Functions.set_boilerplate-865"><a href="#Streamlit_Functions.set_boilerplate-865"><span class="linenos">865</span></a>
</span><span id="Streamlit_Functions.set_boilerplate-866"><a href="#Streamlit_Functions.set_boilerplate-866"><span class="linenos">866</span></a>            <span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">expander</span><span class="p">(</span><span class="s2">&quot;🌡️ Twitter API-server rate limit metrics&quot;</span><span class="p">):</span>
</span><span id="Streamlit_Functions.set_boilerplate-867"><a href="#Streamlit_Functions.set_boilerplate-867"><span class="linenos">867</span></a>
</span><span id="Streamlit_Functions.set_boilerplate-868"><a href="#Streamlit_Functions.set_boilerplate-868"><span class="linenos">868</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">metrics_col1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">metrics_col2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">metrics_col3</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">columns</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="Streamlit_Functions.set_boilerplate-869"><a href="#Streamlit_Functions.set_boilerplate-869"><span class="linenos">869</span></a>
</span><span id="Streamlit_Functions.set_boilerplate-870"><a href="#Streamlit_Functions.set_boilerplate-870"><span class="linenos">870</span></a>            <span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">expander</span><span class="p">(</span><span class="s2">&quot;📻 Traffic log&quot;</span><span class="p">):</span>
</span><span id="Streamlit_Functions.set_boilerplate-871"><a href="#Streamlit_Functions.set_boilerplate-871"><span class="linenos">871</span></a>
</span><span id="Streamlit_Functions.set_boilerplate-872"><a href="#Streamlit_Functions.set_boilerplate-872"><span class="linenos">872</span></a>                <span class="n">traffic</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">columns</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Streamlit_Functions.set_boilerplate-873"><a href="#Streamlit_Functions.set_boilerplate-873"><span class="linenos">873</span></a>
</span><span id="Streamlit_Functions.set_boilerplate-874"><a href="#Streamlit_Functions.set_boilerplate-874"><span class="linenos">874</span></a>        <span class="n">scroll_container</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">empty</span><span class="p">()</span>
</span><span id="Streamlit_Functions.set_boilerplate-875"><a href="#Streamlit_Functions.set_boilerplate-875"><span class="linenos">875</span></a>
</span><span id="Streamlit_Functions.set_boilerplate-876"><a href="#Streamlit_Functions.set_boilerplate-876"><span class="linenos">876</span></a>        <span class="n">store</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="Streamlit_Functions.set_boilerplate-877"><a href="#Streamlit_Functions.set_boilerplate-877"><span class="linenos">877</span></a>
</span><span id="Streamlit_Functions.set_boilerplate-878"><a href="#Streamlit_Functions.set_boilerplate-878"><span class="linenos">878</span></a>        <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">scroll_text</span><span class="p">:</span>
</span><span id="Streamlit_Functions.set_boilerplate-879"><a href="#Streamlit_Functions.set_boilerplate-879"><span class="linenos">879</span></a>
</span><span id="Streamlit_Functions.set_boilerplate-880"><a href="#Streamlit_Functions.set_boilerplate-880"><span class="linenos">880</span></a>            <span class="n">store</span> <span class="o">=</span> <span class="n">store</span> <span class="o">+</span> <span class="n">char</span>
</span><span id="Streamlit_Functions.set_boilerplate-881"><a href="#Streamlit_Functions.set_boilerplate-881"><span class="linenos">881</span></a>
</span><span id="Streamlit_Functions.set_boilerplate-882"><a href="#Streamlit_Functions.set_boilerplate-882"><span class="linenos">882</span></a>            <span class="n">scroll_container</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">store</span><span class="p">)</span>
</span><span id="Streamlit_Functions.set_boilerplate-883"><a href="#Streamlit_Functions.set_boilerplate-883"><span class="linenos">883</span></a>
</span><span id="Streamlit_Functions.set_boilerplate-884"><a href="#Streamlit_Functions.set_boilerplate-884"><span class="linenos">884</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.005</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Boilerplate setup for a Streamlit page.</p>

<p>Parameters</p>

<pre><code>page_title : str - The title bar page name.

scroll_text : str - The text to scroll when the page loads.

metrics : bool - Show the metrics during operations, in expanders.
</code></pre>
</div>


                            </div>
                            <div id="Streamlit_Functions.update_metrics" class="classattr">
                                        <input id="Streamlit_Functions.update_metrics-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_metrics</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">data</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Streamlit_Functions.update_metrics-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Streamlit_Functions.update_metrics"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Streamlit_Functions.update_metrics-886"><a href="#Streamlit_Functions.update_metrics-886"><span class="linenos">886</span></a>    <span class="k">def</span> <span class="nf">update_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span id="Streamlit_Functions.update_metrics-887"><a href="#Streamlit_Functions.update_metrics-887"><span class="linenos">887</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Streamlit_Functions.update_metrics-888"><a href="#Streamlit_Functions.update_metrics-888"><span class="linenos">888</span></a><span class="sd">        Update the boilerplate metrics.</span>
</span><span id="Streamlit_Functions.update_metrics-889"><a href="#Streamlit_Functions.update_metrics-889"><span class="linenos">889</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Streamlit_Functions.update_metrics-890"><a href="#Streamlit_Functions.update_metrics-890"><span class="linenos">890</span></a>
</span><span id="Streamlit_Functions.update_metrics-891"><a href="#Streamlit_Functions.update_metrics-891"><span class="linenos">891</span></a>        <span class="n">keys_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="Streamlit_Functions.update_metrics-892"><a href="#Streamlit_Functions.update_metrics-892"><span class="linenos">892</span></a>
</span><span id="Streamlit_Functions.update_metrics-893"><a href="#Streamlit_Functions.update_metrics-893"><span class="linenos">893</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metrics_col1</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span>
</span><span id="Streamlit_Functions.update_metrics-894"><a href="#Streamlit_Functions.update_metrics-894"><span class="linenos">894</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">keys_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> % remaining&quot;</span><span class="p">,</span>
</span><span id="Streamlit_Functions.update_metrics-895"><a href="#Streamlit_Functions.update_metrics-895"><span class="linenos">895</span></a>            <span class="n">data</span><span class="p">[</span><span class="n">keys_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s2">&quot;percent_remaining&quot;</span><span class="p">],</span>
</span><span id="Streamlit_Functions.update_metrics-896"><a href="#Streamlit_Functions.update_metrics-896"><span class="linenos">896</span></a>            <span class="nb">round</span><span class="p">((</span><span class="mi">1000</span> <span class="o">/</span> <span class="n">data</span><span class="p">[</span><span class="n">keys_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s2">&quot;remaining&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
</span><span id="Streamlit_Functions.update_metrics-897"><a href="#Streamlit_Functions.update_metrics-897"><span class="linenos">897</span></a>        <span class="p">)</span>
</span><span id="Streamlit_Functions.update_metrics-898"><a href="#Streamlit_Functions.update_metrics-898"><span class="linenos">898</span></a>
</span><span id="Streamlit_Functions.update_metrics-899"><a href="#Streamlit_Functions.update_metrics-899"><span class="linenos">899</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metrics_col2</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span>
</span><span id="Streamlit_Functions.update_metrics-900"><a href="#Streamlit_Functions.update_metrics-900"><span class="linenos">900</span></a>            <span class="n">keys_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">keys_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s2">&quot;limit&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">keys_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s2">&quot;remaining&quot;</span><span class="p">]</span>
</span><span id="Streamlit_Functions.update_metrics-901"><a href="#Streamlit_Functions.update_metrics-901"><span class="linenos">901</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Update the boilerplate metrics.</p>
</div>


                            </div>
                </section>
                <section id="random_line">
                            <input id="random_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">random_line</span><span class="signature pdoc-code condensed">(<span class="return-annotation">):</span></span>

                <label class="view-source-button" for="random_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#random_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="random_line-904"><a href="#random_line-904"><span class="linenos">904</span></a><span class="k">def</span> <span class="nf">random_line</span><span class="p">():</span>
</span><span id="random_line-905"><a href="#random_line-905"><span class="linenos">905</span></a>
</span><span id="random_line-906"><a href="#random_line-906"><span class="linenos">906</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="random_line-907"><a href="#random_line-907"><span class="linenos">907</span></a><span class="sd">    Get a random line of Shakespeare</span>
</span><span id="random_line-908"><a href="#random_line-908"><span class="linenos">908</span></a>
</span><span id="random_line-909"><a href="#random_line-909"><span class="linenos">909</span></a><span class="sd">    Returns</span>
</span><span id="random_line-910"><a href="#random_line-910"><span class="linenos">910</span></a>
</span><span id="random_line-911"><a href="#random_line-911"><span class="linenos">911</span></a><span class="sd">        line : str - A single line of Shakespeare.</span>
</span><span id="random_line-912"><a href="#random_line-912"><span class="linenos">912</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="random_line-913"><a href="#random_line-913"><span class="linenos">913</span></a>
</span><span id="random_line-914"><a href="#random_line-914"><span class="linenos">914</span></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;data/alllines.txt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="random_line-915"><a href="#random_line-915"><span class="linenos">915</span></a>
</span><span id="random_line-916"><a href="#random_line-916"><span class="linenos">916</span></a>        <span class="n">f1</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
</span><span id="random_line-917"><a href="#random_line-917"><span class="linenos">917</span></a>
</span><span id="random_line-918"><a href="#random_line-918"><span class="linenos">918</span></a>    <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">f1</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get a random line of Shakespeare</p>

<p>Returns</p>

<pre><code>line : str - A single line of Shakespeare.
</code></pre>
</div>


                </section>
                <section id="tutorial">
                            <input id="tutorial-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">tutorial</span><span class="signature pdoc-code condensed">(<span class="return-annotation">):</span></span>

                <label class="view-source-button" for="tutorial-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#tutorial"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="tutorial-921"><a href="#tutorial-921"><span class="linenos">921</span></a><span class="k">def</span> <span class="nf">tutorial</span><span class="p">():</span>
</span><span id="tutorial-922"><a href="#tutorial-922"><span class="linenos">922</span></a>
</span><span id="tutorial-923"><a href="#tutorial-923"><span class="linenos">923</span></a>    <span class="kn">import</span> <span class="nn">streamlit</span> <span class="k">as</span> <span class="nn">st</span>
</span><span id="tutorial-924"><a href="#tutorial-924"><span class="linenos">924</span></a>
</span><span id="tutorial-925"><a href="#tutorial-925"><span class="linenos">925</span></a>    <span class="n">l1</span> <span class="o">=</span> <span class="n">random_line</span><span class="p">()</span>
</span><span id="tutorial-926"><a href="#tutorial-926"><span class="linenos">926</span></a>
</span><span id="tutorial-927"><a href="#tutorial-927"><span class="linenos">927</span></a>    <span class="n">st</span><span class="o">.</span><span class="n">code</span><span class="p">(</span>
</span><span id="tutorial-928"><a href="#tutorial-928"><span class="linenos">928</span></a>        <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="tutorial-929"><a href="#tutorial-929"><span class="linenos">929</span></a><span class="s2">    🇺🇲 Web Tools &lt;[Research Utilities]&gt;</span>
</span><span id="tutorial-930"><a href="#tutorial-930"><span class="linenos">930</span></a>
</span><span id="tutorial-931"><a href="#tutorial-931"><span class="linenos">931</span></a><span class="s2">    = Tools to request data via APIs, perform database functions, and produce analytics.</span>
</span><span id="tutorial-932"><a href="#tutorial-932"><span class="linenos">932</span></a>
</span><span id="tutorial-933"><a href="#tutorial-933"><span class="linenos">933</span></a><span class="s2">    - 🍳 This is the boilerplate text. Call set_boilerplate(scroll_text=&#39;YOUR TEXT to change this...&#39;)</span>
</span><span id="tutorial-934"><a href="#tutorial-934"><span class="linenos">934</span></a>
</span><span id="tutorial-935"><a href="#tutorial-935"><span class="linenos">935</span></a><span class="s2">    + 🍼 Show example script (the code below) - web_tools.tutorial()</span>
</span><span id="tutorial-936"><a href="#tutorial-936"><span class="linenos">936</span></a>
</span><span id="tutorial-937"><a href="#tutorial-937"><span class="linenos">937</span></a><span class="s2">    + 🍗 Documentation: https://github.com/solarecho3/web-tools  &gt;  documentation  &gt;  web_tools.htm</span>
</span><span id="tutorial-938"><a href="#tutorial-938"><span class="linenos">938</span></a>
</span><span id="tutorial-939"><a href="#tutorial-939"><span class="linenos">939</span></a><span class="s2">    - ⚔️ A line from the bard?  </span><span class="si">{</span><span class="n">l1</span><span class="si">}</span><span class="s2">  🤺</span>
</span><span id="tutorial-940"><a href="#tutorial-940"><span class="linenos">940</span></a>
</span><span id="tutorial-941"><a href="#tutorial-941"><span class="linenos">941</span></a><span class="s2">    # Example</span>
</span><span id="tutorial-942"><a href="#tutorial-942"><span class="linenos">942</span></a>
</span><span id="tutorial-943"><a href="#tutorial-943"><span class="linenos">943</span></a><span class="s2">        import web_tools</span>
</span><span id="tutorial-944"><a href="#tutorial-944"><span class="linenos">944</span></a>
</span><span id="tutorial-945"><a href="#tutorial-945"><span class="linenos">945</span></a><span class="s2">        t1 = web_tools.Twitter_Session()</span>
</span><span id="tutorial-946"><a href="#tutorial-946"><span class="linenos">946</span></a><span class="s2">        t1.get_token_local(&#39;/home/docs/keys.json&#39;)</span>
</span><span id="tutorial-947"><a href="#tutorial-947"><span class="linenos">947</span></a>
</span><span id="tutorial-948"><a href="#tutorial-948"><span class="linenos">948</span></a><span class="s2">        df = t1.get_user_profile(&#39;elonmusk&#39;)</span>
</span><span id="tutorial-949"><a href="#tutorial-949"><span class="linenos">949</span></a><span class="s2">        df2 = t1.get_user_tweets(df[&#39;id&#39;][0])</span>
</span><span id="tutorial-950"><a href="#tutorial-950"><span class="linenos">950</span></a><span class="s2">        df3 = t1.get_user_following(df[&#39;id&#39;][0])</span>
</span><span id="tutorial-951"><a href="#tutorial-951"><span class="linenos">951</span></a>
</span><span id="tutorial-952"><a href="#tutorial-952"><span class="linenos">952</span></a><span class="s2">        t1.df_to_db(df[&#39;id&#39;][0], df, &#39;profile&#39;)</span>
</span><span id="tutorial-953"><a href="#tutorial-953"><span class="linenos">953</span></a><span class="s2">        t1.df_to_db(df[&#39;id&#39;][0], df2, &#39;tweets&#39;)</span>
</span><span id="tutorial-954"><a href="#tutorial-954"><span class="linenos">954</span></a><span class="s2">        t1.df_to_db(df[&#39;id&#39;][0], df3, &#39;following&#39;)</span>
</span><span id="tutorial-955"><a href="#tutorial-955"><span class="linenos">955</span></a>
</span><span id="tutorial-956"><a href="#tutorial-956"><span class="linenos">956</span></a><span class="s2">        df4 = t1.get_string_query(&#39;taiwan&#39;, pages=2)</span>
</span><span id="tutorial-957"><a href="#tutorial-957"><span class="linenos">957</span></a><span class="s2">        t1.df_to_db(</span>
</span><span id="tutorial-958"><a href="#tutorial-958"><span class="linenos">958</span></a><span class="s2">            id = t1.response.headers[&#39;x-transaction-id&#39;],</span>
</span><span id="tutorial-959"><a href="#tutorial-959"><span class="linenos">959</span></a><span class="s2">            data = df4,</span>
</span><span id="tutorial-960"><a href="#tutorial-960"><span class="linenos">960</span></a><span class="s2">            type = &#39;query&#39;,</span>
</span><span id="tutorial-961"><a href="#tutorial-961"><span class="linenos">961</span></a><span class="s2">            query_term = t1.query_log[len(t1.query_log)-1][&#39;parsed_query_term&#39;]</span>
</span><span id="tutorial-962"><a href="#tutorial-962"><span class="linenos">962</span></a><span class="s2">            )</span>
</span><span id="tutorial-963"><a href="#tutorial-963"><span class="linenos">963</span></a>
</span><span id="tutorial-964"><a href="#tutorial-964"><span class="linenos">964</span></a><span class="s2">        df4 = t1.get_string_query(&#39;musk&#39;, pages=2)</span>
</span><span id="tutorial-965"><a href="#tutorial-965"><span class="linenos">965</span></a><span class="s2">        t1.df_to_db(</span>
</span><span id="tutorial-966"><a href="#tutorial-966"><span class="linenos">966</span></a><span class="s2">            id = t1.response.headers[&#39;x-transaction-id&#39;],</span>
</span><span id="tutorial-967"><a href="#tutorial-967"><span class="linenos">967</span></a><span class="s2">            data = df4,</span>
</span><span id="tutorial-968"><a href="#tutorial-968"><span class="linenos">968</span></a><span class="s2">            type = &#39;query&#39;,</span>
</span><span id="tutorial-969"><a href="#tutorial-969"><span class="linenos">969</span></a><span class="s2">            query_term = t1.query_log[len(t1.query_log)-1][&#39;parsed_query_term&#39;]</span>
</span><span id="tutorial-970"><a href="#tutorial-970"><span class="linenos">970</span></a><span class="s2">            )</span>
</span><span id="tutorial-971"><a href="#tutorial-971"><span class="linenos">971</span></a>
</span><span id="tutorial-972"><a href="#tutorial-972"><span class="linenos">972</span></a><span class="s2">        df4 = t1.get_string_query(&#39;russia&#39;, pages=2)</span>
</span><span id="tutorial-973"><a href="#tutorial-973"><span class="linenos">973</span></a><span class="s2">        t1.df_to_db(</span>
</span><span id="tutorial-974"><a href="#tutorial-974"><span class="linenos">974</span></a><span class="s2">            id = t1.response.headers[&#39;x-transaction-id&#39;],</span>
</span><span id="tutorial-975"><a href="#tutorial-975"><span class="linenos">975</span></a><span class="s2">            data = df4,</span>
</span><span id="tutorial-976"><a href="#tutorial-976"><span class="linenos">976</span></a><span class="s2">            type = &#39;query&#39;,</span>
</span><span id="tutorial-977"><a href="#tutorial-977"><span class="linenos">977</span></a><span class="s2">            query_term = t1.query_log[len(t1.query_log)-1][&#39;parsed_query_term&#39;]</span>
</span><span id="tutorial-978"><a href="#tutorial-978"><span class="linenos">978</span></a><span class="s2">            )</span>
</span><span id="tutorial-979"><a href="#tutorial-979"><span class="linenos">979</span></a><span class="s2">    &quot;&quot;&quot;</span>
</span><span id="tutorial-980"><a href="#tutorial-980"><span class="linenos">980</span></a>    <span class="p">)</span>
</span></pre></div>


    

                </section>
    </main>
</body>
</html>